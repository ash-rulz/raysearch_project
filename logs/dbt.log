[0m10:44:10.556317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749CCD4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749DE0BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749DE0B9D0>]}


============================== 10:44:10.577236 | b32c2459-8759-45d1-8e1d-4d049450f335 ==============================
[0m10:44:10.577236 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:44:10.578988 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'invocation_command': 'dbt debug', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m10:44:10.656002 [info ] [MainThread]: dbt version: 1.11.2
[0m10:44:10.657063 [info ] [MainThread]: python version: 3.13.2
[0m10:44:10.657895 [info ] [MainThread]: python path: C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Scripts\python.exe
[0m10:44:10.658834 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m10:44:11.498735 [info ] [MainThread]: Using profiles dir at C:\Users\AMANDAKA\.dbt
[0m10:44:11.500329 [info ] [MainThread]: Using profiles.yml file at C:\Users\AMANDAKA\.dbt\profiles.yml
[0m10:44:11.501430 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\AMANDAKA\Workspaces\raysearch_project\dbt_project.yml
[0m10:44:11.576900 [info ] [MainThread]: adapter type: duckdb
[0m10:44:11.578504 [info ] [MainThread]: adapter version: 1.10.0
[0m10:44:11.803578 [info ] [MainThread]: Configuration:
[0m10:44:11.805031 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:44:11.806067 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:44:11.807023 [info ] [MainThread]: Required dependencies:
[0m10:44:11.807957 [debug] [MainThread]: Executing "git --help"
[0m10:44:12.031284 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:44:12.032240 [debug] [MainThread]: STDERR: "b''"
[0m10:44:12.032960 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:44:12.034193 [info ] [MainThread]: Connection:
[0m10:44:12.035426 [info ] [MainThread]:   database: warehouse
[0m10:44:12.036630 [info ] [MainThread]:   schema: main
[0m10:44:12.037780 [info ] [MainThread]:   path: C:\Users\AMANDAKA\Workspaces\raysearch_project\warehouse.duckdb
[0m10:44:12.038654 [info ] [MainThread]:   config_options: None
[0m10:44:12.040216 [info ] [MainThread]:   extensions: None
[0m10:44:12.041708 [info ] [MainThread]:   settings: {}
[0m10:44:12.042964 [info ] [MainThread]:   external_root: .
[0m10:44:12.044147 [info ] [MainThread]:   use_credential_provider: None
[0m10:44:12.045244 [info ] [MainThread]:   attach: None
[0m10:44:12.046275 [info ] [MainThread]:   filesystems: None
[0m10:44:12.047341 [info ] [MainThread]:   remote: None
[0m10:44:12.048290 [info ] [MainThread]:   plugins: None
[0m10:44:12.049204 [info ] [MainThread]:   disable_transactions: False
[0m10:44:12.051154 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m10:44:12.917833 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m10:44:25.077524 [debug] [MainThread]: Using duckdb connection "debug"
[0m10:44:25.078369 [debug] [MainThread]: On debug: select 1 as id
[0m10:44:25.078946 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:44:25.453610 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m10:44:25.454409 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m10:44:25.455055 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:44:25.456072 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:44:25.456804 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Cannot open file "c:\users\amandaka\workspaces\raysearch_project\warehouse.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Users\AMANDAKA\AppData\Local\DBeaver\dbeaver.exe (PID 27544)

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:44:25.458641 [debug] [MainThread]: Command `dbt debug` failed at 10:44:25.458379 after 15.32 seconds
[0m10:44:25.459315 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:44:25.459947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749DCF55B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749C91E570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749EFAD8C0>]}
[0m10:44:25.460650 [debug] [MainThread]: Flushing usage events
[0m10:44:27.081201 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:45:03.185470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5A1484830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5A25BBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5A25BB9D0>]}


============================== 10:45:03.196964 | 232e049e-6ff7-4af7-bf78-4ceefe5cbf88 ==============================
[0m10:45:03.196964 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:45:03.198938 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m10:45:03.256622 [info ] [MainThread]: dbt version: 1.11.2
[0m10:45:03.257889 [info ] [MainThread]: python version: 3.13.2
[0m10:45:03.258855 [info ] [MainThread]: python path: C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Scripts\python.exe
[0m10:45:03.259707 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m10:45:03.498915 [info ] [MainThread]: Using profiles dir at C:\Users\AMANDAKA\.dbt
[0m10:45:03.500515 [info ] [MainThread]: Using profiles.yml file at C:\Users\AMANDAKA\.dbt\profiles.yml
[0m10:45:03.501596 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\AMANDAKA\Workspaces\raysearch_project\dbt_project.yml
[0m10:45:03.506936 [info ] [MainThread]: adapter type: duckdb
[0m10:45:03.508103 [info ] [MainThread]: adapter version: 1.10.0
[0m10:45:03.721612 [info ] [MainThread]: Configuration:
[0m10:45:03.722966 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:45:03.724342 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:45:03.725805 [info ] [MainThread]: Required dependencies:
[0m10:45:03.726830 [debug] [MainThread]: Executing "git --help"
[0m10:45:03.946753 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:45:03.947715 [debug] [MainThread]: STDERR: "b''"
[0m10:45:03.948405 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:45:03.949289 [info ] [MainThread]: Connection:
[0m10:45:03.950607 [info ] [MainThread]:   database: warehouse
[0m10:45:03.952038 [info ] [MainThread]:   schema: main
[0m10:45:03.952991 [info ] [MainThread]:   path: C:\Users\AMANDAKA\Workspaces\raysearch_project\warehouse.duckdb
[0m10:45:03.953838 [info ] [MainThread]:   config_options: None
[0m10:45:03.954856 [info ] [MainThread]:   extensions: None
[0m10:45:03.955728 [info ] [MainThread]:   settings: {}
[0m10:45:03.956552 [info ] [MainThread]:   external_root: .
[0m10:45:03.957430 [info ] [MainThread]:   use_credential_provider: None
[0m10:45:03.958477 [info ] [MainThread]:   attach: None
[0m10:45:03.960382 [info ] [MainThread]:   filesystems: None
[0m10:45:03.961297 [info ] [MainThread]:   remote: None
[0m10:45:03.962226 [info ] [MainThread]:   plugins: None
[0m10:45:03.963067 [info ] [MainThread]:   disable_transactions: False
[0m10:45:03.964220 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m10:45:04.371427 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m10:45:04.625772 [debug] [MainThread]: Using duckdb connection "debug"
[0m10:45:04.626481 [debug] [MainThread]: On debug: select 1 as id
[0m10:45:04.626931 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:45:04.659035 [debug] [MainThread]: SQL status: OK in 0.032 seconds
[0m10:45:04.660760 [debug] [MainThread]: On debug: Close
[0m10:45:04.661456 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:45:04.664086 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:45:04.667080 [debug] [MainThread]: Command `dbt debug` succeeded at 10:45:04.666360 after 1.81 seconds
[0m10:45:04.667729 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:45:04.669181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5A24A55B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5A10DDFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5A375C8D0>]}
[0m10:45:04.671599 [debug] [MainThread]: Flushing usage events
[0m10:45:05.904519 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:45:57.389194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC5E334830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC5F463ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC5F4639D0>]}


============================== 10:45:57.400280 | 3c0e012e-24c5-469d-b6a8-38a2496d9e51 ==============================
[0m10:45:57.400280 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:45:57.402525 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt seed', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m10:45:57.990527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c0e012e-24c5-469d-b6a8-38a2496d9e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC5E7A6060>]}
[0m10:45:58.130069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c0e012e-24c5-469d-b6a8-38a2496d9e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC604B29C0>]}
[0m10:45:58.137801 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m10:45:58.721918 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m10:46:03.965242 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:46:03.966544 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m10:46:03.967183 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:46:03.979519 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.marts
- models.raysearch_project.intermediate
[0m10:46:04.045911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c0e012e-24c5-469d-b6a8-38a2496d9e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC60503450>]}
[0m10:46:04.168699 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m10:46:04.240000 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m10:46:04.360117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c0e012e-24c5-469d-b6a8-38a2496d9e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC60980B90>]}
[0m10:46:04.361015 [info ] [MainThread]: Found 1 model, 3 seeds, 472 macros
[0m10:46:04.361989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c0e012e-24c5-469d-b6a8-38a2496d9e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC60AFA350>]}
[0m10:46:04.365325 [info ] [MainThread]: 
[0m10:46:04.366592 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:46:04.367809 [info ] [MainThread]: 
[0m10:46:04.370950 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:46:04.385115 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m10:46:04.622287 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m10:46:04.623063 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m10:46:04.623572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:04.657052 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m10:46:04.659442 [debug] [ThreadPool]: On list_warehouse: Close
[0m10:46:04.669731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main)
[0m10:46:04.670895 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main"
"
[0m10:46:04.683594 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:46:04.684763 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m10:46:04.685709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:46:04.689132 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:46:04.691962 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:46:04.692921 [debug] [ThreadPool]: On create_warehouse_main: BEGIN
[0m10:46:04.694209 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:46:04.694830 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:46:04.695339 [debug] [ThreadPool]: On create_warehouse_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main"} */

    
    
        create schema if not exists "warehouse"."main"
    
[0m10:46:04.696554 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:46:04.698712 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m10:46:04.699453 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main"
[0m10:46:04.700185 [debug] [ThreadPool]: On create_warehouse_main: COMMIT
[0m10:46:04.701570 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:46:04.702253 [debug] [ThreadPool]: On create_warehouse_main: Close
[0m10:46:04.705395 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m10:46:04.714686 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m10:46:04.715398 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m10:46:04.716408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:04.718850 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:46:04.719473 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m10:46:04.720021 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'warehouse'
  
[0m10:46:04.746929 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m10:46:04.750130 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m10:46:04.809006 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m10:46:04.809982 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m10:46:04.812433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c0e012e-24c5-469d-b6a8-38a2496d9e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC60D16340>]}
[0m10:46:04.813460 [debug] [MainThread]: Using duckdb connection "master"
[0m10:46:04.814358 [debug] [MainThread]: On master: BEGIN
[0m10:46:04.815020 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:46:04.816395 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:46:04.817077 [debug] [MainThread]: On master: COMMIT
[0m10:46:04.817718 [debug] [MainThread]: Using duckdb connection "master"
[0m10:46:04.818314 [debug] [MainThread]: On master: COMMIT
[0m10:46:04.819366 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:46:04.819988 [debug] [MainThread]: On master: Close
[0m10:46:04.836015 [debug] [Thread-1 (]: Began running node seed.raysearch_project.currency_exchange
[0m10:46:04.838346 [debug] [Thread-2 (]: Began running node seed.raysearch_project.customer
[0m10:46:04.840089 [debug] [Thread-3 (]: Began running node seed.raysearch_project.transaction
[0m10:46:04.837482 [info ] [Thread-1 (]: 1 of 3 START seed file main.currency_exchange .................................. [RUN]
[0m10:46:04.842364 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.raysearch_project.currency_exchange'
[0m10:46:04.843088 [debug] [Thread-1 (]: Began compiling node seed.raysearch_project.currency_exchange
[0m10:46:04.844340 [debug] [Thread-1 (]: Began executing node seed.raysearch_project.currency_exchange
[0m10:46:04.839351 [info ] [Thread-2 (]: 2 of 3 START seed file main.customer ........................................... [RUN]
[0m10:46:04.856909 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.raysearch_project.customer'
[0m10:46:04.841060 [info ] [Thread-3 (]: 3 of 3 START seed file main.transaction ........................................ [RUN]
[0m10:46:04.881991 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.raysearch_project.transaction'
[0m10:46:04.877829 [debug] [Thread-2 (]: Began compiling node seed.raysearch_project.customer
[0m10:46:04.883388 [debug] [Thread-3 (]: Began compiling node seed.raysearch_project.transaction
[0m10:46:04.884387 [debug] [Thread-2 (]: Began executing node seed.raysearch_project.customer
[0m10:46:04.885629 [debug] [Thread-3 (]: Began executing node seed.raysearch_project.transaction
[0m10:46:05.154607 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m10:46:05.167421 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m10:46:05.168174 [debug] [Thread-2 (]: On seed.raysearch_project.customer: BEGIN
[0m10:46:05.230062 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: BEGIN
[0m10:46:05.261972 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:46:05.286232 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:46:05.366841 [debug] [Thread-1 (]: SQL status: OK in 0.081 seconds
[0m10:46:05.367767 [debug] [Thread-2 (]: SQL status: OK in 0.106 seconds
[0m10:46:05.406441 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m10:46:05.431138 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m10:46:05.447154 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "seed.raysearch_project.currency_exchange"} */

    create table "warehouse"."main"."currency_exchange" ("date" date,"currency" text,"baseRateEuro" float8)
  
[0m10:46:05.479125 [debug] [Thread-2 (]: On seed.raysearch_project.customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "seed.raysearch_project.customer"} */
truncate table "warehouse"."main"."customer"
[0m10:46:05.597518 [debug] [Thread-1 (]: SQL status: OK in 0.070 seconds
[0m10:46:05.629457 [debug] [Thread-2 (]: SQL status: OK in 0.070 seconds
[0m10:46:05.684525 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m10:46:05.686837 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m10:46:05.724802 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: 
          COPY "warehouse"."main"."currency_exchange" FROM 'C:\Users\AMANDAKA\Workspaces\raysearch_project\seeds\currency_exchange.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m10:46:05.789574 [debug] [Thread-2 (]: On seed.raysearch_project.customer: 
          COPY "warehouse"."main"."customer" FROM 'C:\Users\AMANDAKA\Workspaces\raysearch_project\seeds\customer.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m10:46:05.877286 [debug] [Thread-2 (]: SQL status: OK in 0.031 seconds
[0m10:46:05.903588 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.raysearch_project.customer"
[0m10:46:06.021649 [debug] [Thread-2 (]: On seed.raysearch_project.customer: COMMIT
[0m10:46:06.027973 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m10:46:06.028762 [debug] [Thread-2 (]: On seed.raysearch_project.customer: COMMIT
[0m10:46:06.075396 [debug] [Thread-2 (]: SQL status: OK in 0.046 seconds
[0m10:46:06.076155 [debug] [Thread-1 (]: SQL status: OK in 0.244 seconds
[0m10:46:06.101243 [debug] [Thread-2 (]: On seed.raysearch_project.customer: Close
[0m10:46:06.114738 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.raysearch_project.currency_exchange"
[0m10:46:06.263783 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: COMMIT
[0m10:46:06.264802 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m10:46:06.277607 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: COMMIT
[0m10:46:06.314733 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c0e012e-24c5-469d-b6a8-38a2496d9e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC60AAF350>]}
[0m10:46:06.328335 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m10:46:06.327310 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file main.customer ....................................... [[32mINSERT 67[0m in 1.32s]
[0m10:46:06.344858 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: Close
[0m10:46:06.396976 [debug] [Thread-2 (]: Finished running node seed.raysearch_project.customer
[0m10:46:06.489333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c0e012e-24c5-469d-b6a8-38a2496d9e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC60A97800>]}
[0m10:46:06.490714 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file main.currency_exchange .............................. [[32mINSERT 1977[0m in 1.65s]
[0m10:46:06.522077 [debug] [Thread-1 (]: Finished running node seed.raysearch_project.currency_exchange
[0m10:46:06.586170 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m10:46:06.586975 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: BEGIN
[0m10:46:06.587495 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:46:06.588786 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:46:06.589415 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m10:46:06.589921 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "seed.raysearch_project.transaction"} */

    create table "warehouse"."main"."transaction" ("date" text,"amount" integer,"channelUID" text,"txCurrency" text,"accountType" integer,"txType" text,"customerId" integer)
  
[0m10:46:06.591232 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:46:06.593316 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m10:46:06.593934 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: 
          COPY "warehouse"."main"."transaction" FROM 'C:\Users\AMANDAKA\Workspaces\raysearch_project\seeds\transaction.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m10:46:06.713690 [debug] [Thread-3 (]: SQL status: OK in 0.119 seconds
[0m10:46:06.715423 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.raysearch_project.transaction"
[0m10:46:06.720723 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: COMMIT
[0m10:46:06.721469 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m10:46:06.722001 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: COMMIT
[0m10:46:06.746182 [debug] [Thread-3 (]: SQL status: OK in 0.024 seconds
[0m10:46:06.747721 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: Close
[0m10:46:06.748876 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c0e012e-24c5-469d-b6a8-38a2496d9e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6063B9D0>]}
[0m10:46:06.749785 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file main.transaction .................................... [[32mINSERT 38025[0m in 1.87s]
[0m10:46:06.751497 [debug] [Thread-3 (]: Finished running node seed.raysearch_project.transaction
[0m10:46:06.754001 [debug] [MainThread]: Using duckdb connection "master"
[0m10:46:06.754596 [debug] [MainThread]: On master: BEGIN
[0m10:46:06.755044 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:46:06.756143 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:46:06.756669 [debug] [MainThread]: On master: COMMIT
[0m10:46:06.757129 [debug] [MainThread]: Using duckdb connection "master"
[0m10:46:06.757551 [debug] [MainThread]: On master: COMMIT
[0m10:46:06.758371 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:46:06.758892 [debug] [MainThread]: On master: Close
[0m10:46:06.759534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:46:06.759953 [debug] [MainThread]: Connection 'create_warehouse_main' was properly closed.
[0m10:46:06.760322 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m10:46:06.760675 [debug] [MainThread]: Connection 'seed.raysearch_project.currency_exchange' was properly closed.
[0m10:46:06.761032 [debug] [MainThread]: Connection 'seed.raysearch_project.customer' was properly closed.
[0m10:46:06.761411 [debug] [MainThread]: Connection 'seed.raysearch_project.transaction' was properly closed.
[0m10:46:06.761882 [info ] [MainThread]: 
[0m10:46:06.762941 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 2.39 seconds (2.39s).
[0m10:46:06.765908 [debug] [MainThread]: Command end result
[0m10:46:06.805488 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m10:46:06.810967 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m10:46:06.823572 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m10:46:06.824303 [info ] [MainThread]: 
[0m10:46:06.825739 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:46:06.826672 [info ] [MainThread]: 
[0m10:46:06.827548 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m10:46:06.829035 [debug] [MainThread]: Command `dbt seed` succeeded at 10:46:06.828829 after 9.77 seconds
[0m10:46:06.829738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC60531750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC5F3C38D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC5F48DA90>]}
[0m10:46:06.830979 [debug] [MainThread]: Flushing usage events
[0m10:46:08.262673 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:02:04.887358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196D5334830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196D6467ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196D64679D0>]}


============================== 11:02:04.898085 | b4aee0cb-cf6d-4446-82ad-d610a4defda0 ==============================
[0m11:02:04.898085 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:02:04.899817 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt seed', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m11:02:05.988706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4aee0cb-cf6d-4446-82ad-d610a4defda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196D57A6060>]}
[0m11:02:06.137324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4aee0cb-cf6d-4446-82ad-d610a4defda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196D74B27A0>]}
[0m11:02:06.206265 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m11:02:07.289945 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:02:07.496425 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:02:07.498058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b4aee0cb-cf6d-4446-82ad-d610a4defda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196D7502B50>]}
[0m11:02:15.073724 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.intermediate
- models.raysearch_project.marts
[0m11:02:15.083954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4aee0cb-cf6d-4446-82ad-d610a4defda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196D74A2300>]}
[0m11:02:15.203819 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m11:02:15.273397 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m11:02:15.366882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4aee0cb-cf6d-4446-82ad-d610a4defda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196D7CF17F0>]}
[0m11:02:15.368031 [info ] [MainThread]: Found 1 model, 3 seeds, 472 macros
[0m11:02:15.369291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4aee0cb-cf6d-4446-82ad-d610a4defda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196D79806D0>]}
[0m11:02:15.374859 [info ] [MainThread]: 
[0m11:02:15.376230 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:02:15.378396 [info ] [MainThread]: 
[0m11:02:15.380105 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:02:15.391361 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m11:02:29.657830 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m11:02:29.659016 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m11:02:29.660147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:29.742255 [debug] [ThreadPool]: SQL status: OK in 0.082 seconds
[0m11:02:29.745435 [debug] [ThreadPool]: On list_warehouse: Close
[0m11:02:29.747457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_raw)
[0m11:02:29.749104 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_raw"
"
[0m11:02:29.760493 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m11:02:29.761251 [debug] [ThreadPool]: On create_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m11:02:29.761718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:29.763732 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:02:29.765955 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m11:02:29.766478 [debug] [ThreadPool]: On create_warehouse_main_raw: BEGIN
[0m11:02:29.767333 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:02:29.767803 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m11:02:29.768214 [debug] [ThreadPool]: On create_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_raw"} */

    
    
        create schema if not exists "warehouse"."main_raw"
    
[0m11:02:29.769097 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:02:29.770656 [debug] [ThreadPool]: On create_warehouse_main_raw: COMMIT
[0m11:02:29.771199 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m11:02:29.771624 [debug] [ThreadPool]: On create_warehouse_main_raw: COMMIT
[0m11:02:29.784385 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m11:02:29.785712 [debug] [ThreadPool]: On create_warehouse_main_raw: Close
[0m11:02:29.789816 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m11:02:29.804642 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m11:02:29.805548 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m11:02:29.807505 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main'
[0m11:02:29.808159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:29.811460 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m11:02:29.812769 [debug] [ThreadPool]: On list_warehouse_main: BEGIN
[0m11:02:29.813597 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m11:02:29.814080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:29.814820 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m11:02:29.815916 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m11:02:29.816825 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:02:29.817508 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main"
[0m11:02:29.818093 [debug] [ThreadPool]: On list_warehouse_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'warehouse'
  
[0m11:02:29.848393 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m11:02:29.849478 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m11:02:29.852412 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m11:02:29.857433 [debug] [ThreadPool]: On list_warehouse_main: ROLLBACK
[0m11:02:29.919314 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main'
[0m11:02:29.920541 [debug] [ThreadPool]: On list_warehouse_main: Close
[0m11:02:29.924363 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m11:02:29.925204 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m11:02:29.927204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4aee0cb-cf6d-4446-82ad-d610a4defda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196D7C8B410>]}
[0m11:02:29.928759 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:29.929863 [debug] [MainThread]: On master: BEGIN
[0m11:02:29.930401 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:02:29.931959 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:02:29.932972 [debug] [MainThread]: On master: COMMIT
[0m11:02:29.933584 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:29.934136 [debug] [MainThread]: On master: COMMIT
[0m11:02:29.935357 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:02:29.936335 [debug] [MainThread]: On master: Close
[0m11:02:29.951363 [debug] [Thread-2 (]: Began running node seed.raysearch_project.customer
[0m11:02:29.953383 [debug] [Thread-1 (]: Began running node seed.raysearch_project.currency_exchange
[0m11:02:29.955406 [debug] [Thread-3 (]: Began running node seed.raysearch_project.transaction
[0m11:02:29.952670 [info ] [Thread-2 (]: 2 of 3 START seed file main_raw.customer ....................................... [RUN]
[0m11:02:29.958617 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.raysearch_project.customer'
[0m11:02:29.959583 [debug] [Thread-2 (]: Began compiling node seed.raysearch_project.customer
[0m11:02:29.960328 [debug] [Thread-2 (]: Began executing node seed.raysearch_project.customer
[0m11:02:29.954553 [info ] [Thread-1 (]: 1 of 3 START seed file main_raw.currency_exchange .............................. [RUN]
[0m11:02:29.994785 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.raysearch_project.currency_exchange'
[0m11:02:29.997371 [debug] [Thread-1 (]: Began compiling node seed.raysearch_project.currency_exchange
[0m11:02:29.998087 [debug] [Thread-1 (]: Began executing node seed.raysearch_project.currency_exchange
[0m11:02:29.956382 [info ] [Thread-3 (]: 3 of 3 START seed file main_raw.transaction .................................... [RUN]
[0m11:02:30.014187 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.raysearch_project.transaction'
[0m11:02:30.015249 [debug] [Thread-3 (]: Began compiling node seed.raysearch_project.transaction
[0m11:02:30.029264 [debug] [Thread-3 (]: Began executing node seed.raysearch_project.transaction
[0m11:02:30.049455 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m11:02:30.085069 [debug] [Thread-2 (]: On seed.raysearch_project.customer: BEGIN
[0m11:02:30.100334 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:02:30.120295 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m11:02:30.126393 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m11:02:30.127262 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m11:02:30.128124 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: BEGIN
[0m11:02:30.128852 [debug] [Thread-2 (]: On seed.raysearch_project.customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "seed.raysearch_project.customer"} */

    create table "warehouse"."main_raw"."customer" (customerID integer,country text,state text,VIP integer,KYC integer,wantsNewsletter integer,latestUpdate text)
  
[0m11:02:30.152509 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:02:30.263557 [debug] [Thread-2 (]: SQL status: OK in 0.063 seconds
[0m11:02:30.264700 [debug] [Thread-1 (]: SQL status: OK in 0.112 seconds
[0m11:02:30.302507 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m11:02:30.301526 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m11:02:30.337441 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "seed.raysearch_project.currency_exchange"} */

    create table "warehouse"."main_raw"."currency_exchange" (date date,currency text,baseRateEuro float8)
  
[0m11:02:30.370496 [debug] [Thread-2 (]: On seed.raysearch_project.customer: 
          COPY "warehouse"."main_raw"."customer" FROM 'C:\Users\AMANDAKA\Workspaces\raysearch_project\seeds\customer.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m11:02:30.419772 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m11:02:30.431165 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m11:02:30.431933 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: 
          COPY "warehouse"."main_raw"."currency_exchange" FROM 'C:\Users\AMANDAKA\Workspaces\raysearch_project\seeds\currency_exchange.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m11:02:30.453502 [debug] [Thread-2 (]: SQL status: OK in 0.032 seconds
[0m11:02:30.478958 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.raysearch_project.customer"
[0m11:02:30.580614 [debug] [Thread-2 (]: On seed.raysearch_project.customer: COMMIT
[0m11:02:30.612112 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m11:02:30.613052 [debug] [Thread-2 (]: On seed.raysearch_project.customer: COMMIT
[0m11:02:30.636702 [debug] [Thread-2 (]: SQL status: OK in 0.023 seconds
[0m11:02:30.653313 [debug] [Thread-1 (]: SQL status: OK in 0.221 seconds
[0m11:02:30.673382 [debug] [Thread-2 (]: On seed.raysearch_project.customer: Close
[0m11:02:30.700953 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.raysearch_project.currency_exchange"
[0m11:02:30.798328 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: COMMIT
[0m11:02:30.828353 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m11:02:30.836594 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: COMMIT
[0m11:02:30.838219 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4aee0cb-cf6d-4446-82ad-d610a4defda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196D8020100>]}
[0m11:02:30.931929 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m11:02:30.933629 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file main_raw.customer ................................... [[32mINSERT 67[0m in 0.74s]
[0m11:02:30.975646 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: Close
[0m11:02:31.026399 [debug] [Thread-2 (]: Finished running node seed.raysearch_project.customer
[0m11:02:31.132953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4aee0cb-cf6d-4446-82ad-d610a4defda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196D80EF610>]}
[0m11:02:31.134458 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file main_raw.currency_exchange .......................... [[32mINSERT 1977[0m in 1.14s]
[0m11:02:31.158142 [debug] [Thread-1 (]: Finished running node seed.raysearch_project.currency_exchange
[0m11:02:31.807065 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m11:02:31.807976 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: BEGIN
[0m11:02:31.808500 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:02:31.809902 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:02:31.810593 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m11:02:31.811132 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "seed.raysearch_project.transaction"} */

    create table "warehouse"."main_raw"."transaction" (date text,amount integer,channelUID text,txCurrency text,accountType integer,txType text,customerId integer)
  
[0m11:02:31.812476 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m11:02:31.814895 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m11:02:31.815571 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: 
          COPY "warehouse"."main_raw"."transaction" FROM 'C:\Users\AMANDAKA\Workspaces\raysearch_project\seeds\transaction.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m11:02:31.941495 [debug] [Thread-3 (]: SQL status: OK in 0.125 seconds
[0m11:02:31.943014 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.raysearch_project.transaction"
[0m11:02:31.948479 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: COMMIT
[0m11:02:31.949901 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m11:02:31.950671 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: COMMIT
[0m11:02:31.977608 [debug] [Thread-3 (]: SQL status: OK in 0.026 seconds
[0m11:02:31.979489 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: Close
[0m11:02:31.980577 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4aee0cb-cf6d-4446-82ad-d610a4defda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196DBB67ED0>]}
[0m11:02:31.981509 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file main_raw.transaction ................................ [[32mINSERT 38025[0m in 1.97s]
[0m11:02:31.982914 [debug] [Thread-3 (]: Finished running node seed.raysearch_project.transaction
[0m11:02:31.985877 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:31.986613 [debug] [MainThread]: On master: BEGIN
[0m11:02:31.987201 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:02:31.988930 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:02:31.989569 [debug] [MainThread]: On master: COMMIT
[0m11:02:31.990048 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:31.990510 [debug] [MainThread]: On master: COMMIT
[0m11:02:31.991414 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:02:31.991963 [debug] [MainThread]: On master: Close
[0m11:02:31.992657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:31.993079 [debug] [MainThread]: Connection 'create_warehouse_main_raw' was properly closed.
[0m11:02:31.993446 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m11:02:31.993801 [debug] [MainThread]: Connection 'list_warehouse_main' was properly closed.
[0m11:02:31.994166 [debug] [MainThread]: Connection 'seed.raysearch_project.customer' was properly closed.
[0m11:02:31.994520 [debug] [MainThread]: Connection 'seed.raysearch_project.currency_exchange' was properly closed.
[0m11:02:31.994862 [debug] [MainThread]: Connection 'seed.raysearch_project.transaction' was properly closed.
[0m11:02:31.996203 [info ] [MainThread]: 
[0m11:02:31.997318 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 16.62 seconds (16.62s).
[0m11:02:31.999436 [debug] [MainThread]: Command end result
[0m11:02:32.043820 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m11:02:32.049341 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m11:02:32.065973 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m11:02:32.066749 [info ] [MainThread]: 
[0m11:02:32.067950 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:02:32.069718 [info ] [MainThread]: 
[0m11:02:32.070937 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m11:02:32.072670 [debug] [MainThread]: Command `dbt seed` succeeded at 11:02:32.072442 after 27.66 seconds
[0m11:02:32.073353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196CF65A6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196D7C2E5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196D576D190>]}
[0m11:02:32.073947 [debug] [MainThread]: Flushing usage events
[0m11:02:33.502376 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:11.392785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CB4A4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CC5DBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CC5DB9D0>]}


============================== 13:34:11.398912 | 908e3320-d448-42c5-9e08-898fd51e71be ==============================
[0m13:34:11.398912 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:34:11.399552 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt seed', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m13:34:11.910286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '908e3320-d448-42c5-9e08-898fd51e71be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CB916060>]}
[0m13:34:11.963662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '908e3320-d448-42c5-9e08-898fd51e71be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CD6229C0>]}
[0m13:34:11.995053 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:34:12.426483 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:34:12.499713 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:34:12.501320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '908e3320-d448-42c5-9e08-898fd51e71be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CD672B50>]}
[0m13:34:16.249351 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on 'customer' in
package 'raysearch_project' (seeds\seeds.yml). Arguments to generic tests should
be nested under the `arguments` property.
[0m13:34:16.250637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '908e3320-d448-42c5-9e08-898fd51e71be', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CDB42E40>]}
[0m13:34:16.354773 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.intermediate
- models.raysearch_project.marts
[0m13:34:16.358764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '908e3320-d448-42c5-9e08-898fd51e71be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CDFDACF0>]}
[0m13:34:16.423454 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:34:16.455099 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:34:16.491413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '908e3320-d448-42c5-9e08-898fd51e71be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CE0657E0>]}
[0m13:34:16.491840 [info ] [MainThread]: Found 4 models, 3 seeds, 16 data tests, 472 macros
[0m13:34:16.492321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '908e3320-d448-42c5-9e08-898fd51e71be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CDEBDA90>]}
[0m13:34:16.493857 [info ] [MainThread]: 
[0m13:34:16.494318 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:34:16.494624 [info ] [MainThread]: 
[0m13:34:16.495041 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:34:16.498235 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m13:34:22.220253 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:34:22.220644 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:34:22.220835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:22.254670 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m13:34:22.255807 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:34:22.256372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_raw)
[0m13:34:22.256695 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_raw"
"
[0m13:34:22.260824 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m13:34:22.261072 [debug] [ThreadPool]: On create_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m13:34:22.261255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:22.262053 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:34:22.262861 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m13:34:22.263140 [debug] [ThreadPool]: On create_warehouse_main_raw: BEGIN
[0m13:34:22.263492 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:34:22.263678 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m13:34:22.263836 [debug] [ThreadPool]: On create_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_raw"} */

    
    
        create schema if not exists "warehouse"."main_raw"
    
[0m13:34:22.264267 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:34:22.264791 [debug] [ThreadPool]: On create_warehouse_main_raw: COMMIT
[0m13:34:22.264975 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m13:34:22.265137 [debug] [ThreadPool]: On create_warehouse_main_raw: COMMIT
[0m13:34:22.265481 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:34:22.265662 [debug] [ThreadPool]: On create_warehouse_main_raw: Close
[0m13:34:22.267761 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m13:34:22.275189 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:34:22.275679 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m13:34:22.275946 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m13:34:22.277048 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m13:34:22.277288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:22.277489 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m13:34:22.277876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:22.278191 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:34:22.278385 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:34:22.278553 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:34:22.278742 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m13:34:22.278934 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m13:34:22.279259 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m13:34:22.290528 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:34:22.291067 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m13:34:22.292366 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m13:34:22.293186 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m13:34:22.323341 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m13:34:22.323741 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m13:34:22.324800 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m13:34:22.325025 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m13:34:22.325679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '908e3320-d448-42c5-9e08-898fd51e71be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CE0F5910>]}
[0m13:34:22.326235 [debug] [MainThread]: Using duckdb connection "master"
[0m13:34:22.326520 [debug] [MainThread]: On master: BEGIN
[0m13:34:22.326775 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:34:22.327569 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:34:22.327772 [debug] [MainThread]: On master: COMMIT
[0m13:34:22.327938 [debug] [MainThread]: Using duckdb connection "master"
[0m13:34:22.328083 [debug] [MainThread]: On master: COMMIT
[0m13:34:22.328517 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:34:22.328836 [debug] [MainThread]: On master: Close
[0m13:34:22.334201 [debug] [Thread-3 (]: Began running node seed.raysearch_project.transaction
[0m13:34:22.334665 [debug] [Thread-2 (]: Began running node seed.raysearch_project.customer
[0m13:34:22.335025 [debug] [Thread-1 (]: Began running node seed.raysearch_project.currency_exchange
[0m13:34:22.335515 [info ] [Thread-3 (]: 3 of 3 START seed file main_raw.transaction .................................... [RUN]
[0m13:34:22.336613 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.raysearch_project.transaction'
[0m13:34:22.335836 [info ] [Thread-2 (]: 2 of 3 START seed file main_raw.customer ....................................... [RUN]
[0m13:34:22.336945 [debug] [Thread-3 (]: Began compiling node seed.raysearch_project.transaction
[0m13:34:22.336198 [info ] [Thread-1 (]: 1 of 3 START seed file main_raw.currency_exchange .............................. [RUN]
[0m13:34:22.337311 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.raysearch_project.customer'
[0m13:34:22.337571 [debug] [Thread-3 (]: Began executing node seed.raysearch_project.transaction
[0m13:34:22.337855 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.raysearch_project.currency_exchange'
[0m13:34:22.338074 [debug] [Thread-2 (]: Began compiling node seed.raysearch_project.customer
[0m13:34:22.349642 [debug] [Thread-1 (]: Began compiling node seed.raysearch_project.currency_exchange
[0m13:34:22.350858 [debug] [Thread-2 (]: Began executing node seed.raysearch_project.customer
[0m13:34:22.351699 [debug] [Thread-1 (]: Began executing node seed.raysearch_project.currency_exchange
[0m13:34:22.378378 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m13:34:22.398501 [debug] [Thread-2 (]: On seed.raysearch_project.customer: BEGIN
[0m13:34:22.413661 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:34:22.451789 [debug] [Thread-2 (]: SQL status: OK in 0.038 seconds
[0m13:34:22.452228 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m13:34:22.469357 [debug] [Thread-2 (]: On seed.raysearch_project.customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "seed.raysearch_project.customer"} */
truncate table "warehouse"."main_raw"."customer"
[0m13:34:22.500941 [debug] [Thread-2 (]: SQL status: OK in 0.031 seconds
[0m13:34:22.509211 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m13:34:22.515957 [debug] [Thread-2 (]: On seed.raysearch_project.customer: 
          COPY "warehouse"."main_raw"."customer" FROM 'C:\Users\AMANDAKA\Workspaces\raysearch_project\seeds\customer.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:34:22.636871 [debug] [Thread-2 (]: SQL status: OK in 0.069 seconds
[0m13:34:22.638778 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m13:34:22.642622 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.raysearch_project.customer"
[0m13:34:22.701685 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: BEGIN
[0m13:34:22.924394 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:34:22.975179 [debug] [Thread-2 (]: On seed.raysearch_project.customer: COMMIT
[0m13:34:22.986753 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m13:34:22.987339 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m13:34:23.014720 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m13:34:23.015212 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m13:34:23.015599 [debug] [Thread-2 (]: On seed.raysearch_project.customer: COMMIT
[0m13:34:23.015985 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: BEGIN
[0m13:34:23.016451 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "seed.raysearch_project.currency_exchange"} */
truncate table "warehouse"."main_raw"."currency_exchange"
[0m13:34:23.016949 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:34:23.018599 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:34:23.018864 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m13:34:23.019168 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:34:23.019623 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "seed.raysearch_project.transaction"} */
truncate table "warehouse"."main_raw"."transaction"
[0m13:34:23.020640 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m13:34:23.021320 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: 
          COPY "warehouse"."main_raw"."currency_exchange" FROM 'C:\Users\AMANDAKA\Workspaces\raysearch_project\seeds\currency_exchange.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:34:23.021635 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:34:23.023058 [debug] [Thread-2 (]: On seed.raysearch_project.customer: Close
[0m13:34:23.024401 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:34:23.025443 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m13:34:23.025690 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: 
          COPY "warehouse"."main_raw"."transaction" FROM 'C:\Users\AMANDAKA\Workspaces\raysearch_project\seeds\transaction.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:34:23.027306 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '908e3320-d448-42c5-9e08-898fd51e71be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CB89F6B0>]}
[0m13:34:23.027967 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file main_raw.customer ................................... [[32mINSERT 67[0m in 0.69s]
[0m13:34:23.028896 [debug] [Thread-2 (]: Finished running node seed.raysearch_project.customer
[0m13:34:23.088336 [debug] [Thread-3 (]: SQL status: OK in 0.062 seconds
[0m13:34:23.089115 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.raysearch_project.transaction"
[0m13:34:23.091572 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: COMMIT
[0m13:34:23.091934 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m13:34:23.092173 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: COMMIT
[0m13:34:23.107923 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m13:34:23.108706 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: Close
[0m13:34:23.109147 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '908e3320-d448-42c5-9e08-898fd51e71be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220D1B486D0>]}
[0m13:34:23.109550 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file main_raw.transaction ................................ [[32mINSERT 38025[0m in 0.77s]
[0m13:34:23.110500 [debug] [Thread-3 (]: Finished running node seed.raysearch_project.transaction
[0m13:34:23.119180 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m13:34:23.120121 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.raysearch_project.currency_exchange"
[0m13:34:23.122301 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: COMMIT
[0m13:34:23.122593 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m13:34:23.122785 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: COMMIT
[0m13:34:23.124686 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:34:23.125259 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: Close
[0m13:34:23.125655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '908e3320-d448-42c5-9e08-898fd51e71be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CE0A4050>]}
[0m13:34:23.126008 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file main_raw.currency_exchange .......................... [[32mINSERT 1977[0m in 0.79s]
[0m13:34:23.126652 [debug] [Thread-1 (]: Finished running node seed.raysearch_project.currency_exchange
[0m13:34:23.127825 [debug] [MainThread]: Using duckdb connection "master"
[0m13:34:23.128028 [debug] [MainThread]: On master: BEGIN
[0m13:34:23.128178 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:34:23.128621 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:34:23.128807 [debug] [MainThread]: On master: COMMIT
[0m13:34:23.128962 [debug] [MainThread]: Using duckdb connection "master"
[0m13:34:23.129104 [debug] [MainThread]: On master: COMMIT
[0m13:34:23.129507 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:34:23.129716 [debug] [MainThread]: On master: Close
[0m13:34:23.129951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:34:23.130096 [debug] [MainThread]: Connection 'create_warehouse_main_raw' was properly closed.
[0m13:34:23.130228 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m13:34:23.130359 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m13:34:23.130629 [debug] [MainThread]: Connection 'seed.raysearch_project.transaction' was properly closed.
[0m13:34:23.130792 [debug] [MainThread]: Connection 'seed.raysearch_project.customer' was properly closed.
[0m13:34:23.130943 [debug] [MainThread]: Connection 'seed.raysearch_project.currency_exchange' was properly closed.
[0m13:34:23.131184 [info ] [MainThread]: 
[0m13:34:23.131725 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 6.64 seconds (6.64s).
[0m13:34:23.132774 [debug] [MainThread]: Command end result
[0m13:34:23.156571 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:34:23.159498 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:34:23.165981 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m13:34:23.166662 [info ] [MainThread]: 
[0m13:34:23.167412 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:34:23.167917 [info ] [MainThread]: 
[0m13:34:23.168427 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m13:34:23.169324 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:34:23.170512 [debug] [MainThread]: Command `dbt seed` succeeded at 13:34:23.170295 after 11.95 seconds
[0m13:34:23.171123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CC3E6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220C9CB4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220D1E97BF0>]}
[0m13:34:23.171685 [debug] [MainThread]: Flushing usage events
[0m13:34:24.007976 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:35:42.729740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A10D5A4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A10E6DFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A10E6DF9D0>]}


============================== 13:35:42.736611 | ae2a7353-c091-465a-9119-34a56777d7c1 ==============================
[0m13:35:42.736611 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:35:42.737396 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt seed', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m13:35:42.963114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae2a7353-c091-465a-9119-34a56777d7c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A10DA16060>]}
[0m13:35:43.020464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae2a7353-c091-465a-9119-34a56777d7c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A10F7229C0>]}
[0m13:35:43.024818 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:35:43.231581 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:35:43.414736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:35:43.415592 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://seeds\transaction.csv
[0m13:35:43.415872 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://seeds\customer.csv
[0m13:35:43.762499 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'transaction' in
package 'raysearch_project' (seeds\seeds.yml). Arguments to generic tests should
be nested under the `arguments` property.
[0m13:35:43.763741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ae2a7353-c091-465a-9119-34a56777d7c1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A10FC8E350>]}
[0m13:35:43.867898 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.intermediate
- models.raysearch_project.marts
[0m13:35:43.872077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae2a7353-c091-465a-9119-34a56777d7c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A10FCB72F0>]}
[0m13:35:43.946308 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:35:43.950969 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:35:43.995057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae2a7353-c091-465a-9119-34a56777d7c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A10FE86510>]}
[0m13:35:43.996019 [info ] [MainThread]: Found 4 models, 3 seeds, 16 data tests, 472 macros
[0m13:35:43.996944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae2a7353-c091-465a-9119-34a56777d7c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A10FFD07A0>]}
[0m13:35:44.000178 [info ] [MainThread]: 
[0m13:35:44.000887 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:35:44.001675 [info ] [MainThread]: 
[0m13:35:44.002634 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:35:44.008850 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m13:35:44.151292 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:35:44.151970 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:35:44.152399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:44.193009 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m13:35:44.194432 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:35:44.195150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_raw)
[0m13:35:44.195515 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_raw"
"
[0m13:35:44.200801 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m13:35:44.201232 [debug] [ThreadPool]: On create_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m13:35:44.201495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:44.202720 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:35:44.203954 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m13:35:44.204245 [debug] [ThreadPool]: On create_warehouse_main_raw: BEGIN
[0m13:35:44.204727 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:35:44.205003 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m13:35:44.205231 [debug] [ThreadPool]: On create_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_raw"} */

    
    
        create schema if not exists "warehouse"."main_raw"
    
[0m13:35:44.205717 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:35:44.206456 [debug] [ThreadPool]: On create_warehouse_main_raw: COMMIT
[0m13:35:44.206731 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m13:35:44.206984 [debug] [ThreadPool]: On create_warehouse_main_raw: COMMIT
[0m13:35:44.207445 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:35:44.207723 [debug] [ThreadPool]: On create_warehouse_main_raw: Close
[0m13:35:44.209547 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m13:35:44.215215 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m13:35:44.215739 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m13:35:44.216037 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m13:35:44.218400 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:35:44.218817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:44.219229 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m13:35:44.219783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:44.220138 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:35:44.220482 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:35:44.220714 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m13:35:44.221063 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:35:44.221321 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m13:35:44.221677 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m13:35:44.236056 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:35:44.236573 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:35:44.237749 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m13:35:44.238959 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m13:35:44.241654 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m13:35:44.242023 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m13:35:44.243038 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m13:35:44.243279 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m13:35:44.244011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae2a7353-c091-465a-9119-34a56777d7c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A10FE26690>]}
[0m13:35:44.244617 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:44.244957 [debug] [MainThread]: On master: BEGIN
[0m13:35:44.245260 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:35:44.246242 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:35:44.246767 [debug] [MainThread]: On master: COMMIT
[0m13:35:44.247225 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:44.247717 [debug] [MainThread]: On master: COMMIT
[0m13:35:44.248638 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:35:44.249074 [debug] [MainThread]: On master: Close
[0m13:35:44.254137 [debug] [Thread-2 (]: Began running node seed.raysearch_project.customer
[0m13:35:44.254608 [debug] [Thread-1 (]: Began running node seed.raysearch_project.currency_exchange
[0m13:35:44.255079 [debug] [Thread-3 (]: Began running node seed.raysearch_project.transaction
[0m13:35:44.255468 [info ] [Thread-2 (]: 2 of 3 START seed file main_raw.customer ....................................... [RUN]
[0m13:35:44.255768 [info ] [Thread-1 (]: 1 of 3 START seed file main_raw.currency_exchange .............................. [RUN]
[0m13:35:44.256618 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.raysearch_project.customer'
[0m13:35:44.256182 [info ] [Thread-3 (]: 3 of 3 START seed file main_raw.transaction .................................... [RUN]
[0m13:35:44.257106 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.raysearch_project.currency_exchange'
[0m13:35:44.257468 [debug] [Thread-2 (]: Began compiling node seed.raysearch_project.customer
[0m13:35:44.257745 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.raysearch_project.transaction'
[0m13:35:44.257986 [debug] [Thread-1 (]: Began compiling node seed.raysearch_project.currency_exchange
[0m13:35:44.258255 [debug] [Thread-2 (]: Began executing node seed.raysearch_project.customer
[0m13:35:44.258491 [debug] [Thread-3 (]: Began compiling node seed.raysearch_project.transaction
[0m13:35:44.258731 [debug] [Thread-1 (]: Began executing node seed.raysearch_project.currency_exchange
[0m13:35:44.273621 [debug] [Thread-3 (]: Began executing node seed.raysearch_project.transaction
[0m13:35:44.293162 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m13:35:44.293607 [debug] [Thread-2 (]: On seed.raysearch_project.customer: BEGIN
[0m13:35:44.293875 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:35:44.331091 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m13:35:44.333422 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m13:35:44.342323 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m13:35:44.379881 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: BEGIN
[0m13:35:44.446877 [debug] [Thread-2 (]: On seed.raysearch_project.customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "seed.raysearch_project.customer"} */
truncate table "warehouse"."main_raw"."customer"
[0m13:35:44.496063 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:35:44.614270 [debug] [Thread-2 (]: SQL status: OK in 0.048 seconds
[0m13:35:44.681233 [debug] [Thread-1 (]: SQL status: OK in 0.185 seconds
[0m13:35:44.706878 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m13:35:44.746724 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m13:35:44.794972 [debug] [Thread-2 (]: On seed.raysearch_project.customer: 
          COPY "warehouse"."main_raw"."customer" FROM 'C:\Users\AMANDAKA\Workspaces\raysearch_project\seeds\customer.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:35:44.842523 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "seed.raysearch_project.currency_exchange"} */
truncate table "warehouse"."main_raw"."currency_exchange"
[0m13:35:45.025402 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m13:35:45.026007 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m13:35:45.026375 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: BEGIN
[0m13:35:45.032427 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.raysearch_project.customer"
[0m13:35:45.032835 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:35:45.033195 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m13:35:45.035135 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m13:35:45.035599 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: 
          COPY "warehouse"."main_raw"."currency_exchange" FROM 'C:\Users\AMANDAKA\Workspaces\raysearch_project\seeds\currency_exchange.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:35:45.035871 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:35:45.036334 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m13:35:45.047049 [debug] [Thread-2 (]: On seed.raysearch_project.customer: COMMIT
[0m13:35:45.047879 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "seed.raysearch_project.transaction"} */
truncate table "warehouse"."main_raw"."transaction"
[0m13:35:45.048401 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m13:35:45.049129 [debug] [Thread-2 (]: On seed.raysearch_project.customer: COMMIT
[0m13:35:45.050287 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:35:45.051996 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m13:35:45.052514 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: 
          COPY "warehouse"."main_raw"."transaction" FROM 'C:\Users\AMANDAKA\Workspaces\raysearch_project\seeds\transaction.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:35:45.053238 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:35:45.054790 [debug] [Thread-2 (]: On seed.raysearch_project.customer: Close
[0m13:35:45.057884 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae2a7353-c091-465a-9119-34a56777d7c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A110032F10>]}
[0m13:35:45.058436 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file main_raw.customer ................................... [[32mINSERT 67[0m in 0.80s]
[0m13:35:45.059080 [debug] [Thread-2 (]: Finished running node seed.raysearch_project.customer
[0m13:35:45.123414 [debug] [Thread-3 (]: SQL status: OK in 0.070 seconds
[0m13:35:45.124565 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.raysearch_project.transaction"
[0m13:35:45.126855 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: COMMIT
[0m13:35:45.127157 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m13:35:45.127359 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: COMMIT
[0m13:35:45.144520 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m13:35:45.145371 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: Close
[0m13:35:45.145911 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae2a7353-c091-465a-9119-34a56777d7c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A10D99F6B0>]}
[0m13:35:45.146674 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file main_raw.transaction ................................ [[32mINSERT 38025[0m in 0.89s]
[0m13:35:45.147748 [debug] [Thread-3 (]: Finished running node seed.raysearch_project.transaction
[0m13:35:45.275479 [debug] [Thread-1 (]: SQL status: OK in 0.239 seconds
[0m13:35:45.276634 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.raysearch_project.currency_exchange"
[0m13:35:45.281494 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: COMMIT
[0m13:35:45.282783 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m13:35:45.283574 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: COMMIT
[0m13:35:45.286794 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:35:45.288118 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: Close
[0m13:35:45.288921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae2a7353-c091-465a-9119-34a56777d7c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1102B6350>]}
[0m13:35:45.289641 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file main_raw.currency_exchange .......................... [[32mINSERT 1977[0m in 1.03s]
[0m13:35:45.290632 [debug] [Thread-1 (]: Finished running node seed.raysearch_project.currency_exchange
[0m13:35:45.292462 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:45.292758 [debug] [MainThread]: On master: BEGIN
[0m13:35:45.292927 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:35:45.293708 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:35:45.293972 [debug] [MainThread]: On master: COMMIT
[0m13:35:45.294153 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:45.294324 [debug] [MainThread]: On master: COMMIT
[0m13:35:45.294684 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:35:45.294924 [debug] [MainThread]: On master: Close
[0m13:35:45.295233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:35:45.295441 [debug] [MainThread]: Connection 'create_warehouse_main_raw' was properly closed.
[0m13:35:45.295684 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m13:35:45.296482 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m13:35:45.296874 [debug] [MainThread]: Connection 'seed.raysearch_project.customer' was properly closed.
[0m13:35:45.297185 [debug] [MainThread]: Connection 'seed.raysearch_project.currency_exchange' was properly closed.
[0m13:35:45.297521 [debug] [MainThread]: Connection 'seed.raysearch_project.transaction' was properly closed.
[0m13:35:45.297887 [info ] [MainThread]: 
[0m13:35:45.298455 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 1.30 seconds (1.30s).
[0m13:35:45.299796 [debug] [MainThread]: Command end result
[0m13:35:45.325658 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:35:45.330426 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:35:45.338245 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m13:35:45.338648 [info ] [MainThread]: 
[0m13:35:45.339348 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:35:45.340040 [info ] [MainThread]: 
[0m13:35:45.340676 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m13:35:45.341587 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:35:45.342941 [debug] [MainThread]: Command `dbt seed` succeeded at 13:35:45.342742 after 2.77 seconds
[0m13:35:45.343476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1078FA6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A10DFBE510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A112FF9310>]}
[0m13:35:45.343978 [debug] [MainThread]: Flushing usage events
[0m13:35:46.328413 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:10.425068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248D7E94830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248D8FCFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248D8FCF9D0>]}


============================== 13:36:10.433215 | 74f590af-d734-4896-8857-d236551f53ac ==============================
[0m13:36:10.433215 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:36:10.434126 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt test', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m13:36:10.673242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74f590af-d734-4896-8857-d236551f53ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248D8306060>]}
[0m13:36:10.731945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74f590af-d734-4896-8857-d236551f53ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248D903E9C0>]}
[0m13:36:10.735988 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:36:10.937874 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:36:11.091197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:36:11.091573 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:36:11.091761 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:36:11.097241 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.intermediate
- models.raysearch_project.marts
[0m13:36:11.135426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74f590af-d734-4896-8857-d236551f53ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248DA4A1E50>]}
[0m13:36:11.205680 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:36:11.210538 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:36:11.352563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74f590af-d734-4896-8857-d236551f53ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248D4DA35C0>]}
[0m13:36:11.353108 [info ] [MainThread]: Found 4 models, 3 seeds, 16 data tests, 472 macros
[0m13:36:11.353769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74f590af-d734-4896-8857-d236551f53ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248DA265630>]}
[0m13:36:11.360413 [info ] [MainThread]: 
[0m13:36:11.361372 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:36:11.362050 [info ] [MainThread]: 
[0m13:36:11.363089 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:36:11.369870 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m13:36:11.378491 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m13:36:11.513831 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:36:11.514380 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m13:36:11.514834 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m13:36:11.515129 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m13:36:11.515495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:11.515864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:11.554115 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m13:36:11.554529 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:36:11.554786 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m13:36:11.555053 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m13:36:11.555299 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m13:36:11.555706 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m13:36:11.569395 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:36:11.570059 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:36:11.571262 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m13:36:11.572099 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m13:36:11.574607 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m13:36:11.574965 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m13:36:11.575568 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m13:36:11.575844 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m13:36:11.576985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74f590af-d734-4896-8857-d236551f53ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248DA8FA270>]}
[0m13:36:11.577650 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:11.577969 [debug] [MainThread]: On master: BEGIN
[0m13:36:11.578290 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:36:11.579342 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:36:11.579650 [debug] [MainThread]: On master: COMMIT
[0m13:36:11.579847 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:11.580023 [debug] [MainThread]: On master: COMMIT
[0m13:36:11.580602 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:36:11.581020 [debug] [MainThread]: On master: Close
[0m13:36:11.586159 [debug] [Thread-1 (]: Began running node test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c
[0m13:36:11.586727 [debug] [Thread-4 (]: Began running node test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41
[0m13:36:11.587204 [debug] [Thread-3 (]: Began running node test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb
[0m13:36:11.587506 [debug] [Thread-2 (]: Began running node test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773
[0m13:36:11.587841 [info ] [Thread-1 (]: 1 of 16 START test accepted_values_customer_KYC__0__1 .......................... [RUN]
[0m13:36:11.588104 [info ] [Thread-4 (]: 4 of 16 START test accepted_values_customer_wantsNewsletter__0__1 .............. [RUN]
[0m13:36:11.588473 [info ] [Thread-3 (]: 3 of 16 START test accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE . [RUN]
[0m13:36:11.589391 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c'
[0m13:36:11.589782 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41'
[0m13:36:11.588779 [info ] [Thread-2 (]: 2 of 16 START test accepted_values_customer_VIP__0__1 .......................... [RUN]
[0m13:36:11.590490 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb'
[0m13:36:11.591363 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c
[0m13:36:11.592216 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41
[0m13:36:11.592940 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773'
[0m13:36:11.593535 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb
[0m13:36:11.609292 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"
[0m13:36:11.613371 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"
[0m13:36:11.614341 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773
[0m13:36:11.620978 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"
[0m13:36:11.624885 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"
[0m13:36:11.629120 [debug] [Thread-3 (]: Began executing node test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb
[0m13:36:11.643778 [debug] [Thread-1 (]: Began executing node test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c
[0m13:36:11.653339 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"
[0m13:36:11.654468 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"
[0m13:36:11.655289 [debug] [Thread-2 (]: Began executing node test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773
[0m13:36:11.660649 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"
[0m13:36:11.661476 [debug] [Thread-4 (]: Began executing node test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41
[0m13:36:11.664653 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"
[0m13:36:11.665652 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"
[0m13:36:11.666303 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c: BEGIN
[0m13:36:11.666840 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:36:11.667416 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"
[0m13:36:11.668486 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773: BEGIN
[0m13:36:11.669049 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"
[0m13:36:11.669602 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:36:11.670015 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb: BEGIN
[0m13:36:11.670482 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:36:11.670918 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"
[0m13:36:11.671576 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:36:11.672080 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"
[0m13:36:11.672368 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:36:11.672637 [debug] [Thread-4 (]: On test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41: BEGIN
[0m13:36:11.673226 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        KYC as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."customer"
    group by KYC

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  
      
    ) dbt_internal_test
[0m13:36:11.673566 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"
[0m13:36:11.673858 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:36:11.674092 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:36:11.674627 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        VIP as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."customer"
    group by VIP

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  
      
    ) dbt_internal_test
[0m13:36:11.675063 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"
[0m13:36:11.676024 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."customer"
    group by state

)

select *
from all_values
where value_field not in (
    'VALIDATED','SIGNUP','INACTIVE'
)



  
  
      
    ) dbt_internal_test
[0m13:36:11.676427 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:36:11.676900 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:36:11.677493 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:36:11.677840 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"
[0m13:36:11.678586 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:36:11.682699 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c: ROLLBACK
[0m13:36:11.683263 [debug] [Thread-4 (]: On test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        wantsNewsletter as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."customer"
    group by wantsNewsletter

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  
      
    ) dbt_internal_test
[0m13:36:11.686838 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773: ROLLBACK
[0m13:36:11.689302 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb: ROLLBACK
[0m13:36:11.691327 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c'
[0m13:36:11.691965 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c: Close
[0m13:36:11.692509 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:36:11.693252 [info ] [Thread-1 (]: 1 of 16 PASS accepted_values_customer_KYC__0__1 ................................ [[32mPASS[0m in 0.10s]
[0m13:36:11.694229 [debug] [Thread-1 (]: Finished running node test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c
[0m13:36:11.696201 [debug] [Thread-4 (]: On test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41: ROLLBACK
[0m13:36:11.696737 [debug] [Thread-1 (]: Began running node test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a
[0m13:36:11.697942 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb'
[0m13:36:11.698734 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb: Close
[0m13:36:11.698378 [info ] [Thread-1 (]: 5 of 16 START test accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL ..... [RUN]
[0m13:36:11.699869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c, now test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a)
[0m13:36:11.699403 [info ] [Thread-3 (]: 3 of 16 PASS accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE ....... [[32mPASS[0m in 0.11s]
[0m13:36:11.700557 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a
[0m13:36:11.701278 [debug] [Thread-3 (]: Finished running node test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb
[0m13:36:11.705492 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"
[0m13:36:11.706124 [debug] [Thread-3 (]: Began running node test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff
[0m13:36:11.707336 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773'
[0m13:36:11.706696 [info ] [Thread-3 (]: 6 of 16 START test not_null_currency_exchange_baseRateEuro ..................... [RUN]
[0m13:36:11.708037 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773: Close
[0m13:36:11.708554 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb, now test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff)
[0m13:36:11.709686 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff
[0m13:36:11.709274 [info ] [Thread-2 (]: 2 of 16 PASS accepted_values_customer_VIP__0__1 ................................ [[32mPASS[0m in 0.12s]
[0m13:36:11.720601 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"
[0m13:36:11.721107 [debug] [Thread-1 (]: Began executing node test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a
[0m13:36:11.721694 [debug] [Thread-2 (]: Finished running node test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773
[0m13:36:11.722262 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41'
[0m13:36:11.724784 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"
[0m13:36:11.725385 [debug] [Thread-2 (]: Began running node test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f
[0m13:36:11.725871 [debug] [Thread-4 (]: On test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41: Close
[0m13:36:11.727019 [debug] [Thread-3 (]: Began executing node test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff
[0m13:36:11.726527 [info ] [Thread-2 (]: 7 of 16 START test not_null_currency_exchange_currency ......................... [RUN]
[0m13:36:11.729340 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"
[0m13:36:11.731040 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773, now test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f)
[0m13:36:11.730169 [info ] [Thread-4 (]: 4 of 16 PASS accepted_values_customer_wantsNewsletter__0__1 .................... [[32mPASS[0m in 0.14s]
[0m13:36:11.731859 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"
[0m13:36:11.732706 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f
[0m13:36:11.733389 [debug] [Thread-4 (]: Finished running node test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41
[0m13:36:11.733790 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a: BEGIN
[0m13:36:11.737347 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"
[0m13:36:11.737836 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"
[0m13:36:11.738288 [debug] [Thread-4 (]: Began running node test.raysearch_project.not_null_currency_exchange_date.f508e913b3
[0m13:36:11.738815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:11.739205 [debug] [Thread-3 (]: On test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff: BEGIN
[0m13:36:11.739503 [info ] [Thread-4 (]: 8 of 16 START test not_null_currency_exchange_date ............................. [RUN]
[0m13:36:11.740175 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:36:11.740668 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41, now test.raysearch_project.not_null_currency_exchange_date.f508e913b3)
[0m13:36:11.741197 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:36:11.741969 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.not_null_currency_exchange_date.f508e913b3
[0m13:36:11.742383 [debug] [Thread-2 (]: Began executing node test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f
[0m13:36:11.742886 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"
[0m13:36:11.743379 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:36:11.749614 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"
[0m13:36:11.751642 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"
[0m13:36:11.752219 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        txType as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."transaction"
    group by txType

)

select *
from all_values
where value_field not in (
    'DEPOSIT','WITHDRAWAL'
)



  
  
      
    ) dbt_internal_test
[0m13:36:11.752761 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"
[0m13:36:11.753757 [debug] [Thread-3 (]: On test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select baseRateEuro
from "warehouse"."main_raw"."currency_exchange"
where baseRateEuro is null



  
  
      
    ) dbt_internal_test
[0m13:36:11.754697 [debug] [Thread-4 (]: Began executing node test.raysearch_project.not_null_currency_exchange_date.f508e913b3
[0m13:36:11.757043 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"
[0m13:36:11.757606 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:36:11.758039 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:36:11.760024 [debug] [Thread-3 (]: On test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff: ROLLBACK
[0m13:36:11.761941 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a: ROLLBACK
[0m13:36:11.762804 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"
[0m13:36:11.763415 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"
[0m13:36:11.764038 [debug] [Thread-2 (]: On test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f: BEGIN
[0m13:36:11.764671 [debug] [Thread-4 (]: On test.raysearch_project.not_null_currency_exchange_date.f508e913b3: BEGIN
[0m13:36:11.765127 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:36:11.765481 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:36:11.766457 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:36:11.766745 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"
[0m13:36:11.766968 [debug] [Thread-2 (]: On test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from "warehouse"."main_raw"."currency_exchange"
where currency is null



  
  
      
    ) dbt_internal_test
[0m13:36:11.767309 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:36:11.768806 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff'
[0m13:36:11.770284 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"
[0m13:36:11.770792 [debug] [Thread-3 (]: On test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff: Close
[0m13:36:11.771479 [debug] [Thread-4 (]: On test.raysearch_project.not_null_currency_exchange_date.f508e913b3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_raw"."currency_exchange"
where date is null



  
  
      
    ) dbt_internal_test
[0m13:36:11.772112 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:36:11.772806 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a'
[0m13:36:11.773574 [info ] [Thread-3 (]: 6 of 16 PASS not_null_currency_exchange_baseRateEuro ........................... [[32mPASS[0m in 0.07s]
[0m13:36:11.775113 [debug] [Thread-2 (]: On test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f: ROLLBACK
[0m13:36:11.775492 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a: Close
[0m13:36:11.776168 [debug] [Thread-3 (]: Finished running node test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff
[0m13:36:11.776878 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:36:11.780157 [debug] [Thread-3 (]: Began running node test.raysearch_project.not_null_customer_customerID.cdb9e51021
[0m13:36:11.779390 [info ] [Thread-1 (]: 5 of 16 PASS accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL ........... [[32mPASS[0m in 0.08s]
[0m13:36:11.782057 [debug] [Thread-1 (]: Finished running node test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a
[0m13:36:11.781489 [info ] [Thread-3 (]: 9 of 16 START test not_null_customer_customerID ................................ [RUN]
[0m13:36:11.784332 [debug] [Thread-4 (]: On test.raysearch_project.not_null_currency_exchange_date.f508e913b3: ROLLBACK
[0m13:36:11.784801 [debug] [Thread-1 (]: Began running node test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b
[0m13:36:11.785499 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff, now test.raysearch_project.not_null_customer_customerID.cdb9e51021)
[0m13:36:11.785946 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f'
[0m13:36:11.786320 [info ] [Thread-1 (]: 10 of 16 START test not_null_customer_latestUpdate ............................. [RUN]
[0m13:36:11.786885 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.not_null_customer_customerID.cdb9e51021
[0m13:36:11.787346 [debug] [Thread-2 (]: On test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f: Close
[0m13:36:11.787937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a, now test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b)
[0m13:36:11.792476 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.not_null_customer_customerID.cdb9e51021"
[0m13:36:11.793327 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.not_null_currency_exchange_date.f508e913b3'
[0m13:36:11.794474 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b
[0m13:36:11.793990 [info ] [Thread-2 (]: 7 of 16 PASS not_null_currency_exchange_currency ............................... [[32mPASS[0m in 0.06s]
[0m13:36:11.795340 [debug] [Thread-4 (]: On test.raysearch_project.not_null_currency_exchange_date.f508e913b3: Close
[0m13:36:11.801292 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"
[0m13:36:11.802091 [debug] [Thread-2 (]: Finished running node test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f
[0m13:36:11.803167 [debug] [Thread-2 (]: Began running node test.raysearch_project.not_null_transaction_amount.8ca6f973e6
[0m13:36:11.803695 [debug] [Thread-3 (]: Began executing node test.raysearch_project.not_null_customer_customerID.cdb9e51021
[0m13:36:11.802714 [info ] [Thread-4 (]: 8 of 16 PASS not_null_currency_exchange_date ................................... [[32mPASS[0m in 0.06s]
[0m13:36:11.806284 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.not_null_customer_customerID.cdb9e51021"
[0m13:36:11.804434 [info ] [Thread-2 (]: 11 of 16 START test not_null_transaction_amount ................................ [RUN]
[0m13:36:11.807117 [debug] [Thread-4 (]: Finished running node test.raysearch_project.not_null_currency_exchange_date.f508e913b3
[0m13:36:11.807568 [debug] [Thread-1 (]: Began executing node test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b
[0m13:36:11.808038 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f, now test.raysearch_project.not_null_transaction_amount.8ca6f973e6)
[0m13:36:11.808372 [debug] [Thread-4 (]: Began running node test.raysearch_project.not_null_transaction_customerId.63105569e2
[0m13:36:11.810469 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"
[0m13:36:11.811063 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.not_null_transaction_amount.8ca6f973e6
[0m13:36:11.812557 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_customer_customerID.cdb9e51021"
[0m13:36:11.811863 [info ] [Thread-4 (]: 12 of 16 START test not_null_transaction_customerId ............................ [RUN]
[0m13:36:11.821986 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"
[0m13:36:11.822544 [debug] [Thread-3 (]: On test.raysearch_project.not_null_customer_customerID.cdb9e51021: BEGIN
[0m13:36:11.823127 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_currency_exchange_date.f508e913b3, now test.raysearch_project.not_null_transaction_customerId.63105569e2)
[0m13:36:11.823855 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"
[0m13:36:11.824221 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:36:11.824515 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.not_null_transaction_customerId.63105569e2
[0m13:36:11.824912 [debug] [Thread-1 (]: On test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b: BEGIN
[0m13:36:11.829827 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.not_null_transaction_customerId.63105569e2"
[0m13:36:11.830815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:11.831519 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m13:36:11.832159 [debug] [Thread-2 (]: Began executing node test.raysearch_project.not_null_transaction_amount.8ca6f973e6
[0m13:36:11.832993 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_customer_customerID.cdb9e51021"
[0m13:36:11.835507 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"
[0m13:36:11.835975 [debug] [Thread-3 (]: On test.raysearch_project.not_null_customer_customerID.cdb9e51021: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_customer_customerID.cdb9e51021"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customerID
from "warehouse"."main_raw"."customer"
where customerID is null



  
  
      
    ) dbt_internal_test
[0m13:36:11.836444 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:36:11.837389 [debug] [Thread-4 (]: Began executing node test.raysearch_project.not_null_transaction_customerId.63105569e2
[0m13:36:11.837781 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"
[0m13:36:11.839947 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.not_null_transaction_customerId.63105569e2"
[0m13:36:11.840442 [debug] [Thread-1 (]: On test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latestUpdate
from "warehouse"."main_raw"."customer"
where latestUpdate is null



  
  
      
    ) dbt_internal_test
[0m13:36:11.840790 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:36:11.841645 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"
[0m13:36:11.842300 [debug] [Thread-2 (]: On test.raysearch_project.not_null_transaction_amount.8ca6f973e6: BEGIN
[0m13:36:11.842746 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:36:11.844623 [debug] [Thread-3 (]: On test.raysearch_project.not_null_customer_customerID.cdb9e51021: ROLLBACK
[0m13:36:11.845355 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:36:11.847038 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:36:11.849180 [debug] [Thread-1 (]: On test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b: ROLLBACK
[0m13:36:11.849789 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_customerId.63105569e2"
[0m13:36:11.850301 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"
[0m13:36:11.850932 [debug] [Thread-4 (]: On test.raysearch_project.not_null_transaction_customerId.63105569e2: BEGIN
[0m13:36:11.851426 [debug] [Thread-2 (]: On test.raysearch_project.not_null_transaction_amount.8ca6f973e6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "warehouse"."main_raw"."transaction"
where amount is null



  
  
      
    ) dbt_internal_test
[0m13:36:11.851884 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.not_null_customer_customerID.cdb9e51021'
[0m13:36:11.852180 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:36:11.852968 [debug] [Thread-3 (]: On test.raysearch_project.not_null_customer_customerID.cdb9e51021: Close
[0m13:36:11.854345 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b'
[0m13:36:11.853768 [error] [Thread-3 (]: 9 of 16 FAIL 1 not_null_customer_customerID .................................... [[31mFAIL 1[0m in 0.07s]
[0m13:36:11.854933 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:36:11.855201 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:36:11.855457 [debug] [Thread-1 (]: On test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b: Close
[0m13:36:11.855831 [debug] [Thread-3 (]: Finished running node test.raysearch_project.not_null_customer_customerID.cdb9e51021
[0m13:36:11.856178 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_customerId.63105569e2"
[0m13:36:11.857202 [debug] [Thread-2 (]: On test.raysearch_project.not_null_transaction_amount.8ca6f973e6: ROLLBACK
[0m13:36:11.857656 [debug] [Thread-3 (]: Began running node test.raysearch_project.not_null_transaction_date.8d1d66da2c
[0m13:36:11.858417 [debug] [Thread-4 (]: On test.raysearch_project.not_null_transaction_customerId.63105569e2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_transaction_customerId.63105569e2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customerId
from "warehouse"."main_raw"."transaction"
where customerId is null



  
  
      
    ) dbt_internal_test
[0m13:36:11.858042 [info ] [Thread-1 (]: 10 of 16 PASS not_null_customer_latestUpdate ................................... [[32mPASS[0m in 0.07s]
[0m13:36:11.859221 [info ] [Thread-3 (]: 13 of 16 START test not_null_transaction_date .................................. [RUN]
[0m13:36:11.860553 [debug] [Thread-1 (]: Finished running node test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b
[0m13:36:11.861219 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_customer_customerID.cdb9e51021, now test.raysearch_project.not_null_transaction_date.8d1d66da2c)
[0m13:36:11.861902 [debug] [Thread-1 (]: Began running node test.raysearch_project.not_null_transaction_txCurrency.7798fc4041
[0m13:36:11.862741 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:36:11.863562 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.not_null_transaction_date.8d1d66da2c
[0m13:36:11.865384 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.not_null_transaction_amount.8ca6f973e6'
[0m13:36:11.864520 [info ] [Thread-1 (]: 14 of 16 START test not_null_transaction_txCurrency ............................ [RUN]
[0m13:36:11.869857 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.not_null_transaction_date.8d1d66da2c"
[0m13:36:11.871178 [debug] [Thread-4 (]: On test.raysearch_project.not_null_transaction_customerId.63105569e2: ROLLBACK
[0m13:36:11.871573 [debug] [Thread-2 (]: On test.raysearch_project.not_null_transaction_amount.8ca6f973e6: Close
[0m13:36:11.872707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b, now test.raysearch_project.not_null_transaction_txCurrency.7798fc4041)
[0m13:36:11.875006 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.not_null_transaction_txCurrency.7798fc4041
[0m13:36:11.880009 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"
[0m13:36:11.874523 [info ] [Thread-2 (]: 11 of 16 PASS not_null_transaction_amount ...................................... [[32mPASS[0m in 0.07s]
[0m13:36:11.881470 [debug] [Thread-2 (]: Finished running node test.raysearch_project.not_null_transaction_amount.8ca6f973e6
[0m13:36:11.882188 [debug] [Thread-3 (]: Began executing node test.raysearch_project.not_null_transaction_date.8d1d66da2c
[0m13:36:11.882905 [debug] [Thread-2 (]: Began running node test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8
[0m13:36:11.885389 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.not_null_transaction_date.8d1d66da2c"
[0m13:36:11.885950 [info ] [Thread-2 (]: 15 of 16 START test relationships_transaction_customerId__customerID__ref_customer_  [RUN]
[0m13:36:11.886761 [debug] [Thread-1 (]: Began executing node test.raysearch_project.not_null_transaction_txCurrency.7798fc4041
[0m13:36:11.887306 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_transaction_amount.8ca6f973e6, now test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8)
[0m13:36:11.887843 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.not_null_transaction_customerId.63105569e2'
[0m13:36:11.890844 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"
[0m13:36:11.891302 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8
[0m13:36:11.891597 [debug] [Thread-4 (]: On test.raysearch_project.not_null_transaction_customerId.63105569e2: Close
[0m13:36:11.891969 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_date.8d1d66da2c"
[0m13:36:11.900612 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"
[0m13:36:11.902289 [debug] [Thread-3 (]: On test.raysearch_project.not_null_transaction_date.8d1d66da2c: BEGIN
[0m13:36:11.901725 [info ] [Thread-4 (]: 12 of 16 PASS not_null_transaction_customerId .................................. [[32mPASS[0m in 0.08s]
[0m13:36:11.903063 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:36:11.903901 [debug] [Thread-4 (]: Finished running node test.raysearch_project.not_null_transaction_customerId.63105569e2
[0m13:36:11.904941 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"
[0m13:36:11.905475 [debug] [Thread-4 (]: Began running node test.raysearch_project.unique_customer_customerID.22ab727df1
[0m13:36:11.905958 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_txCurrency.7798fc4041: BEGIN
[0m13:36:11.906339 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:36:11.907018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:11.907531 [debug] [Thread-2 (]: Began executing node test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8
[0m13:36:11.906658 [info ] [Thread-4 (]: 16 of 16 START test unique_customer_customerID ................................. [RUN]
[0m13:36:11.907989 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_date.8d1d66da2c"
[0m13:36:11.910372 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"
[0m13:36:11.910895 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_transaction_customerId.63105569e2, now test.raysearch_project.unique_customer_customerID.22ab727df1)
[0m13:36:11.911500 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:36:11.912104 [debug] [Thread-3 (]: On test.raysearch_project.not_null_transaction_date.8d1d66da2c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_transaction_date.8d1d66da2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_raw"."transaction"
where date is null



  
  
      
    ) dbt_internal_test
[0m13:36:11.912809 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.unique_customer_customerID.22ab727df1
[0m13:36:11.913370 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"
[0m13:36:11.920510 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.unique_customer_customerID.22ab727df1"
[0m13:36:11.921136 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_txCurrency.7798fc4041: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txCurrency
from "warehouse"."main_raw"."transaction"
where txCurrency is null



  
  
      
    ) dbt_internal_test
[0m13:36:11.921617 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m13:36:11.922201 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"
[0m13:36:11.923100 [debug] [Thread-2 (]: On test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8: BEGIN
[0m13:36:11.923501 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:36:11.924051 [debug] [Thread-4 (]: Began executing node test.raysearch_project.unique_customer_customerID.22ab727df1
[0m13:36:11.924506 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:36:11.925529 [debug] [Thread-3 (]: On test.raysearch_project.not_null_transaction_date.8d1d66da2c: ROLLBACK
[0m13:36:11.927520 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.unique_customer_customerID.22ab727df1"
[0m13:36:11.928265 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:36:11.929427 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"
[0m13:36:11.931717 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_txCurrency.7798fc4041: ROLLBACK
[0m13:36:11.932845 [debug] [Thread-2 (]: On test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customerId as from_field
    from "warehouse"."main_raw"."transaction"
    where customerId is not null
),

parent as (
    select customerID as to_field
    from "warehouse"."main_raw"."customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:36:11.934448 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.unique_customer_customerID.22ab727df1"
[0m13:36:11.934875 [debug] [Thread-4 (]: On test.raysearch_project.unique_customer_customerID.22ab727df1: BEGIN
[0m13:36:11.935157 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:36:11.935860 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:36:11.936320 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.unique_customer_customerID.22ab727df1"
[0m13:36:11.936993 [debug] [Thread-4 (]: On test.raysearch_project.unique_customer_customerID.22ab727df1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.unique_customer_customerID.22ab727df1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customerID as unique_field,
    count(*) as n_records

from "warehouse"."main_raw"."customer"
where customerID is not null
group by customerID
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:36:11.937707 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.not_null_transaction_date.8d1d66da2c'
[0m13:36:11.938135 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:36:11.938568 [debug] [Thread-3 (]: On test.raysearch_project.not_null_transaction_date.8d1d66da2c: Close
[0m13:36:11.940258 [debug] [Thread-2 (]: On test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8: ROLLBACK
[0m13:36:11.941393 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:36:11.940885 [info ] [Thread-3 (]: 13 of 16 PASS not_null_transaction_date ........................................ [[32mPASS[0m in 0.08s]
[0m13:36:11.942118 [debug] [Thread-3 (]: Finished running node test.raysearch_project.not_null_transaction_date.8d1d66da2c
[0m13:36:11.943701 [debug] [Thread-4 (]: On test.raysearch_project.unique_customer_customerID.22ab727df1: ROLLBACK
[0m13:36:11.944489 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.not_null_transaction_txCurrency.7798fc4041'
[0m13:36:11.945166 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_txCurrency.7798fc4041: Close
[0m13:36:11.947128 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8'
[0m13:36:11.947792 [debug] [Thread-2 (]: On test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8: Close
[0m13:36:11.946101 [info ] [Thread-1 (]: 14 of 16 PASS not_null_transaction_txCurrency .................................. [[32mPASS[0m in 0.07s]
[0m13:36:11.949796 [debug] [Thread-1 (]: Finished running node test.raysearch_project.not_null_transaction_txCurrency.7798fc4041
[0m13:36:11.948690 [error] [Thread-2 (]: 15 of 16 FAIL 754 relationships_transaction_customerId__customerID__ref_customer_  [[31mFAIL 754[0m in 0.06s]
[0m13:36:11.950856 [debug] [Thread-2 (]: Finished running node test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8
[0m13:36:11.951430 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.unique_customer_customerID.22ab727df1'
[0m13:36:11.951922 [debug] [Thread-4 (]: On test.raysearch_project.unique_customer_customerID.22ab727df1: Close
[0m13:36:11.952631 [error] [Thread-4 (]: 16 of 16 FAIL 13 unique_customer_customerID .................................... [[31mFAIL 13[0m in 0.04s]
[0m13:36:11.953315 [debug] [Thread-4 (]: Finished running node test.raysearch_project.unique_customer_customerID.22ab727df1
[0m13:36:11.954674 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:11.954917 [debug] [MainThread]: On master: BEGIN
[0m13:36:11.955079 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:36:11.955624 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:36:11.955849 [debug] [MainThread]: On master: COMMIT
[0m13:36:11.956028 [debug] [MainThread]: Using duckdb connection "master"
[0m13:36:11.956210 [debug] [MainThread]: On master: COMMIT
[0m13:36:11.956562 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:36:11.956782 [debug] [MainThread]: On master: Close
[0m13:36:11.957074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:36:11.957253 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m13:36:11.957500 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m13:36:11.957679 [debug] [MainThread]: Connection 'test.raysearch_project.not_null_transaction_txCurrency.7798fc4041' was properly closed.
[0m13:36:11.957839 [debug] [MainThread]: Connection 'test.raysearch_project.unique_customer_customerID.22ab727df1' was properly closed.
[0m13:36:11.958007 [debug] [MainThread]: Connection 'test.raysearch_project.not_null_transaction_date.8d1d66da2c' was properly closed.
[0m13:36:11.958200 [debug] [MainThread]: Connection 'test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8' was properly closed.
[0m13:36:11.958469 [info ] [MainThread]: 
[0m13:36:11.959001 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m13:36:11.960968 [debug] [MainThread]: Command end result
[0m13:36:11.983650 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:36:11.988171 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:36:11.997824 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m13:36:11.998735 [info ] [MainThread]: 
[0m13:36:11.999667 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m13:36:12.000436 [info ] [MainThread]: 
[0m13:36:12.001069 [error] [MainThread]: [31mFailure in test not_null_customer_customerID (seeds\seeds.yml)[0m
[0m13:36:12.001670 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:36:12.002232 [info ] [MainThread]: 
[0m13:36:12.002881 [info ] [MainThread]:   compiled code at target\compiled\raysearch_project\seeds\seeds.yml\not_null_customer_customerID.sql
[0m13:36:12.003369 [info ] [MainThread]: 
[0m13:36:12.003895 [error] [MainThread]: [31mFailure in test relationships_transaction_customerId__customerID__ref_customer_ (seeds\seeds.yml)[0m
[0m13:36:12.004534 [error] [MainThread]:   Got 754 results, configured to fail if != 0
[0m13:36:12.005088 [info ] [MainThread]: 
[0m13:36:12.006015 [info ] [MainThread]:   compiled code at target\compiled\raysearch_project\seeds\seeds.yml\relationships_transaction_customerId__customerID__ref_customer_.sql
[0m13:36:12.006563 [info ] [MainThread]: 
[0m13:36:12.007196 [error] [MainThread]: [31mFailure in test unique_customer_customerID (seeds\seeds.yml)[0m
[0m13:36:12.007834 [error] [MainThread]:   Got 13 results, configured to fail if != 0
[0m13:36:12.008322 [info ] [MainThread]: 
[0m13:36:12.008995 [info ] [MainThread]:   compiled code at target\compiled\raysearch_project\seeds\seeds.yml\unique_customer_customerID.sql
[0m13:36:12.009838 [info ] [MainThread]: 
[0m13:36:12.010637 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=16
[0m13:36:12.012461 [debug] [MainThread]: Command `dbt test` failed at 13:36:12.012222 after 1.76 seconds
[0m13:36:12.012934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248D8D6B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248DA6AB330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248DA6AB120>]}
[0m13:36:12.013262 [debug] [MainThread]: Flushing usage events
[0m13:36:12.940006 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:37:12.624058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D74F54830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D7608FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D7608F9D0>]}


============================== 13:37:12.630384 | 3fd2b3d2-cb01-4a37-bcaa-1194e72c7b8d ==============================
[0m13:37:12.630384 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:37:12.631332 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt run --select customer', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m13:37:12.841168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fd2b3d2-cb01-4a37-bcaa-1194e72c7b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D753C6060>]}
[0m13:37:12.896617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fd2b3d2-cb01-4a37-bcaa-1194e72c7b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D770D29C0>]}
[0m13:37:12.900196 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:37:13.116121 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:37:13.239465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:37:13.239867 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:37:13.240064 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:37:13.246134 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.intermediate
- models.raysearch_project.marts
[0m13:37:13.285043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fd2b3d2-cb01-4a37-bcaa-1194e72c7b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D7755E450>]}
[0m13:37:13.347950 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:37:13.351452 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:37:13.386296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fd2b3d2-cb01-4a37-bcaa-1194e72c7b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D75F02C60>]}
[0m13:37:13.386754 [info ] [MainThread]: Found 4 models, 3 seeds, 16 data tests, 472 macros
[0m13:37:13.387261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fd2b3d2-cb01-4a37-bcaa-1194e72c7b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D776F6CF0>]}
[0m13:37:13.389106 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:37:13.390934 [debug] [MainThread]: Command end result
[0m13:37:13.494020 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:37:13.497039 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:37:13.499888 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m13:37:13.500579 [debug] [MainThread]: Command `dbt run` succeeded at 13:37:13.500480 after 1.02 seconds
[0m13:37:13.500873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D77693EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D75E2B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D776EE090>]}
[0m13:37:13.501123 [debug] [MainThread]: Flushing usage events
[0m13:37:14.370571 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:49.551420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDC8E4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDDA1FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDDA1F9D0>]}


============================== 13:41:49.555880 | 980ebe13-55ab-441c-a6f4-a97c83d08ae9 ==============================
[0m13:41:49.555880 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:41:49.556557 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --select stg_customer', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m13:41:49.744232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '980ebe13-55ab-441c-a6f4-a97c83d08ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDCD56060>]}
[0m13:41:49.800668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '980ebe13-55ab-441c-a6f4-a97c83d08ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDEA629C0>]}
[0m13:41:49.803617 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:41:49.987152 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:41:50.116046 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m13:41:50.116491 [debug] [MainThread]: Partial parsing: deleted file: raysearch_project://models\staging\stg_example.sql
[0m13:41:50.116779 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models\staging\stg_customer.sql
[0m13:41:50.314200 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.marts
- models.raysearch_project.intermediate
[0m13:41:50.318112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '980ebe13-55ab-441c-a6f4-a97c83d08ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDEF1EB50>]}
[0m13:41:50.452072 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:41:50.454970 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:41:50.481314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '980ebe13-55ab-441c-a6f4-a97c83d08ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDD892C60>]}
[0m13:41:50.481796 [info ] [MainThread]: Found 3 models, 3 seeds, 16 data tests, 472 macros
[0m13:41:50.482351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '980ebe13-55ab-441c-a6f4-a97c83d08ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDECF8050>]}
[0m13:41:50.483678 [info ] [MainThread]: 
[0m13:41:50.484107 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:41:50.484432 [info ] [MainThread]: 
[0m13:41:50.484917 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:41:50.485728 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m13:41:50.612691 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:41:50.613205 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:41:50.613698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:50.631093 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m13:41:50.632393 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:41:50.633096 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_stg)
[0m13:41:50.633487 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_stg"
"
[0m13:41:50.638081 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:41:50.638389 [debug] [ThreadPool]: On create_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_stg"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m13:41:50.638586 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:41:50.639485 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:41:50.640513 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:41:50.640768 [debug] [ThreadPool]: On create_warehouse_main_stg: BEGIN
[0m13:41:50.641162 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:41:50.641380 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:41:50.641553 [debug] [ThreadPool]: On create_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_stg"} */

    
    
        create schema if not exists "warehouse"."main_stg"
    
[0m13:41:50.642077 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:41:50.642715 [debug] [ThreadPool]: On create_warehouse_main_stg: COMMIT
[0m13:41:50.642933 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:41:50.643105 [debug] [ThreadPool]: On create_warehouse_main_stg: COMMIT
[0m13:41:50.645802 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:41:50.646151 [debug] [ThreadPool]: On create_warehouse_main_stg: Close
[0m13:41:50.650755 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m13:41:50.655315 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:41:50.655734 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m13:41:50.655986 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m13:41:50.657272 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m13:41:50.657572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:50.657868 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m13:41:50.658304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:50.658635 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:41:50.658832 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:41:50.659011 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:41:50.659235 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m13:41:50.659443 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m13:41:50.659803 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m13:41:50.671492 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:41:50.672013 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m13:41:50.672982 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m13:41:50.674089 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m13:41:50.676341 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m13:41:50.676670 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m13:41:50.677266 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m13:41:50.677492 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m13:41:50.678680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '980ebe13-55ab-441c-a6f4-a97c83d08ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDF38E270>]}
[0m13:41:50.679267 [debug] [MainThread]: Using duckdb connection "master"
[0m13:41:50.679597 [debug] [MainThread]: On master: BEGIN
[0m13:41:50.679881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:41:50.680576 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:41:50.680796 [debug] [MainThread]: On master: COMMIT
[0m13:41:50.680966 [debug] [MainThread]: Using duckdb connection "master"
[0m13:41:50.681114 [debug] [MainThread]: On master: COMMIT
[0m13:41:50.681499 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:41:50.681699 [debug] [MainThread]: On master: Close
[0m13:41:50.685473 [debug] [Thread-1 (]: Began running node model.raysearch_project.stg_customer
[0m13:41:50.685898 [info ] [Thread-1 (]: 1 of 1 START sql view model main_stg.stg_customer .............................. [RUN]
[0m13:41:50.686572 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.raysearch_project.stg_customer'
[0m13:41:50.686896 [debug] [Thread-1 (]: Began compiling node model.raysearch_project.stg_customer
[0m13:41:50.691750 [debug] [Thread-1 (]: Writing injected SQL for node "model.raysearch_project.stg_customer"
[0m13:41:50.693499 [debug] [Thread-1 (]: Began executing node model.raysearch_project.stg_customer
[0m13:41:50.720889 [debug] [Thread-1 (]: Writing runtime sql for node "model.raysearch_project.stg_customer"
[0m13:41:50.722630 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:41:50.722937 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: BEGIN
[0m13:41:50.723127 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:41:50.723875 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:50.724212 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:41:50.724447 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */

  
  create view "warehouse"."main_stg"."stg_customer__dbt_tmp" as (
    with raw as (
    select * from "warehouse"."main_raw"."customer"
),
std as (
    select
        customerID as customer_id,
        country as country_code,
        state as customer_state,
        VIP as is_vip,
        KYC as is_kyc,
        wantsNewsletter as wants_newsletter,
        try_strptime(latestUpdate, '%m/%d/%Y')::date as latest_update_date
    from raw
)
select * from std
  );

[0m13:41:50.725364 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:50.730330 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:41:50.730684 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */
alter view "warehouse"."main_stg"."stg_customer__dbt_tmp" rename to "stg_customer"
[0m13:41:50.731568 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:41:50.738495 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: COMMIT
[0m13:41:50.738830 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:41:50.739059 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: COMMIT
[0m13:41:50.740781 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:50.745545 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:41:50.745902 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */

      drop view if exists "warehouse"."main_stg"."stg_customer__dbt_backup" cascade
    
[0m13:41:50.746620 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:41:50.748509 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: Close
[0m13:41:50.750620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '980ebe13-55ab-441c-a6f4-a97c83d08ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDF490950>]}
[0m13:41:50.751111 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main_stg.stg_customer ......................... [[32mOK[0m in 0.06s]
[0m13:41:50.751894 [debug] [Thread-1 (]: Finished running node model.raysearch_project.stg_customer
[0m13:41:50.753803 [debug] [MainThread]: Using duckdb connection "master"
[0m13:41:50.754006 [debug] [MainThread]: On master: BEGIN
[0m13:41:50.754160 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:41:50.754627 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:41:50.754817 [debug] [MainThread]: On master: COMMIT
[0m13:41:50.754975 [debug] [MainThread]: Using duckdb connection "master"
[0m13:41:50.755115 [debug] [MainThread]: On master: COMMIT
[0m13:41:50.755750 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:41:50.756311 [debug] [MainThread]: On master: Close
[0m13:41:50.756877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:50.757253 [debug] [MainThread]: Connection 'create_warehouse_main_stg' was properly closed.
[0m13:41:50.757666 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m13:41:50.757977 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m13:41:50.758253 [debug] [MainThread]: Connection 'model.raysearch_project.stg_customer' was properly closed.
[0m13:41:50.758585 [info ] [MainThread]: 
[0m13:41:50.759150 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m13:41:50.760603 [debug] [MainThread]: Command end result
[0m13:41:50.782855 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:41:50.785881 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:41:50.791062 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m13:41:50.791353 [info ] [MainThread]: 
[0m13:41:50.791911 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:41:50.792303 [info ] [MainThread]: 
[0m13:41:50.792612 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:41:50.793280 [debug] [MainThread]: Command `dbt run` succeeded at 13:41:50.793190 after 1.38 seconds
[0m13:41:50.793548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDF1EE990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCD9A49A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCDCCF34D0>]}
[0m13:41:50.793787 [debug] [MainThread]: Flushing usage events
[0m13:41:51.706586 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:43:09.880423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2AC534830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2AD66FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2AD66F9D0>]}


============================== 13:43:09.884928 | fe8deda4-c7e5-416a-b092-94761b6f2e36 ==============================
[0m13:43:09.884928 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:43:09.885566 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m13:43:10.069664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe8deda4-c7e5-416a-b092-94761b6f2e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2AC9A6060>]}
[0m13:43:10.120232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe8deda4-c7e5-416a-b092-94761b6f2e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2AE6B29C0>]}
[0m13:43:10.123874 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:43:10.294917 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:43:10.468169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:43:10.469018 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://seeds\transaction.csv
[0m13:43:10.469278 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://seeds\seeds.yml
[0m13:43:10.744350 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'transaction' in
package 'raysearch_project' (seeds\seeds.yml). Arguments to generic tests should
be nested under the `arguments` property.
[0m13:43:10.745281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fe8deda4-c7e5-416a-b092-94761b6f2e36', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2AEBDDB50>]}
[0m13:43:10.837176 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.intermediate
- models.raysearch_project.marts
[0m13:43:10.842031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe8deda4-c7e5-416a-b092-94761b6f2e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2AEC075C0>]}
[0m13:43:10.902273 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:43:10.905309 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:43:10.934970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe8deda4-c7e5-416a-b092-94761b6f2e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2AE77BBD0>]}
[0m13:43:10.935386 [info ] [MainThread]: Found 3 models, 3 seeds, 15 data tests, 472 macros
[0m13:43:10.936003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe8deda4-c7e5-416a-b092-94761b6f2e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2AEF17040>]}
[0m13:43:10.937521 [info ] [MainThread]: 
[0m13:43:10.938115 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:43:10.938679 [info ] [MainThread]: 
[0m13:43:10.939431 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:43:10.945284 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m13:43:11.035323 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:43:11.035667 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:43:11.035849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:11.071347 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m13:43:11.072519 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:43:11.073217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_stg)
[0m13:43:11.073577 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_stg"
"
[0m13:43:11.078361 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:43:11.078739 [debug] [ThreadPool]: On create_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_stg"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m13:43:11.079075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:11.080133 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:43:11.081091 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:43:11.081358 [debug] [ThreadPool]: On create_warehouse_main_stg: BEGIN
[0m13:43:11.081739 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:43:11.081934 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:43:11.082097 [debug] [ThreadPool]: On create_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_stg"} */

    
    
        create schema if not exists "warehouse"."main_stg"
    
[0m13:43:11.082489 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:43:11.083022 [debug] [ThreadPool]: On create_warehouse_main_stg: COMMIT
[0m13:43:11.083220 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:43:11.083388 [debug] [ThreadPool]: On create_warehouse_main_stg: COMMIT
[0m13:43:11.083705 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:43:11.083905 [debug] [ThreadPool]: On create_warehouse_main_stg: Close
[0m13:43:11.085251 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m13:43:11.089360 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:43:11.089705 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m13:43:11.089907 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m13:43:11.091540 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m13:43:11.091879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:11.092145 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m13:43:11.092536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:11.092836 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:43:11.093035 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:43:11.093208 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:43:11.093405 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m13:43:11.093600 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m13:43:11.093917 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m13:43:11.104769 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:43:11.105138 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:43:11.106212 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m13:43:11.107118 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m13:43:11.109838 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m13:43:11.110196 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m13:43:11.110810 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m13:43:11.111763 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m13:43:11.112607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe8deda4-c7e5-416a-b092-94761b6f2e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2AEF2D490>]}
[0m13:43:11.113177 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:11.113489 [debug] [MainThread]: On master: BEGIN
[0m13:43:11.113770 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:11.114531 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:43:11.114749 [debug] [MainThread]: On master: COMMIT
[0m13:43:11.114921 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:11.115070 [debug] [MainThread]: On master: COMMIT
[0m13:43:11.115417 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:43:11.115597 [debug] [MainThread]: On master: Close
[0m13:43:11.119064 [debug] [Thread-1 (]: Began running node model.raysearch_project.stg_currency_exchange
[0m13:43:11.119393 [debug] [Thread-2 (]: Began running node model.raysearch_project.stg_customer
[0m13:43:11.119785 [info ] [Thread-1 (]: 1 of 3 START sql view model main_stg.stg_currency_exchange ..................... [RUN]
[0m13:43:11.120570 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.raysearch_project.stg_currency_exchange'
[0m13:43:11.120117 [info ] [Thread-2 (]: 2 of 3 START sql view model main_stg.stg_customer .............................. [RUN]
[0m13:43:11.120878 [debug] [Thread-1 (]: Began compiling node model.raysearch_project.stg_currency_exchange
[0m13:43:11.121179 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.raysearch_project.stg_customer'
[0m13:43:11.127321 [debug] [Thread-1 (]: Writing injected SQL for node "model.raysearch_project.stg_currency_exchange"
[0m13:43:11.127789 [debug] [Thread-2 (]: Began compiling node model.raysearch_project.stg_customer
[0m13:43:11.130300 [debug] [Thread-2 (]: Writing injected SQL for node "model.raysearch_project.stg_customer"
[0m13:43:11.131663 [debug] [Thread-2 (]: Began executing node model.raysearch_project.stg_customer
[0m13:43:11.131995 [debug] [Thread-1 (]: Began executing node model.raysearch_project.stg_currency_exchange
[0m13:43:11.155015 [debug] [Thread-2 (]: Writing runtime sql for node "model.raysearch_project.stg_customer"
[0m13:43:11.157827 [debug] [Thread-1 (]: Writing runtime sql for node "model.raysearch_project.stg_currency_exchange"
[0m13:43:11.160192 [debug] [Thread-2 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:43:11.160910 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: BEGIN
[0m13:43:11.161263 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:43:11.162307 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:43:11.162723 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_currency_exchange"
[0m13:43:11.162973 [debug] [Thread-2 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:43:11.163213 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: BEGIN
[0m13:43:11.163450 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */

  
  create view "warehouse"."main_stg"."stg_customer__dbt_tmp" as (
    with raw as (
    select * from "warehouse"."main_raw"."customer"
),
std as (
    select
        customerID as customer_id,
        country as country_code,
        state as customer_state,
        VIP as is_vip,
        KYC as is_kyc,
        wantsNewsletter as wants_newsletter,
        try_strptime(latestUpdate, '%m/%d/%Y')::date as latest_update_date
    from raw
)
select * from std
  );

[0m13:43:11.163777 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:43:11.164677 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:43:11.164902 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_currency_exchange"
[0m13:43:11.165115 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:43:11.165357 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_currency_exchange"} */

  
  create view "warehouse"."main_stg"."stg_currency_exchange__dbt_tmp" as (
    with raw as (
    select * from "warehouse"."main_raw"."currency_exchange"
),
typed as (
    select
        try_strptime(date, '%Y-%m-%d')::date as rate_date,
        currency as currency_code,
        try_cast(baseRateEuro as double) as base_rate_eur
    from raw
),
validated as (
    select *
    from typed
    where rate_date is not null
      and currency_code is not null
      and base_rate_eur is not null
)
select * from validated
  );

[0m13:43:11.170145 [debug] [Thread-2 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:43:11.170708 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */
alter view "warehouse"."main_stg"."stg_customer" rename to "stg_customer__dbt_backup"
[0m13:43:11.174393 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_currency_exchange"} */

  
  create view "warehouse"."main_stg"."stg_currency_exchange__dbt_tmp" as (
    with raw as (
    select * from "warehouse"."main_raw"."currency_exchange"
),
typed as (
    select
        try_strptime(date, '%Y-%m-%d')::date as rate_date,
        currency as currency_code,
        try_cast(baseRateEuro as double) as base_rate_eur
    from raw
),
validated as (
    select *
    from typed
    where rate_date is not null
      and currency_code is not null
      and base_rate_eur is not null
)
select * from validated
  );

[0m13:43:11.174920 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:43:11.175208 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:43:11.175592 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: ROLLBACK
[0m13:43:11.178089 [debug] [Thread-2 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:43:11.178493 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */
alter view "warehouse"."main_stg"."stg_customer__dbt_tmp" rename to "stg_customer"
[0m13:43:11.179539 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:43:11.187800 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: COMMIT
[0m13:43:11.188159 [debug] [Thread-2 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:43:11.188384 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: COMMIT
[0m13:43:11.191326 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:43:11.195673 [debug] [Thread-2 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:43:11.196016 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */

      drop view if exists "warehouse"."main_stg"."stg_customer__dbt_backup" cascade
    
[0m13:43:11.197385 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:43:11.199031 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: Close
[0m13:43:11.200943 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe8deda4-c7e5-416a-b092-94761b6f2e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2AEF77490>]}
[0m13:43:11.201428 [info ] [Thread-2 (]: 2 of 3 OK created sql view model main_stg.stg_customer ......................... [[32mOK[0m in 0.08s]
[0m13:43:11.202044 [debug] [Thread-2 (]: Finished running node model.raysearch_project.stg_customer
[0m13:43:11.202463 [debug] [Thread-3 (]: Began running node model.raysearch_project.stg_transaction
[0m13:43:11.202749 [info ] [Thread-3 (]: 3 of 3 START sql view model main_stg.stg_transaction ........................... [RUN]
[0m13:43:11.203250 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.raysearch_project.stg_transaction'
[0m13:43:11.203474 [debug] [Thread-3 (]: Began compiling node model.raysearch_project.stg_transaction
[0m13:43:11.205332 [debug] [Thread-3 (]: Writing injected SQL for node "model.raysearch_project.stg_transaction"
[0m13:43:11.207286 [debug] [Thread-3 (]: Began executing node model.raysearch_project.stg_transaction
[0m13:43:11.209905 [debug] [Thread-3 (]: Writing runtime sql for node "model.raysearch_project.stg_transaction"
[0m13:43:11.211514 [debug] [Thread-3 (]: Using duckdb connection "model.raysearch_project.stg_transaction"
[0m13:43:11.211833 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: BEGIN
[0m13:43:11.212041 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:43:11.212651 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:43:11.212893 [debug] [Thread-3 (]: Using duckdb connection "model.raysearch_project.stg_transaction"
[0m13:43:11.213116 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_transaction"} */

  
  create view "warehouse"."main_stg"."stg_transaction__dbt_tmp" as (
    with raw as (
    select * from "warehouse"."main_raw"."transaction"
),
typed as (
    select
        try_strptime(date, '%m/%d/%Y')::date as transaction_date,
        try_cast(amount as double) as amount,
        channelUID as channel,
        txCurrency as currency,
        accountType as account_type,
        txType as transaction_type,
        customerId as customer_id
    from raw
),
validated as (
    select *
    from typed
    where transaction_date is not null
      and amount is not null
      and transaction_type in ('DEPOSIT','WITHDRAWAL')
      and currency is not null
),
with_valid_customers as (
    select t.*
    from validated t
    inner join "warehouse"."main_stg"."stg_customer" c
        on t.customer_id = c.customer_id
)
select * from with_valid_customers
  );

[0m13:43:11.214581 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:43:11.217220 [debug] [Thread-3 (]: Using duckdb connection "model.raysearch_project.stg_transaction"
[0m13:43:11.217520 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_transaction"} */
alter view "warehouse"."main_stg"."stg_transaction__dbt_tmp" rename to "stg_transaction"
[0m13:43:11.218143 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:43:11.219165 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: COMMIT
[0m13:43:11.219445 [debug] [Thread-3 (]: Using duckdb connection "model.raysearch_project.stg_transaction"
[0m13:43:11.219676 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: COMMIT
[0m13:43:11.221406 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:43:11.223409 [debug] [Thread-3 (]: Using duckdb connection "model.raysearch_project.stg_transaction"
[0m13:43:11.223918 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_transaction"} */

      drop view if exists "warehouse"."main_stg"."stg_transaction__dbt_backup" cascade
    
[0m13:43:11.224979 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:43:11.226585 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: Close
[0m13:43:11.227103 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe8deda4-c7e5-416a-b092-94761b6f2e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2B03DF390>]}
[0m13:43:11.227552 [info ] [Thread-3 (]: 3 of 3 OK created sql view model main_stg.stg_transaction ...................... [[32mOK[0m in 0.02s]
[0m13:43:11.228387 [debug] [Thread-3 (]: Finished running node model.raysearch_project.stg_transaction
[0m13:43:11.479793 [debug] [Thread-1 (]: Failed to rollback 'model.raysearch_project.stg_currency_exchange'
[0m13:43:11.480219 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: Close
[0m13:43:11.482906 [debug] [Thread-1 (]: Runtime Error in model stg_currency_exchange (models\staging\stg_currency_exchange.sql)
  Binder Error: No function matches the given name and argument types 'try_strptime(DATE, STRING_LITERAL)'. You might need to add explicit type casts.
  	Candidate functions:
  	try_strptime(VARCHAR, VARCHAR) -> TIMESTAMP
  	try_strptime(VARCHAR, VARCHAR[]) -> TIMESTAMP
  
  
  LINE 10:         try_strptime(date, '%Y-%m-%d')::date as rate_date,
                   ^
[0m13:43:11.483274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe8deda4-c7e5-416a-b092-94761b6f2e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2AF27DFD0>]}
[0m13:43:11.483698 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main_stg.stg_currency_exchange ............ [[31mERROR[0m in 0.36s]
[0m13:43:11.484412 [debug] [Thread-1 (]: Finished running node model.raysearch_project.stg_currency_exchange
[0m13:43:11.484775 [debug] [Thread-7 (]: Marking all children of 'model.raysearch_project.stg_currency_exchange' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_currency_exchange (models\staging\stg_currency_exchange.sql)
  Binder Error: No function matches the given name and argument types 'try_strptime(DATE, STRING_LITERAL)'. You might need to add explicit type casts.
  	Candidate functions:
  	try_strptime(VARCHAR, VARCHAR) -> TIMESTAMP
  	try_strptime(VARCHAR, VARCHAR[]) -> TIMESTAMP
  
  
  LINE 10:         try_strptime(date, '%Y-%m-%d')::date as rate_date,
                   ^.
[0m13:43:11.486650 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:11.487020 [debug] [MainThread]: On master: BEGIN
[0m13:43:11.487314 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:43:11.488096 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:43:11.488312 [debug] [MainThread]: On master: COMMIT
[0m13:43:11.488485 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:11.488656 [debug] [MainThread]: On master: COMMIT
[0m13:43:11.489015 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:43:11.489332 [debug] [MainThread]: On master: Close
[0m13:43:11.489799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:11.489971 [debug] [MainThread]: Connection 'create_warehouse_main_stg' was properly closed.
[0m13:43:11.490102 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m13:43:11.490226 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m13:43:11.490353 [debug] [MainThread]: Connection 'model.raysearch_project.stg_currency_exchange' was properly closed.
[0m13:43:11.490700 [debug] [MainThread]: Connection 'model.raysearch_project.stg_customer' was properly closed.
[0m13:43:11.491012 [debug] [MainThread]: Connection 'model.raysearch_project.stg_transaction' was properly closed.
[0m13:43:11.491471 [info ] [MainThread]: 
[0m13:43:11.492091 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m13:43:11.493268 [debug] [MainThread]: Command end result
[0m13:43:11.513880 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:43:11.516735 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:43:11.521299 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m13:43:11.521601 [info ] [MainThread]: 
[0m13:43:11.522068 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:43:11.522436 [info ] [MainThread]: 
[0m13:43:11.522802 [error] [MainThread]: [31mFailure in model stg_currency_exchange (models\staging\stg_currency_exchange.sql)[0m
[0m13:43:11.523184 [error] [MainThread]:   Runtime Error in model stg_currency_exchange (models\staging\stg_currency_exchange.sql)
  Binder Error: No function matches the given name and argument types 'try_strptime(DATE, STRING_LITERAL)'. You might need to add explicit type casts.
  	Candidate functions:
  	try_strptime(VARCHAR, VARCHAR) -> TIMESTAMP
  	try_strptime(VARCHAR, VARCHAR[]) -> TIMESTAMP
  
  
  LINE 10:         try_strptime(date, '%Y-%m-%d')::date as rate_date,
                   ^
[0m13:43:11.523885 [info ] [MainThread]: 
[0m13:43:11.524688 [info ] [MainThread]:   compiled code at target\compiled\raysearch_project\models\staging\stg_currency_exchange.sql
[0m13:43:11.525337 [info ] [MainThread]: 
[0m13:43:11.525729 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m13:43:11.526533 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:43:11.527686 [debug] [MainThread]: Command `dbt run` failed at 13:43:11.527561 after 1.79 seconds
[0m13:43:11.528020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2A68EA6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2B03EA660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2AC947EF0>]}
[0m13:43:11.528356 [debug] [MainThread]: Flushing usage events
[0m13:43:14.328061 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:46:40.201488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A44EEE4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A45001FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A45001F9D0>]}


============================== 13:46:40.206042 | 11cb051f-c402-4825-9bbb-0201d1ac5d37 ==============================
[0m13:46:40.206042 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:46:40.206763 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --select stg_currency_exchange', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m13:46:40.650713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11cb051f-c402-4825-9bbb-0201d1ac5d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A44F356060>]}
[0m13:46:40.706374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11cb051f-c402-4825-9bbb-0201d1ac5d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4510629C0>]}
[0m13:46:40.734986 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:46:41.180231 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:46:44.011154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:46:44.011722 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models\staging\stg_currency_exchange.sql
[0m13:46:44.272421 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.intermediate
- models.raysearch_project.marts
[0m13:46:44.276402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11cb051f-c402-4825-9bbb-0201d1ac5d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A45153EB50>]}
[0m13:46:44.342889 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:46:44.372452 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:46:44.398232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11cb051f-c402-4825-9bbb-0201d1ac5d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A45106E4E0>]}
[0m13:46:44.398790 [info ] [MainThread]: Found 3 models, 3 seeds, 15 data tests, 472 macros
[0m13:46:44.399730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11cb051f-c402-4825-9bbb-0201d1ac5d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A451232350>]}
[0m13:46:44.401180 [info ] [MainThread]: 
[0m13:46:44.401634 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:46:44.401986 [info ] [MainThread]: 
[0m13:46:44.402501 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:46:44.403365 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m13:46:51.147704 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:46:51.148115 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:46:51.148318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:51.184136 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m13:46:51.185318 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:46:51.186064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_stg)
[0m13:46:51.186394 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_stg"
"
[0m13:46:51.190492 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:46:51.190809 [debug] [ThreadPool]: On create_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_stg"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m13:46:51.191010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:51.191902 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:46:51.192755 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:46:51.192953 [debug] [ThreadPool]: On create_warehouse_main_stg: BEGIN
[0m13:46:51.193299 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:46:51.193487 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:46:51.193648 [debug] [ThreadPool]: On create_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_stg"} */

    
    
        create schema if not exists "warehouse"."main_stg"
    
[0m13:46:51.194017 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:46:51.194534 [debug] [ThreadPool]: On create_warehouse_main_stg: COMMIT
[0m13:46:51.194728 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:46:51.194889 [debug] [ThreadPool]: On create_warehouse_main_stg: COMMIT
[0m13:46:51.195187 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:46:51.195376 [debug] [ThreadPool]: On create_warehouse_main_stg: Close
[0m13:46:51.199857 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m13:46:51.203698 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m13:46:51.203960 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m13:46:51.204128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:51.204755 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:46:51.205051 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m13:46:51.205342 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m13:46:51.206301 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:46:51.206548 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m13:46:51.206736 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m13:46:51.207049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:51.207445 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:46:51.207617 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:46:51.207765 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m13:46:51.218992 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:46:51.219503 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m13:46:51.220571 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m13:46:51.221521 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m13:46:51.247547 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m13:46:51.247925 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m13:46:51.248899 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m13:46:51.249144 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m13:46:51.249932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11cb051f-c402-4825-9bbb-0201d1ac5d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A451896EA0>]}
[0m13:46:51.250268 [debug] [MainThread]: Using duckdb connection "master"
[0m13:46:51.250433 [debug] [MainThread]: On master: BEGIN
[0m13:46:51.250578 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:51.251073 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:46:51.251324 [debug] [MainThread]: On master: COMMIT
[0m13:46:51.251490 [debug] [MainThread]: Using duckdb connection "master"
[0m13:46:51.251726 [debug] [MainThread]: On master: COMMIT
[0m13:46:51.252037 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:46:51.252202 [debug] [MainThread]: On master: Close
[0m13:46:51.255507 [debug] [Thread-1 (]: Began running node model.raysearch_project.stg_currency_exchange
[0m13:46:51.255903 [info ] [Thread-1 (]: 1 of 1 START sql view model main_stg.stg_currency_exchange ..................... [RUN]
[0m13:46:51.256516 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.raysearch_project.stg_currency_exchange'
[0m13:46:51.256750 [debug] [Thread-1 (]: Began compiling node model.raysearch_project.stg_currency_exchange
[0m13:46:51.261503 [debug] [Thread-1 (]: Writing injected SQL for node "model.raysearch_project.stg_currency_exchange"
[0m13:46:51.262839 [debug] [Thread-1 (]: Began executing node model.raysearch_project.stg_currency_exchange
[0m13:46:51.289067 [debug] [Thread-1 (]: Writing runtime sql for node "model.raysearch_project.stg_currency_exchange"
[0m13:46:51.290606 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_currency_exchange"
[0m13:46:51.290942 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: BEGIN
[0m13:46:51.291178 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:46:51.292008 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:46:51.292268 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_currency_exchange"
[0m13:46:51.292505 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_currency_exchange"} */

  
  create view "warehouse"."main_stg"."stg_currency_exchange__dbt_tmp" as (
    with raw as (
    select * from "warehouse"."main_raw"."currency_exchange"
),
typed as (
    select
        try_strptime(cast(date as varchar), '%Y-%m-%d')::date as rate_date,
        currency as currency_code,
        try_cast(baseRateEuro as double) as base_rate_eur
    from raw
),
validated as (
    select *
    from typed
    where rate_date is not null
      and currency_code is not null
      and base_rate_eur is not null
)
select * from validated
  );

[0m13:46:51.293485 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:46:51.298759 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_currency_exchange"
[0m13:46:51.299404 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_currency_exchange"} */
alter view "warehouse"."main_stg"."stg_currency_exchange__dbt_tmp" rename to "stg_currency_exchange"
[0m13:46:51.300214 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:46:51.306274 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: COMMIT
[0m13:46:51.306563 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_currency_exchange"
[0m13:46:51.306785 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: COMMIT
[0m13:46:51.309208 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:46:51.316351 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_currency_exchange"
[0m13:46:51.316731 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_currency_exchange"} */

      drop view if exists "warehouse"."main_stg"."stg_currency_exchange__dbt_backup" cascade
    
[0m13:46:51.317344 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:46:51.318894 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: Close
[0m13:46:51.320942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11cb051f-c402-4825-9bbb-0201d1ac5d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A451B70350>]}
[0m13:46:51.321404 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main_stg.stg_currency_exchange ................ [[32mOK[0m in 0.06s]
[0m13:46:51.322126 [debug] [Thread-1 (]: Finished running node model.raysearch_project.stg_currency_exchange
[0m13:46:51.323566 [debug] [MainThread]: Using duckdb connection "master"
[0m13:46:51.323911 [debug] [MainThread]: On master: BEGIN
[0m13:46:51.324175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:46:51.324910 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:46:51.325126 [debug] [MainThread]: On master: COMMIT
[0m13:46:51.325292 [debug] [MainThread]: Using duckdb connection "master"
[0m13:46:51.325438 [debug] [MainThread]: On master: COMMIT
[0m13:46:51.325746 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:46:51.325921 [debug] [MainThread]: On master: Close
[0m13:46:51.326206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:51.326389 [debug] [MainThread]: Connection 'create_warehouse_main_stg' was properly closed.
[0m13:46:51.326521 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m13:46:51.326649 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m13:46:51.326771 [debug] [MainThread]: Connection 'model.raysearch_project.stg_currency_exchange' was properly closed.
[0m13:46:51.327006 [info ] [MainThread]: 
[0m13:46:51.327506 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.92 seconds (6.92s).
[0m13:46:51.328233 [debug] [MainThread]: Command end result
[0m13:46:51.344083 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:46:51.348294 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:46:51.353917 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m13:46:51.354250 [info ] [MainThread]: 
[0m13:46:51.354790 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:46:51.355175 [info ] [MainThread]: 
[0m13:46:51.355537 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:46:51.356288 [debug] [MainThread]: Command `dbt run` succeeded at 13:46:51.356194 after 11.38 seconds
[0m13:46:51.356564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A451886830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A451C0FA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A451C0EB70>]}
[0m13:46:51.356852 [debug] [MainThread]: Flushing usage events
[0m13:46:52.267599 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:01.295229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA84174830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA852AFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA852AF9D0>]}


============================== 13:47:01.302064 | 8874ae1c-9f6f-4956-9991-24acaafe5790 ==============================
[0m13:47:01.302064 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:47:01.302785 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m13:47:01.490802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8874ae1c-9f6f-4956-9991-24acaafe5790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA845E6060>]}
[0m13:47:01.539776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8874ae1c-9f6f-4956-9991-24acaafe5790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA862F29C0>]}
[0m13:47:01.542657 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:47:01.708226 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:47:01.852180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:47:01.852575 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:47:01.852769 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:47:01.857214 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.marts
- models.raysearch_project.intermediate
[0m13:47:01.891186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8874ae1c-9f6f-4956-9991-24acaafe5790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA8677A450>]}
[0m13:47:01.947312 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:47:01.950799 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:47:01.978599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8874ae1c-9f6f-4956-9991-24acaafe5790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA85122C60>]}
[0m13:47:01.979260 [info ] [MainThread]: Found 3 models, 3 seeds, 15 data tests, 472 macros
[0m13:47:01.979910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8874ae1c-9f6f-4956-9991-24acaafe5790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA8696ADD0>]}
[0m13:47:01.981856 [info ] [MainThread]: 
[0m13:47:01.982407 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:47:01.982821 [info ] [MainThread]: 
[0m13:47:01.983395 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:47:01.987366 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m13:47:02.167014 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:47:02.167395 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:47:02.167601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:02.205501 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m13:47:02.206788 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:47:02.207548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_stg)
[0m13:47:02.207953 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_stg"
"
[0m13:47:02.213046 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:47:02.213381 [debug] [ThreadPool]: On create_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_stg"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m13:47:02.213580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:02.214436 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:47:02.216187 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:47:02.216828 [debug] [ThreadPool]: On create_warehouse_main_stg: BEGIN
[0m13:47:02.217427 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:47:02.217633 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:47:02.217801 [debug] [ThreadPool]: On create_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_stg"} */

    
    
        create schema if not exists "warehouse"."main_stg"
    
[0m13:47:02.218282 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:47:02.218867 [debug] [ThreadPool]: On create_warehouse_main_stg: COMMIT
[0m13:47:02.219064 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:47:02.219223 [debug] [ThreadPool]: On create_warehouse_main_stg: COMMIT
[0m13:47:02.219582 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:47:02.219785 [debug] [ThreadPool]: On create_warehouse_main_stg: Close
[0m13:47:02.221321 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m13:47:02.225451 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m13:47:02.225823 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m13:47:02.226067 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m13:47:02.227136 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:47:02.227432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:02.227640 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m13:47:02.227996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:02.228310 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:47:02.228514 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m13:47:02.228694 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:47:02.229073 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m13:47:02.229622 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:47:02.230062 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m13:47:02.240022 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m13:47:02.241163 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m13:47:02.241623 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:47:02.242428 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m13:47:02.244762 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m13:47:02.245129 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m13:47:02.246758 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m13:47:02.247010 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m13:47:02.248062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8874ae1c-9f6f-4956-9991-24acaafe5790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA86B97C70>]}
[0m13:47:02.248631 [debug] [MainThread]: Using duckdb connection "master"
[0m13:47:02.248920 [debug] [MainThread]: On master: BEGIN
[0m13:47:02.249172 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:02.249905 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:47:02.250116 [debug] [MainThread]: On master: COMMIT
[0m13:47:02.250281 [debug] [MainThread]: Using duckdb connection "master"
[0m13:47:02.250425 [debug] [MainThread]: On master: COMMIT
[0m13:47:02.250763 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:47:02.250959 [debug] [MainThread]: On master: Close
[0m13:47:02.254390 [debug] [Thread-1 (]: Began running node model.raysearch_project.stg_currency_exchange
[0m13:47:02.254723 [debug] [Thread-2 (]: Began running node model.raysearch_project.stg_customer
[0m13:47:02.255090 [info ] [Thread-1 (]: 1 of 3 START sql view model main_stg.stg_currency_exchange ..................... [RUN]
[0m13:47:02.255863 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.raysearch_project.stg_currency_exchange'
[0m13:47:02.255427 [info ] [Thread-2 (]: 2 of 3 START sql view model main_stg.stg_customer .............................. [RUN]
[0m13:47:02.256167 [debug] [Thread-1 (]: Began compiling node model.raysearch_project.stg_currency_exchange
[0m13:47:02.256472 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.raysearch_project.stg_customer'
[0m13:47:02.261294 [debug] [Thread-1 (]: Writing injected SQL for node "model.raysearch_project.stg_currency_exchange"
[0m13:47:02.261604 [debug] [Thread-2 (]: Began compiling node model.raysearch_project.stg_customer
[0m13:47:02.263745 [debug] [Thread-2 (]: Writing injected SQL for node "model.raysearch_project.stg_customer"
[0m13:47:02.264983 [debug] [Thread-1 (]: Began executing node model.raysearch_project.stg_currency_exchange
[0m13:47:02.265331 [debug] [Thread-2 (]: Began executing node model.raysearch_project.stg_customer
[0m13:47:02.299363 [debug] [Thread-1 (]: Writing runtime sql for node "model.raysearch_project.stg_currency_exchange"
[0m13:47:02.302486 [debug] [Thread-2 (]: Writing runtime sql for node "model.raysearch_project.stg_customer"
[0m13:47:02.303887 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_currency_exchange"
[0m13:47:02.304407 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: BEGIN
[0m13:47:02.304697 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:47:02.305625 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:47:02.306004 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_currency_exchange"
[0m13:47:02.306293 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_currency_exchange"} */

  
  create view "warehouse"."main_stg"."stg_currency_exchange__dbt_tmp" as (
    with raw as (
    select * from "warehouse"."main_raw"."currency_exchange"
),
typed as (
    select
        try_strptime(cast(date as varchar), '%Y-%m-%d')::date as rate_date,
        currency as currency_code,
        try_cast(baseRateEuro as double) as base_rate_eur
    from raw
),
validated as (
    select *
    from typed
    where rate_date is not null
      and currency_code is not null
      and base_rate_eur is not null
)
select * from validated
  );

[0m13:47:02.307036 [debug] [Thread-2 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:47:02.307481 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: BEGIN
[0m13:47:02.307792 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:47:02.308261 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:47:02.316633 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m13:47:02.319203 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_currency_exchange"
[0m13:47:02.319622 [debug] [Thread-2 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:47:02.319994 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_currency_exchange"} */
alter view "warehouse"."main_stg"."stg_currency_exchange" rename to "stg_currency_exchange__dbt_backup"
[0m13:47:02.320304 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */

  
  create view "warehouse"."main_stg"."stg_customer__dbt_tmp" as (
    with raw as (
    select * from "warehouse"."main_raw"."customer"
),
std as (
    select
        customerID as customer_id,
        country as country_code,
        state as customer_state,
        VIP as is_vip,
        KYC as is_kyc,
        wantsNewsletter as wants_newsletter,
        try_strptime(latestUpdate, '%m/%d/%Y')::date as latest_update_date
    from raw
)
select * from std
  );

[0m13:47:02.321669 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:47:02.324428 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_currency_exchange"
[0m13:47:02.324802 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:47:02.325074 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_currency_exchange"} */
alter view "warehouse"."main_stg"."stg_currency_exchange__dbt_tmp" rename to "stg_currency_exchange"
[0m13:47:02.326939 [debug] [Thread-2 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:47:02.327726 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */
alter view "warehouse"."main_stg"."stg_customer" rename to "stg_customer__dbt_backup"
[0m13:47:02.328302 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:47:02.339035 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: COMMIT
[0m13:47:02.339520 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m13:47:02.339860 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_currency_exchange"
[0m13:47:02.341760 [debug] [Thread-2 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:47:02.342069 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: COMMIT
[0m13:47:02.342326 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */
alter view "warehouse"."main_stg"."stg_customer__dbt_tmp" rename to "stg_customer"
[0m13:47:02.343081 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:47:02.344183 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: COMMIT
[0m13:47:02.344464 [debug] [Thread-2 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:47:02.344683 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: COMMIT
[0m13:47:02.344915 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:47:02.349730 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_currency_exchange"
[0m13:47:02.350148 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_currency_exchange"} */

      drop view if exists "warehouse"."main_stg"."stg_currency_exchange__dbt_backup" cascade
    
[0m13:47:02.350609 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:47:02.353548 [debug] [Thread-2 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:47:02.353790 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */

      drop view if exists "warehouse"."main_stg"."stg_customer__dbt_backup" cascade
    
[0m13:47:02.355153 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:47:02.356862 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: Close
[0m13:47:02.357226 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:47:02.361152 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: Close
[0m13:47:02.363637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8874ae1c-9f6f-4956-9991-24acaafe5790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA86973590>]}
[0m13:47:02.364459 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8874ae1c-9f6f-4956-9991-24acaafe5790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA86A317B0>]}
[0m13:47:02.365531 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main_stg.stg_currency_exchange ................ [[32mOK[0m in 0.10s]
[0m13:47:02.367457 [debug] [Thread-1 (]: Finished running node model.raysearch_project.stg_currency_exchange
[0m13:47:02.366441 [info ] [Thread-2 (]: 2 of 3 OK created sql view model main_stg.stg_customer ......................... [[32mOK[0m in 0.11s]
[0m13:47:02.368372 [debug] [Thread-2 (]: Finished running node model.raysearch_project.stg_customer
[0m13:47:02.369214 [debug] [Thread-3 (]: Began running node model.raysearch_project.stg_transaction
[0m13:47:02.369711 [info ] [Thread-3 (]: 3 of 3 START sql view model main_stg.stg_transaction ........................... [RUN]
[0m13:47:02.370423 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.raysearch_project.stg_transaction'
[0m13:47:02.370713 [debug] [Thread-3 (]: Began compiling node model.raysearch_project.stg_transaction
[0m13:47:02.372951 [debug] [Thread-3 (]: Writing injected SQL for node "model.raysearch_project.stg_transaction"
[0m13:47:02.374299 [debug] [Thread-3 (]: Began executing node model.raysearch_project.stg_transaction
[0m13:47:02.376632 [debug] [Thread-3 (]: Writing runtime sql for node "model.raysearch_project.stg_transaction"
[0m13:47:02.377690 [debug] [Thread-3 (]: Using duckdb connection "model.raysearch_project.stg_transaction"
[0m13:47:02.377934 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: BEGIN
[0m13:47:02.378126 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:47:02.378771 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:47:02.379048 [debug] [Thread-3 (]: Using duckdb connection "model.raysearch_project.stg_transaction"
[0m13:47:02.379432 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_transaction"} */

  
  create view "warehouse"."main_stg"."stg_transaction__dbt_tmp" as (
    with raw as (
    select * from "warehouse"."main_raw"."transaction"
),
typed as (
    select
        try_strptime(date, '%m/%d/%Y')::date as transaction_date,
        try_cast(amount as double) as amount,
        channelUID as channel,
        txCurrency as currency,
        accountType as account_type,
        txType as transaction_type,
        customerId as customer_id
    from raw
),
validated as (
    select *
    from typed
    where transaction_date is not null
      and amount is not null
      and transaction_type in ('DEPOSIT','WITHDRAWAL')
      and currency is not null
),
with_valid_customers as (
    select t.*
    from validated t
    inner join "warehouse"."main_stg"."stg_customer" c
        on t.customer_id = c.customer_id
)
select * from with_valid_customers
  );

[0m13:47:02.382472 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:47:02.385577 [debug] [Thread-3 (]: Using duckdb connection "model.raysearch_project.stg_transaction"
[0m13:47:02.385909 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_transaction"} */
alter view "warehouse"."main_stg"."stg_transaction" rename to "stg_transaction__dbt_backup"
[0m13:47:02.386841 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:47:02.388664 [debug] [Thread-3 (]: Using duckdb connection "model.raysearch_project.stg_transaction"
[0m13:47:02.388928 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_transaction"} */
alter view "warehouse"."main_stg"."stg_transaction__dbt_tmp" rename to "stg_transaction"
[0m13:47:02.389527 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:47:02.390528 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: COMMIT
[0m13:47:02.390781 [debug] [Thread-3 (]: Using duckdb connection "model.raysearch_project.stg_transaction"
[0m13:47:02.390993 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: COMMIT
[0m13:47:02.392859 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:47:02.394502 [debug] [Thread-3 (]: Using duckdb connection "model.raysearch_project.stg_transaction"
[0m13:47:02.394732 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_transaction"} */

      drop view if exists "warehouse"."main_stg"."stg_transaction__dbt_backup" cascade
    
[0m13:47:02.396547 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:47:02.398567 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: Close
[0m13:47:02.399159 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8874ae1c-9f6f-4956-9991-24acaafe5790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA865165D0>]}
[0m13:47:02.399717 [info ] [Thread-3 (]: 3 of 3 OK created sql view model main_stg.stg_transaction ...................... [[32mOK[0m in 0.03s]
[0m13:47:02.400682 [debug] [Thread-3 (]: Finished running node model.raysearch_project.stg_transaction
[0m13:47:02.402145 [debug] [MainThread]: Using duckdb connection "master"
[0m13:47:02.402388 [debug] [MainThread]: On master: BEGIN
[0m13:47:02.402557 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:47:02.403109 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:47:02.403338 [debug] [MainThread]: On master: COMMIT
[0m13:47:02.403524 [debug] [MainThread]: Using duckdb connection "master"
[0m13:47:02.403716 [debug] [MainThread]: On master: COMMIT
[0m13:47:02.404085 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:47:02.404315 [debug] [MainThread]: On master: Close
[0m13:47:02.404611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:02.404806 [debug] [MainThread]: Connection 'create_warehouse_main_stg' was properly closed.
[0m13:47:02.404986 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m13:47:02.405162 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m13:47:02.405334 [debug] [MainThread]: Connection 'model.raysearch_project.stg_currency_exchange' was properly closed.
[0m13:47:02.405503 [debug] [MainThread]: Connection 'model.raysearch_project.stg_customer' was properly closed.
[0m13:47:02.405697 [debug] [MainThread]: Connection 'model.raysearch_project.stg_transaction' was properly closed.
[0m13:47:02.406000 [info ] [MainThread]: 
[0m13:47:02.406535 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m13:47:02.407888 [debug] [MainThread]: Command end result
[0m13:47:02.428380 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:47:02.433171 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:47:02.438772 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m13:47:02.439109 [info ] [MainThread]: 
[0m13:47:02.439699 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:02.440217 [info ] [MainThread]: 
[0m13:47:02.440578 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m13:47:02.441362 [debug] [MainThread]: Command `dbt run` succeeded at 13:47:02.441257 after 1.27 seconds
[0m13:47:02.441667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA868E11D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA868E3750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFE57A6D0>]}
[0m13:47:02.441940 [debug] [MainThread]: Flushing usage events
[0m13:47:03.192531 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:48:38.968884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC395B4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC3A6EFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC3A6EF9D0>]}


============================== 13:48:38.973306 | 261157e0-9a44-4d75-8cff-d1b4586a856d ==============================
[0m13:48:38.973306 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:48:38.973977 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m13:48:39.183199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '261157e0-9a44-4d75-8cff-d1b4586a856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC39A26060>]}
[0m13:48:39.242921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '261157e0-9a44-4d75-8cff-d1b4586a856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC3B7329C0>]}
[0m13:48:39.246213 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:48:39.425232 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:48:39.547665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:48:39.548414 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://seeds\transaction.csv
[0m13:48:39.548685 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://seeds\customer.csv
[0m13:48:39.849755 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'transaction' in
package 'raysearch_project' (seeds\seeds.yml). Arguments to generic tests should
be nested under the `arguments` property.
[0m13:48:39.850636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '261157e0-9a44-4d75-8cff-d1b4586a856d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC3BC4DB50>]}
[0m13:48:39.944791 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.marts
- models.raysearch_project.intermediate
[0m13:48:39.948995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '261157e0-9a44-4d75-8cff-d1b4586a856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC3BC775C0>]}
[0m13:48:40.016309 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:48:40.019778 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:48:40.051415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '261157e0-9a44-4d75-8cff-d1b4586a856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC3B7FBBD0>]}
[0m13:48:40.051893 [info ] [MainThread]: Found 3 models, 3 seeds, 15 data tests, 472 macros
[0m13:48:40.052445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '261157e0-9a44-4d75-8cff-d1b4586a856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC3BF8AF70>]}
[0m13:48:40.054241 [info ] [MainThread]: 
[0m13:48:40.054735 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:48:40.055057 [info ] [MainThread]: 
[0m13:48:40.055537 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:48:40.061918 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m13:48:40.170453 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:48:40.170885 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:48:40.171124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:40.188792 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m13:48:40.189917 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:48:40.190639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_stg)
[0m13:48:40.191383 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_stg"
"
[0m13:48:40.196832 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:48:40.197220 [debug] [ThreadPool]: On create_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_stg"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m13:48:40.197446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:40.198569 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:48:40.199712 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:48:40.199987 [debug] [ThreadPool]: On create_warehouse_main_stg: BEGIN
[0m13:48:40.200433 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:48:40.200666 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:48:40.200878 [debug] [ThreadPool]: On create_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_stg"} */

    
    
        create schema if not exists "warehouse"."main_stg"
    
[0m13:48:40.201374 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:48:40.202032 [debug] [ThreadPool]: On create_warehouse_main_stg: COMMIT
[0m13:48:40.202266 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:48:40.202462 [debug] [ThreadPool]: On create_warehouse_main_stg: COMMIT
[0m13:48:40.202836 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:48:40.203063 [debug] [ThreadPool]: On create_warehouse_main_stg: Close
[0m13:48:40.204433 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m13:48:40.209836 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:48:40.210364 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m13:48:40.210636 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m13:48:40.212020 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m13:48:40.212338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:40.212554 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m13:48:40.212968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:40.213358 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:48:40.213776 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:48:40.214001 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:48:40.214201 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m13:48:40.214408 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m13:48:40.214728 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m13:48:40.226712 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m13:48:40.227154 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m13:48:40.228550 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m13:48:40.229569 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m13:48:40.231622 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m13:48:40.231928 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m13:48:40.232869 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m13:48:40.233091 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m13:48:40.234034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '261157e0-9a44-4d75-8cff-d1b4586a856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC3BF9D550>]}
[0m13:48:40.234603 [debug] [MainThread]: Using duckdb connection "master"
[0m13:48:40.234913 [debug] [MainThread]: On master: BEGIN
[0m13:48:40.235194 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:48:40.235905 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:48:40.236108 [debug] [MainThread]: On master: COMMIT
[0m13:48:40.236292 [debug] [MainThread]: Using duckdb connection "master"
[0m13:48:40.236466 [debug] [MainThread]: On master: COMMIT
[0m13:48:40.236779 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:48:40.236952 [debug] [MainThread]: On master: Close
[0m13:48:40.240313 [debug] [Thread-1 (]: Began running node model.raysearch_project.stg_currency_exchange
[0m13:48:40.240919 [debug] [Thread-2 (]: Began running node model.raysearch_project.stg_customer
[0m13:48:40.241603 [info ] [Thread-1 (]: 1 of 3 START sql view model main_stg.stg_currency_exchange ..................... [RUN]
[0m13:48:40.242552 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.raysearch_project.stg_currency_exchange'
[0m13:48:40.242854 [debug] [Thread-1 (]: Began compiling node model.raysearch_project.stg_currency_exchange
[0m13:48:40.241996 [info ] [Thread-2 (]: 2 of 3 START sql view model main_stg.stg_customer .............................. [RUN]
[0m13:48:40.249349 [debug] [Thread-1 (]: Writing injected SQL for node "model.raysearch_project.stg_currency_exchange"
[0m13:48:40.249973 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.raysearch_project.stg_customer'
[0m13:48:40.250358 [debug] [Thread-2 (]: Began compiling node model.raysearch_project.stg_customer
[0m13:48:40.251858 [debug] [Thread-2 (]: Writing injected SQL for node "model.raysearch_project.stg_customer"
[0m13:48:40.252411 [debug] [Thread-1 (]: Began executing node model.raysearch_project.stg_currency_exchange
[0m13:48:40.280678 [debug] [Thread-1 (]: Writing runtime sql for node "model.raysearch_project.stg_currency_exchange"
[0m13:48:40.281549 [debug] [Thread-2 (]: Began executing node model.raysearch_project.stg_customer
[0m13:48:40.283850 [debug] [Thread-2 (]: Writing runtime sql for node "model.raysearch_project.stg_customer"
[0m13:48:40.284431 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_currency_exchange"
[0m13:48:40.284689 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: BEGIN
[0m13:48:40.284884 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:48:40.285607 [debug] [Thread-2 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:48:40.285856 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: BEGIN
[0m13:48:40.286085 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:48:40.286297 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:48:40.286634 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_currency_exchange"
[0m13:48:40.287144 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_currency_exchange"} */

  
  create view "warehouse"."main_stg"."stg_currency_exchange__dbt_tmp" as (
    with raw as (
    select * from "warehouse"."main_raw"."currency_exchange"
),
typed as (
    select
        try_strptime(cast(date as varchar), '%Y-%m-%d')::date as rate_date,
        currency as currency_code,
        try_cast(baseRateEuro as double) as base_rate_eur
    from raw
),
validated as (
    select *
    from typed
    where rate_date is not null
      and currency_code is not null
      and base_rate_eur is not null
)
select * from validated
  );

[0m13:48:40.287702 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:48:40.287934 [debug] [Thread-2 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:48:40.288152 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */

  
  create view "warehouse"."main_stg"."stg_customer__dbt_tmp" as (
    with raw as (
    select * from "warehouse"."main_raw"."customer"
),
std as (
    select
        customerID as customer_id,
        country as country_code,
        state as customer_state,
        VIP as is_vip,
        KYC as is_kyc,
        wantsNewsletter as wants_newsletter,
        try_strptime(latestUpdate, '%m/%d/%Y')::date as latest_update_date
    from raw
)
select * from std
  );

[0m13:48:40.288639 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:48:40.295369 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_currency_exchange"
[0m13:48:40.295857 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m13:48:40.296147 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_currency_exchange"} */
alter view "warehouse"."main_stg"."stg_currency_exchange" rename to "stg_currency_exchange__dbt_backup"
[0m13:48:40.298058 [debug] [Thread-2 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:48:40.298468 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */
alter view "warehouse"."main_stg"."stg_customer" rename to "stg_customer__dbt_backup"
[0m13:48:40.299191 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:48:40.299452 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:48:40.301211 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_currency_exchange"
[0m13:48:40.303417 [debug] [Thread-2 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:48:40.303773 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_currency_exchange"} */
alter view "warehouse"."main_stg"."stg_currency_exchange__dbt_tmp" rename to "stg_currency_exchange"
[0m13:48:40.304027 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */
alter view "warehouse"."main_stg"."stg_customer__dbt_tmp" rename to "stg_customer"
[0m13:48:40.304750 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:48:40.314507 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: COMMIT
[0m13:48:40.314978 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m13:48:40.315280 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_currency_exchange"
[0m13:48:40.316345 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: COMMIT
[0m13:48:40.316608 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: COMMIT
[0m13:48:40.316915 [debug] [Thread-2 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:48:40.317279 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: COMMIT
[0m13:48:40.320531 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:48:40.325604 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_currency_exchange"
[0m13:48:40.326061 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_currency_exchange"} */

      drop view if exists "warehouse"."main_stg"."stg_currency_exchange__dbt_backup" cascade
    
[0m13:48:40.326370 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m13:48:40.328270 [debug] [Thread-2 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:48:40.328522 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */

      drop view if exists "warehouse"."main_stg"."stg_customer__dbt_backup" cascade
    
[0m13:48:40.329391 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:48:40.331227 [debug] [Thread-1 (]: On model.raysearch_project.stg_currency_exchange: Close
[0m13:48:40.331553 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:48:40.333230 [debug] [Thread-2 (]: On model.raysearch_project.stg_customer: Close
[0m13:48:40.334588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '261157e0-9a44-4d75-8cff-d1b4586a856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC3C0835F0>]}
[0m13:48:40.334886 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '261157e0-9a44-4d75-8cff-d1b4586a856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC399AF6B0>]}
[0m13:48:40.335346 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main_stg.stg_currency_exchange ................ [[32mOK[0m in 0.09s]
[0m13:48:40.336223 [debug] [Thread-1 (]: Finished running node model.raysearch_project.stg_currency_exchange
[0m13:48:40.335750 [info ] [Thread-2 (]: 2 of 3 OK created sql view model main_stg.stg_customer ......................... [[32mOK[0m in 0.08s]
[0m13:48:40.336756 [debug] [Thread-2 (]: Finished running node model.raysearch_project.stg_customer
[0m13:48:40.337250 [debug] [Thread-3 (]: Began running node model.raysearch_project.stg_transaction
[0m13:48:40.337559 [info ] [Thread-3 (]: 3 of 3 START sql view model main_stg.stg_transaction ........................... [RUN]
[0m13:48:40.337992 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.raysearch_project.stg_transaction'
[0m13:48:40.338201 [debug] [Thread-3 (]: Began compiling node model.raysearch_project.stg_transaction
[0m13:48:40.340113 [debug] [Thread-3 (]: Writing injected SQL for node "model.raysearch_project.stg_transaction"
[0m13:48:40.341494 [debug] [Thread-3 (]: Began executing node model.raysearch_project.stg_transaction
[0m13:48:40.344116 [debug] [Thread-3 (]: Writing runtime sql for node "model.raysearch_project.stg_transaction"
[0m13:48:40.345866 [debug] [Thread-3 (]: Using duckdb connection "model.raysearch_project.stg_transaction"
[0m13:48:40.346119 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: BEGIN
[0m13:48:40.346322 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:48:40.346961 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:48:40.347175 [debug] [Thread-3 (]: Using duckdb connection "model.raysearch_project.stg_transaction"
[0m13:48:40.347811 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_transaction"} */

  
  create view "warehouse"."main_stg"."stg_transaction__dbt_tmp" as (
    with raw as (
    select * from "warehouse"."main_raw"."transaction"
),
typed as (
    select
        try_strptime(date, '%m/%d/%Y')::date as transaction_date,
        try_cast(amount as double) as amount,
        channelUID as channel,
        txCurrency as currency,
        accountType as account_type,
        txType as transaction_type,
        customerId as customer_id
    from raw
),
validated as (
    select *
    from typed
    where transaction_date is not null
      and amount is not null
      and transaction_type in ('DEPOSIT','WITHDRAWAL')
      and currency is not null
),
with_valid_customers as (
    select t.*
    from validated t
    inner join "warehouse"."main_stg"."stg_customer" c
        on t.customer_id = c.customer_id
)
select * from with_valid_customers
  );

[0m13:48:40.350837 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:48:40.354477 [debug] [Thread-3 (]: Using duckdb connection "model.raysearch_project.stg_transaction"
[0m13:48:40.354904 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_transaction"} */
alter view "warehouse"."main_stg"."stg_transaction" rename to "stg_transaction__dbt_backup"
[0m13:48:40.355768 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:48:40.358062 [debug] [Thread-3 (]: Using duckdb connection "model.raysearch_project.stg_transaction"
[0m13:48:40.358516 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_transaction"} */
alter view "warehouse"."main_stg"."stg_transaction__dbt_tmp" rename to "stg_transaction"
[0m13:48:40.359702 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:48:40.361387 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: COMMIT
[0m13:48:40.361713 [debug] [Thread-3 (]: Using duckdb connection "model.raysearch_project.stg_transaction"
[0m13:48:40.361948 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: COMMIT
[0m13:48:40.363807 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:48:40.365762 [debug] [Thread-3 (]: Using duckdb connection "model.raysearch_project.stg_transaction"
[0m13:48:40.366040 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_transaction"} */

      drop view if exists "warehouse"."main_stg"."stg_transaction__dbt_backup" cascade
    
[0m13:48:40.367182 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:48:40.368357 [debug] [Thread-3 (]: On model.raysearch_project.stg_transaction: Close
[0m13:48:40.368825 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '261157e0-9a44-4d75-8cff-d1b4586a856d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC371A17D0>]}
[0m13:48:40.369306 [info ] [Thread-3 (]: 3 of 3 OK created sql view model main_stg.stg_transaction ...................... [[32mOK[0m in 0.03s]
[0m13:48:40.370059 [debug] [Thread-3 (]: Finished running node model.raysearch_project.stg_transaction
[0m13:48:40.371229 [debug] [MainThread]: Using duckdb connection "master"
[0m13:48:40.371429 [debug] [MainThread]: On master: BEGIN
[0m13:48:40.371585 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:48:40.372040 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:48:40.372219 [debug] [MainThread]: On master: COMMIT
[0m13:48:40.372379 [debug] [MainThread]: Using duckdb connection "master"
[0m13:48:40.372527 [debug] [MainThread]: On master: COMMIT
[0m13:48:40.372937 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:48:40.373176 [debug] [MainThread]: On master: Close
[0m13:48:40.373433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:48:40.373595 [debug] [MainThread]: Connection 'create_warehouse_main_stg' was properly closed.
[0m13:48:40.373743 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m13:48:40.374011 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m13:48:40.374258 [debug] [MainThread]: Connection 'model.raysearch_project.stg_currency_exchange' was properly closed.
[0m13:48:40.374692 [debug] [MainThread]: Connection 'model.raysearch_project.stg_customer' was properly closed.
[0m13:48:40.375031 [debug] [MainThread]: Connection 'model.raysearch_project.stg_transaction' was properly closed.
[0m13:48:40.375564 [info ] [MainThread]: 
[0m13:48:40.376230 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m13:48:40.377583 [debug] [MainThread]: Command end result
[0m13:48:40.400268 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:48:40.403458 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:48:40.409835 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m13:48:40.410196 [info ] [MainThread]: 
[0m13:48:40.410796 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:48:40.411413 [info ] [MainThread]: 
[0m13:48:40.411911 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m13:48:40.412496 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:48:40.413442 [debug] [MainThread]: Command `dbt run` succeeded at 13:48:40.413335 after 1.58 seconds
[0m13:48:40.413744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC3397A6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC3D429CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC3BC825D0>]}
[0m13:48:40.414074 [debug] [MainThread]: Flushing usage events
[0m13:48:41.270509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:51:14.722853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3739F4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A374B33ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A374B339D0>]}


============================== 13:51:14.728770 | bba5c6fd-2b9d-48b8-8f38-7f6fdc35090a ==============================
[0m13:51:14.728770 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:51:14.729456 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'invocation_command': 'dbt build --select stg_customer', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m13:51:14.919819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bba5c6fd-2b9d-48b8-8f38-7f6fdc35090a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A373E66060>]}
[0m13:51:14.974334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bba5c6fd-2b9d-48b8-8f38-7f6fdc35090a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A375B769C0>]}
[0m13:51:14.978093 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:51:15.159996 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:51:15.301484 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:51:15.301859 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:51:15.302032 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:51:15.306649 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.intermediate
- models.raysearch_project.marts
[0m13:51:15.339967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bba5c6fd-2b9d-48b8-8f38-7f6fdc35090a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A37602A450>]}
[0m13:51:15.401310 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:51:15.405335 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:51:15.533216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bba5c6fd-2b9d-48b8-8f38-7f6fdc35090a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3709435C0>]}
[0m13:51:15.534140 [info ] [MainThread]: Found 3 models, 3 seeds, 15 data tests, 472 macros
[0m13:51:15.537001 [info ] [MainThread]: 
[0m13:51:15.537647 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:51:15.538182 [info ] [MainThread]: 
[0m13:51:15.538717 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:51:15.539607 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m13:51:15.661266 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:51:15.661651 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:51:15.661851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:15.935861 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:51:15.936667 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m13:51:15.939241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:51:15.939828 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m13:51:15.940161 [info ] [MainThread]: 
[0m13:51:15.940709 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m13:51:15.941312 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "c:\users\amandaka\workspaces\raysearch_project\warehouse.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Users\AMANDAKA\AppData\Local\DBeaver\dbeaver.exe (PID 40932)
[0m13:51:15.942260 [debug] [MainThread]: Command `dbt build` failed at 13:51:15.942163 after 1.36 seconds
[0m13:51:15.942550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A374B0BE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A375D7DB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A376684BB0>]}
[0m13:51:15.942810 [debug] [MainThread]: Flushing usage events
[0m13:51:16.855365 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:51:28.307325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E593574830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5946B3ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5946B39D0>]}


============================== 13:51:28.311664 | 992fb974-8ba7-4977-bf38-fdcd74c46fe1 ==============================
[0m13:51:28.311664 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:51:28.312374 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt build --select stg_customer', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m13:51:28.504897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '992fb974-8ba7-4977-bf38-fdcd74c46fe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5939E6060>]}
[0m13:51:28.558137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '992fb974-8ba7-4977-bf38-fdcd74c46fe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5956FE9C0>]}
[0m13:51:28.561467 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:51:28.769024 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:51:28.892174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:51:28.892606 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:51:28.892832 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:51:28.898486 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.marts
- models.raysearch_project.intermediate
[0m13:51:28.937390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '992fb974-8ba7-4977-bf38-fdcd74c46fe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E595B9A450>]}
[0m13:51:29.001960 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:51:29.004733 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:51:29.122130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '992fb974-8ba7-4977-bf38-fdcd74c46fe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5904735C0>]}
[0m13:51:29.122641 [info ] [MainThread]: Found 3 models, 3 seeds, 15 data tests, 472 macros
[0m13:51:29.124457 [info ] [MainThread]: 
[0m13:51:29.124939 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:51:29.125247 [info ] [MainThread]: 
[0m13:51:29.125721 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:51:29.126597 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m13:51:29.227271 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:51:29.227634 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:51:29.227833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:29.244976 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m13:51:29.246544 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:51:29.247398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_stg)
[0m13:51:29.247900 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_stg"
"
[0m13:51:29.255058 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:51:29.255466 [debug] [ThreadPool]: On create_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_stg"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m13:51:29.255689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:29.256791 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:51:29.258070 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:51:29.258367 [debug] [ThreadPool]: On create_warehouse_main_stg: BEGIN
[0m13:51:29.258795 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:51:29.259055 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:51:29.259239 [debug] [ThreadPool]: On create_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_stg"} */

    
    
        create schema if not exists "warehouse"."main_stg"
    
[0m13:51:29.259658 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:51:29.260330 [debug] [ThreadPool]: On create_warehouse_main_stg: COMMIT
[0m13:51:29.260556 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:51:29.260740 [debug] [ThreadPool]: On create_warehouse_main_stg: COMMIT
[0m13:51:29.261139 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:51:29.261360 [debug] [ThreadPool]: On create_warehouse_main_stg: Close
[0m13:51:29.265202 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m13:51:29.271548 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:51:29.272100 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m13:51:29.272340 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m13:51:29.273855 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m13:51:29.274185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:29.274409 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m13:51:29.274847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:29.275234 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:51:29.275434 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:51:29.275617 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:51:29.275843 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m13:51:29.276055 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m13:51:29.276431 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m13:51:29.288236 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:51:29.288730 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m13:51:29.289798 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m13:51:29.290897 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m13:51:29.293269 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m13:51:29.293590 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m13:51:29.294473 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m13:51:29.294680 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m13:51:29.296483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '992fb974-8ba7-4977-bf38-fdcd74c46fe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E595964130>]}
[0m13:51:29.297369 [debug] [MainThread]: Using duckdb connection "master"
[0m13:51:29.297865 [debug] [MainThread]: On master: BEGIN
[0m13:51:29.298469 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:51:29.299792 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:51:29.300318 [debug] [MainThread]: On master: COMMIT
[0m13:51:29.301001 [debug] [MainThread]: Using duckdb connection "master"
[0m13:51:29.301580 [debug] [MainThread]: On master: COMMIT
[0m13:51:29.302303 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:51:29.302640 [debug] [MainThread]: On master: Close
[0m13:51:29.307320 [debug] [Thread-1 (]: Began running node model.raysearch_project.stg_customer
[0m13:51:29.307835 [info ] [Thread-1 (]: 1 of 1 START sql view model main_stg.stg_customer .............................. [RUN]
[0m13:51:29.308545 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.raysearch_project.stg_customer'
[0m13:51:29.308813 [debug] [Thread-1 (]: Began compiling node model.raysearch_project.stg_customer
[0m13:51:29.313727 [debug] [Thread-1 (]: Writing injected SQL for node "model.raysearch_project.stg_customer"
[0m13:51:29.315279 [debug] [Thread-1 (]: Began executing node model.raysearch_project.stg_customer
[0m13:51:29.339855 [debug] [Thread-1 (]: Writing runtime sql for node "model.raysearch_project.stg_customer"
[0m13:51:29.341227 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:51:29.341525 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: BEGIN
[0m13:51:29.341726 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:51:29.342540 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:29.342778 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:51:29.342970 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */

  
  create view "warehouse"."main_stg"."stg_customer__dbt_tmp" as (
    with raw as (
    select * from "warehouse"."main_raw"."customer"
),
std as (
    select
        customerID as customer_id,
        country as country_code,
        state as customer_state,
        VIP as is_vip,
        KYC as is_kyc,
        wantsNewsletter as wants_newsletter,
        try_strptime(latestUpdate, '%m/%d/%Y')::date as latest_update_date
    from raw
)
select * from std
  );

[0m13:51:29.343769 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:29.348024 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:51:29.348304 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */
alter view "warehouse"."main_stg"."stg_customer" rename to "stg_customer__dbt_backup"
[0m13:51:29.349104 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:51:29.352409 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:51:29.352728 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */
alter view "warehouse"."main_stg"."stg_customer__dbt_tmp" rename to "stg_customer"
[0m13:51:29.353396 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:51:29.362149 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: COMMIT
[0m13:51:29.362507 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:51:29.362760 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: COMMIT
[0m13:51:29.367301 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:51:29.371492 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:51:29.371878 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */

      drop view if exists "warehouse"."main_stg"."stg_customer__dbt_backup" cascade
    
[0m13:51:29.373523 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:51:29.375418 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: Close
[0m13:51:29.377409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '992fb974-8ba7-4977-bf38-fdcd74c46fe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E596275BF0>]}
[0m13:51:29.377922 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main_stg.stg_customer ......................... [[32mOK[0m in 0.07s]
[0m13:51:29.378790 [debug] [Thread-1 (]: Finished running node model.raysearch_project.stg_customer
[0m13:51:29.380520 [debug] [MainThread]: Using duckdb connection "master"
[0m13:51:29.380736 [debug] [MainThread]: On master: BEGIN
[0m13:51:29.380901 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:51:29.381532 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:51:29.381753 [debug] [MainThread]: On master: COMMIT
[0m13:51:29.381924 [debug] [MainThread]: Using duckdb connection "master"
[0m13:51:29.382073 [debug] [MainThread]: On master: COMMIT
[0m13:51:29.382774 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:51:29.383188 [debug] [MainThread]: On master: Close
[0m13:51:29.383513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:51:29.383676 [debug] [MainThread]: Connection 'create_warehouse_main_stg' was properly closed.
[0m13:51:29.383814 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m13:51:29.383944 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m13:51:29.384073 [debug] [MainThread]: Connection 'model.raysearch_project.stg_customer' was properly closed.
[0m13:51:29.384275 [info ] [MainThread]: 
[0m13:51:29.384793 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m13:51:29.385671 [debug] [MainThread]: Command end result
[0m13:51:29.404232 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:51:29.407120 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:51:29.411886 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m13:51:29.412163 [info ] [MainThread]: 
[0m13:51:29.412681 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:51:29.413327 [info ] [MainThread]: 
[0m13:51:29.413965 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:51:29.414807 [debug] [MainThread]: Command `dbt build` succeeded at 13:51:29.414701 after 1.24 seconds
[0m13:51:29.415108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E59444B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E595DF3AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5962887E0>]}
[0m13:51:29.415375 [debug] [MainThread]: Flushing usage events
[0m13:51:30.353339 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:54:51.603435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF01244830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF02383ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF023839D0>]}


============================== 13:54:51.608321 | 9d5f5101-86a6-40d5-8b62-a89ecc2d795c ==============================
[0m13:54:51.608321 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:54:51.608934 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt build --select ++stg_customer', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m13:54:51.794963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d5f5101-86a6-40d5-8b62-a89ecc2d795c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF016B6060>]}
[0m13:54:51.846625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d5f5101-86a6-40d5-8b62-a89ecc2d795c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF033C69C0>]}
[0m13:54:51.850282 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:54:52.028958 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:54:52.142007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:54:52.142438 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:54:52.142627 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:54:52.147013 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.intermediate
- models.raysearch_project.marts
[0m13:54:52.180529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d5f5101-86a6-40d5-8b62-a89ecc2d795c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF0385A450>]}
[0m13:54:52.239044 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:54:52.242491 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:54:52.355492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d5f5101-86a6-40d5-8b62-a89ecc2d795c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF7E0C35C0>]}
[0m13:54:52.356481 [info ] [MainThread]: Found 3 models, 3 seeds, 15 data tests, 472 macros
[0m13:54:52.357744 [warn ] [MainThread]: The selection criterion '++stg_customer' does not match any enabled nodes
[0m13:54:52.358898 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:54:52.360564 [debug] [MainThread]: Command end result
[0m13:54:52.377490 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:54:52.381459 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:54:52.384608 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m13:54:52.385267 [debug] [MainThread]: Command `dbt build` succeeded at 13:54:52.385169 after 0.92 seconds
[0m13:54:52.385544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF0235BE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF0235A190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF01CB7BA0>]}
[0m13:54:52.385773 [debug] [MainThread]: Flushing usage events
[0m13:54:53.238634 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:20.242196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002027AA14830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002027BB53ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002027BB539D0>]}


============================== 13:55:20.246842 | a399fb0f-d689-48af-8bf4-4fb889aa56ed ==============================
[0m13:55:20.246842 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:55:20.247497 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt build --select customer,stg_customer', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m13:55:20.440871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a399fb0f-d689-48af-8bf4-4fb889aa56ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002027AE86060>]}
[0m13:55:20.495100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a399fb0f-d689-48af-8bf4-4fb889aa56ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002027CB969C0>]}
[0m13:55:20.498226 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:55:20.682887 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:55:20.799711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:20.800061 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:55:20.800228 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:20.805617 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.marts
- models.raysearch_project.intermediate
[0m13:55:20.838673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a399fb0f-d689-48af-8bf4-4fb889aa56ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002027D0AA450>]}
[0m13:55:20.903518 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:55:20.907043 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:55:21.019632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a399fb0f-d689-48af-8bf4-4fb889aa56ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202779235C0>]}
[0m13:55:21.020105 [info ] [MainThread]: Found 3 models, 3 seeds, 15 data tests, 472 macros
[0m13:55:21.021738 [warn ] [MainThread]: The selection criterion 'customer,stg_customer' does not match any enabled nodes
[0m13:55:21.023075 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:55:21.024493 [debug] [MainThread]: Command end result
[0m13:55:21.042718 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:55:21.045606 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:55:21.048659 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m13:55:21.049376 [debug] [MainThread]: Command `dbt build` succeeded at 13:55:21.049276 after 0.94 seconds
[0m13:55:21.049688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002027BB2BE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002027BB2A190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002027B47FBA0>]}
[0m13:55:21.049966 [debug] [MainThread]: Flushing usage events
[0m13:55:21.829297 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:31.077767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DF8E44830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DF9F7FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DF9F7F9D0>]}


============================== 13:55:31.082027 | c65d5b7e-e483-4214-934e-2e7b4e99eaa0 ==============================
[0m13:55:31.082027 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:55:31.082767 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt seed', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m13:55:31.266600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c65d5b7e-e483-4214-934e-2e7b4e99eaa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DF92B6060>]}
[0m13:55:31.319866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c65d5b7e-e483-4214-934e-2e7b4e99eaa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DFAFC29C0>]}
[0m13:55:31.324787 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:55:31.500671 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:55:31.622826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:31.623397 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:55:31.623615 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:31.628534 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.marts
- models.raysearch_project.intermediate
[0m13:55:31.666924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c65d5b7e-e483-4214-934e-2e7b4e99eaa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DFB45A450>]}
[0m13:55:31.729526 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:55:31.732673 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:55:31.758735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c65d5b7e-e483-4214-934e-2e7b4e99eaa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DFB4858B0>]}
[0m13:55:31.759216 [info ] [MainThread]: Found 3 models, 3 seeds, 15 data tests, 472 macros
[0m13:55:31.759769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c65d5b7e-e483-4214-934e-2e7b4e99eaa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DFB64F3F0>]}
[0m13:55:31.761431 [info ] [MainThread]: 
[0m13:55:31.761929 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:55:31.762256 [info ] [MainThread]: 
[0m13:55:31.762746 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:55:31.766732 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m13:55:31.948970 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:55:31.949357 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:55:31.949570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:32.187616 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:55:32.188063 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m13:55:32.190509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:32.190921 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m13:55:32.191196 [info ] [MainThread]: 
[0m13:55:32.191783 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m13:55:32.192383 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "c:\users\amandaka\workspaces\raysearch_project\warehouse.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Users\AMANDAKA\AppData\Local\DBeaver\dbeaver.exe (PID 40932)
[0m13:55:32.193266 [debug] [MainThread]: Command `dbt seed` failed at 13:55:32.193176 after 1.25 seconds
[0m13:55:32.193558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DFB8536C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DF9D1B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DFB653710>]}
[0m13:55:32.193902 [debug] [MainThread]: Flushing usage events
[0m13:55:33.429347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:51.280043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C2A464830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C2B59FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C2B59F9D0>]}


============================== 13:55:51.284761 | 59058d66-3c5f-4635-bc84-ec56bc7abdfd ==============================
[0m13:55:51.284761 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:55:51.285372 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt seed', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m13:55:51.473572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59058d66-3c5f-4635-bc84-ec56bc7abdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C2A8D6060>]}
[0m13:55:51.525384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59058d66-3c5f-4635-bc84-ec56bc7abdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C2C5E29C0>]}
[0m13:55:51.528967 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:55:51.704226 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:55:51.818823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:51.819446 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:55:51.819923 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:51.824777 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.marts
- models.raysearch_project.intermediate
[0m13:55:51.860461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59058d66-3c5f-4635-bc84-ec56bc7abdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C2CAEA450>]}
[0m13:55:51.924123 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:55:51.927365 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:55:51.954737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59058d66-3c5f-4635-bc84-ec56bc7abdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C2CB118B0>]}
[0m13:55:51.955197 [info ] [MainThread]: Found 3 models, 3 seeds, 15 data tests, 472 macros
[0m13:55:51.955784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59058d66-3c5f-4635-bc84-ec56bc7abdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C2CCC33F0>]}
[0m13:55:51.957380 [info ] [MainThread]: 
[0m13:55:51.957931 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:55:51.958319 [info ] [MainThread]: 
[0m13:55:51.958894 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:55:51.962318 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m13:55:52.140737 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:55:52.141136 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:55:52.141336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:52.157211 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m13:55:52.158368 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:55:52.158967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_raw)
[0m13:55:52.159304 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_raw"
"
[0m13:55:52.163844 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m13:55:52.164108 [debug] [ThreadPool]: On create_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m13:55:52.164311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:52.165125 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:52.166003 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m13:55:52.166220 [debug] [ThreadPool]: On create_warehouse_main_raw: BEGIN
[0m13:55:52.166587 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:55:52.166797 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m13:55:52.166972 [debug] [ThreadPool]: On create_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_raw"} */

    
    
        create schema if not exists "warehouse"."main_raw"
    
[0m13:55:52.167358 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:55:52.167986 [debug] [ThreadPool]: On create_warehouse_main_raw: COMMIT
[0m13:55:52.168229 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m13:55:52.168407 [debug] [ThreadPool]: On create_warehouse_main_raw: COMMIT
[0m13:55:52.168752 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:55:52.168955 [debug] [ThreadPool]: On create_warehouse_main_raw: Close
[0m13:55:52.170911 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m13:55:52.175236 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:55:52.175667 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m13:55:52.175952 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m13:55:52.177024 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m13:55:52.177282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:52.177496 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m13:55:52.177876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:52.178225 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:52.178422 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:55:52.178594 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:52.178787 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m13:55:52.178982 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m13:55:52.179391 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m13:55:52.191000 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:55:52.191425 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m13:55:52.192592 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m13:55:52.193455 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m13:55:52.195804 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m13:55:52.196100 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m13:55:52.197042 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m13:55:52.197249 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m13:55:52.198581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59058d66-3c5f-4635-bc84-ec56bc7abdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C2CEE7EE0>]}
[0m13:55:52.198913 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:52.199081 [debug] [MainThread]: On master: BEGIN
[0m13:55:52.199226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:52.199689 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:55:52.199881 [debug] [MainThread]: On master: COMMIT
[0m13:55:52.200047 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:52.200196 [debug] [MainThread]: On master: COMMIT
[0m13:55:52.200502 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:55:52.200681 [debug] [MainThread]: On master: Close
[0m13:55:52.205380 [debug] [Thread-1 (]: Began running node seed.raysearch_project.currency_exchange
[0m13:55:52.205816 [debug] [Thread-2 (]: Began running node seed.raysearch_project.customer
[0m13:55:52.206174 [debug] [Thread-3 (]: Began running node seed.raysearch_project.transaction
[0m13:55:52.206620 [info ] [Thread-1 (]: 1 of 3 START seed file main_raw.currency_exchange .............................. [RUN]
[0m13:55:52.207012 [info ] [Thread-2 (]: 2 of 3 START seed file main_raw.customer ....................................... [RUN]
[0m13:55:52.207925 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.raysearch_project.currency_exchange'
[0m13:55:52.208317 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.raysearch_project.customer'
[0m13:55:52.207483 [info ] [Thread-3 (]: 3 of 3 START seed file main_raw.transaction .................................... [RUN]
[0m13:55:52.208739 [debug] [Thread-1 (]: Began compiling node seed.raysearch_project.currency_exchange
[0m13:55:52.208998 [debug] [Thread-2 (]: Began compiling node seed.raysearch_project.customer
[0m13:55:52.209309 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.raysearch_project.transaction'
[0m13:55:52.209616 [debug] [Thread-1 (]: Began executing node seed.raysearch_project.currency_exchange
[0m13:55:52.209856 [debug] [Thread-2 (]: Began executing node seed.raysearch_project.customer
[0m13:55:52.210084 [debug] [Thread-3 (]: Began compiling node seed.raysearch_project.transaction
[0m13:55:52.225949 [debug] [Thread-3 (]: Began executing node seed.raysearch_project.transaction
[0m13:55:52.271425 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m13:55:52.273332 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m13:55:52.273692 [debug] [Thread-2 (]: On seed.raysearch_project.customer: BEGIN
[0m13:55:52.273965 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: BEGIN
[0m13:55:52.287570 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:55:52.319673 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:55:52.401996 [debug] [Thread-1 (]: SQL status: OK in 0.082 seconds
[0m13:55:52.402495 [debug] [Thread-2 (]: SQL status: OK in 0.115 seconds
[0m13:55:52.437105 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m13:55:52.485544 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m13:55:52.535539 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "seed.raysearch_project.currency_exchange"} */
truncate table "warehouse"."main_raw"."currency_exchange"
[0m13:55:52.585765 [debug] [Thread-2 (]: On seed.raysearch_project.customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "seed.raysearch_project.customer"} */
truncate table "warehouse"."main_raw"."customer"
[0m13:55:52.670084 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m13:55:52.714366 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m13:55:52.721579 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: 
          COPY "warehouse"."main_raw"."currency_exchange" FROM 'C:\Users\AMANDAKA\Workspaces\raysearch_project\seeds\currency_exchange.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:55:52.736787 [debug] [Thread-2 (]: SQL status: OK in 0.066 seconds
[0m13:55:52.769372 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m13:55:52.770192 [debug] [Thread-2 (]: On seed.raysearch_project.customer: 
          COPY "warehouse"."main_raw"."customer" FROM 'C:\Users\AMANDAKA\Workspaces\raysearch_project\seeds\customer.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:55:52.773230 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m13:55:52.773732 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: BEGIN
[0m13:55:52.773958 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:55:52.774494 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:55:52.774734 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m13:55:52.774943 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "seed.raysearch_project.transaction"} */
truncate table "warehouse"."main_raw"."transaction"
[0m13:55:52.776415 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:55:52.778425 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m13:55:52.779096 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: 
          COPY "warehouse"."main_raw"."transaction" FROM 'C:\Users\AMANDAKA\Workspaces\raysearch_project\seeds\transaction.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:55:52.779487 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m13:55:52.786420 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.raysearch_project.customer"
[0m13:55:52.796189 [debug] [Thread-2 (]: On seed.raysearch_project.customer: COMMIT
[0m13:55:52.796632 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m13:55:52.796906 [debug] [Thread-2 (]: On seed.raysearch_project.customer: COMMIT
[0m13:55:52.801144 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:55:52.803035 [debug] [Thread-2 (]: On seed.raysearch_project.customer: Close
[0m13:55:52.806150 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59058d66-3c5f-4635-bc84-ec56bc7abdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C2D0E0650>]}
[0m13:55:52.807059 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file main_raw.customer ................................... [[32mINSERT 67[0m in 0.60s]
[0m13:55:52.808081 [debug] [Thread-2 (]: Finished running node seed.raysearch_project.customer
[0m13:55:52.839724 [debug] [Thread-3 (]: SQL status: OK in 0.060 seconds
[0m13:55:52.840493 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.raysearch_project.transaction"
[0m13:55:52.843535 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: COMMIT
[0m13:55:52.843967 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m13:55:52.844257 [debug] [Thread-1 (]: SQL status: OK in 0.122 seconds
[0m13:55:52.844633 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: COMMIT
[0m13:55:52.845147 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.raysearch_project.currency_exchange"
[0m13:55:52.848282 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: COMMIT
[0m13:55:52.848658 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m13:55:52.848852 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: COMMIT
[0m13:55:52.863043 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m13:55:52.863933 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: Close
[0m13:55:52.864494 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59058d66-3c5f-4635-bc84-ec56bc7abdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C2CD9D7B0>]}
[0m13:55:52.864868 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m13:55:52.865999 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: Close
[0m13:55:52.865302 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file main_raw.transaction ................................ [[32mINSERT 38025[0m in 0.66s]
[0m13:55:52.866438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59058d66-3c5f-4635-bc84-ec56bc7abdfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C2A85F6B0>]}
[0m13:55:52.866819 [debug] [Thread-3 (]: Finished running node seed.raysearch_project.transaction
[0m13:55:52.867187 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file main_raw.currency_exchange .......................... [[32mINSERT 1977[0m in 0.66s]
[0m13:55:52.867759 [debug] [Thread-1 (]: Finished running node seed.raysearch_project.currency_exchange
[0m13:55:52.868852 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:52.869068 [debug] [MainThread]: On master: BEGIN
[0m13:55:52.869224 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:52.870189 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:55:52.870565 [debug] [MainThread]: On master: COMMIT
[0m13:55:52.870740 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:52.870888 [debug] [MainThread]: On master: COMMIT
[0m13:55:52.871443 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:55:52.871685 [debug] [MainThread]: On master: Close
[0m13:55:52.872093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:52.872551 [debug] [MainThread]: Connection 'create_warehouse_main_raw' was properly closed.
[0m13:55:52.872722 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m13:55:52.872861 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m13:55:52.872997 [debug] [MainThread]: Connection 'seed.raysearch_project.currency_exchange' was properly closed.
[0m13:55:52.873131 [debug] [MainThread]: Connection 'seed.raysearch_project.customer' was properly closed.
[0m13:55:52.873258 [debug] [MainThread]: Connection 'seed.raysearch_project.transaction' was properly closed.
[0m13:55:52.873478 [info ] [MainThread]: 
[0m13:55:52.873937 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m13:55:52.874730 [debug] [MainThread]: Command end result
[0m13:55:52.895136 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:55:52.898199 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:55:52.904639 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m13:55:52.905355 [info ] [MainThread]: 
[0m13:55:52.906137 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:52.906773 [info ] [MainThread]: 
[0m13:55:52.907339 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m13:55:52.908690 [debug] [MainThread]: Command `dbt seed` succeeded at 13:55:52.908541 after 1.76 seconds
[0m13:55:52.909151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C2CC5BCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C2CD89050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C2B5C1A90>]}
[0m13:55:52.909650 [debug] [MainThread]: Flushing usage events
[0m13:55:53.862864 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:56:06.776952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD83394830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD844CFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD844CF9D0>]}


============================== 13:56:06.781359 | 58e392ab-d19f-4550-923f-3a70646e12c1 ==============================
[0m13:56:06.781359 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:56:06.781920 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt run --select customer', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m13:56:06.973875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58e392ab-d19f-4550-923f-3a70646e12c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD83806060>]}
[0m13:56:07.024922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58e392ab-d19f-4550-923f-3a70646e12c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD8550E9C0>]}
[0m13:56:07.028125 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:56:07.207674 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:56:07.322270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:07.322644 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:56:07.322839 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:07.327304 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.marts
- models.raysearch_project.intermediate
[0m13:56:07.361411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58e392ab-d19f-4550-923f-3a70646e12c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD859CA450>]}
[0m13:56:07.421596 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:56:07.424681 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:56:07.451652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58e392ab-d19f-4550-923f-3a70646e12c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD84342C60>]}
[0m13:56:07.452612 [info ] [MainThread]: Found 3 models, 3 seeds, 15 data tests, 472 macros
[0m13:56:07.453168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58e392ab-d19f-4550-923f-3a70646e12c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD85BB6DD0>]}
[0m13:56:07.454439 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:56:07.456764 [debug] [MainThread]: Command end result
[0m13:56:07.554336 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:56:07.557282 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:56:07.560255 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m13:56:07.560892 [debug] [MainThread]: Command `dbt run` succeeded at 13:56:07.560805 after 0.92 seconds
[0m13:56:07.561160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD83DFFBA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD8426B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD85BBE150>]}
[0m13:56:07.561381 [debug] [MainThread]: Flushing usage events
[0m13:56:08.352778 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:56:20.574168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285CDB4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285DEEBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285DEEB9D0>]}


============================== 13:56:20.579392 | 17d391ff-03ef-41f8-9379-b12d5de372b0 ==============================
[0m13:56:20.579392 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:56:20.580045 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select stg_customer', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m13:56:20.779439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17d391ff-03ef-41f8-9379-b12d5de372b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285D226060>]}
[0m13:56:20.836511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17d391ff-03ef-41f8-9379-b12d5de372b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285EF329C0>]}
[0m13:56:20.839999 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m13:56:21.029388 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:56:21.158708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:21.159070 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:56:21.159246 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:21.163895 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.intermediate
- models.raysearch_project.marts
[0m13:56:21.198378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17d391ff-03ef-41f8-9379-b12d5de372b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285F46A450>]}
[0m13:56:21.265168 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:56:21.269597 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:56:21.297064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17d391ff-03ef-41f8-9379-b12d5de372b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285DD62C60>]}
[0m13:56:21.297503 [info ] [MainThread]: Found 3 models, 3 seeds, 15 data tests, 472 macros
[0m13:56:21.298007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17d391ff-03ef-41f8-9379-b12d5de372b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285F656DD0>]}
[0m13:56:21.299271 [info ] [MainThread]: 
[0m13:56:21.299727 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:56:21.300031 [info ] [MainThread]: 
[0m13:56:21.300497 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:56:21.301572 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m13:56:21.484539 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m13:56:21.484917 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m13:56:21.485111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:21.522385 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m13:56:21.523539 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:56:21.524219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_stg)
[0m13:56:21.524563 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_stg"
"
[0m13:56:21.529077 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:56:21.529395 [debug] [ThreadPool]: On create_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_stg"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m13:56:21.529595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:21.530578 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:56:21.531542 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:56:21.531767 [debug] [ThreadPool]: On create_warehouse_main_stg: BEGIN
[0m13:56:21.532169 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:56:21.532364 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:56:21.532535 [debug] [ThreadPool]: On create_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_stg"} */

    
    
        create schema if not exists "warehouse"."main_stg"
    
[0m13:56:21.532925 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:56:21.533503 [debug] [ThreadPool]: On create_warehouse_main_stg: COMMIT
[0m13:56:21.533703 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_stg"
[0m13:56:21.533871 [debug] [ThreadPool]: On create_warehouse_main_stg: COMMIT
[0m13:56:21.534209 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:56:21.534632 [debug] [ThreadPool]: On create_warehouse_main_stg: Close
[0m13:56:21.539036 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m13:56:21.543587 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:56:21.544054 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m13:56:21.544345 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m13:56:21.545605 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m13:56:21.545908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:21.546139 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m13:56:21.546580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:21.546939 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:56:21.547167 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m13:56:21.547352 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:56:21.547577 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m13:56:21.547795 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m13:56:21.548172 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m13:56:21.559374 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:56:21.559845 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:56:21.561028 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m13:56:21.561858 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m13:56:21.564422 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m13:56:21.564766 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m13:56:21.565772 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m13:56:21.565997 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m13:56:21.567884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17d391ff-03ef-41f8-9379-b12d5de372b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285EFC3BA0>]}
[0m13:56:21.568902 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:21.569415 [debug] [MainThread]: On master: BEGIN
[0m13:56:21.569847 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:21.570880 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:56:21.571354 [debug] [MainThread]: On master: COMMIT
[0m13:56:21.571726 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:21.572092 [debug] [MainThread]: On master: COMMIT
[0m13:56:21.572516 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:56:21.572723 [debug] [MainThread]: On master: Close
[0m13:56:21.577087 [debug] [Thread-1 (]: Began running node model.raysearch_project.stg_customer
[0m13:56:21.577636 [info ] [Thread-1 (]: 1 of 1 START sql view model main_stg.stg_customer .............................. [RUN]
[0m13:56:21.578387 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.raysearch_project.stg_customer'
[0m13:56:21.578638 [debug] [Thread-1 (]: Began compiling node model.raysearch_project.stg_customer
[0m13:56:21.583687 [debug] [Thread-1 (]: Writing injected SQL for node "model.raysearch_project.stg_customer"
[0m13:56:21.585627 [debug] [Thread-1 (]: Began executing node model.raysearch_project.stg_customer
[0m13:56:21.614165 [debug] [Thread-1 (]: Writing runtime sql for node "model.raysearch_project.stg_customer"
[0m13:56:21.615702 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:56:21.616094 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: BEGIN
[0m13:56:21.616350 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:56:21.617478 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:56:21.617881 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:56:21.618545 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */

  
  create view "warehouse"."main_stg"."stg_customer__dbt_tmp" as (
    with raw as (
    select * from "warehouse"."main_raw"."customer"
),
std as (
    select
        customerID as customer_id,
        country as country_code,
        state as customer_state,
        VIP as is_vip,
        KYC as is_kyc,
        wantsNewsletter as wants_newsletter,
        try_strptime(latestUpdate, '%m/%d/%Y')::date as latest_update_date
    from raw
)
select * from std
  );

[0m13:56:21.620308 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:56:21.628049 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:56:21.628648 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */
alter view "warehouse"."main_stg"."stg_customer" rename to "stg_customer__dbt_backup"
[0m13:56:21.629958 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:56:21.633583 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:56:21.633992 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */
alter view "warehouse"."main_stg"."stg_customer__dbt_tmp" rename to "stg_customer"
[0m13:56:21.634598 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:56:21.644214 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: COMMIT
[0m13:56:21.644605 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:56:21.644807 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: COMMIT
[0m13:56:21.649544 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:56:21.653949 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.stg_customer"
[0m13:56:21.654318 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.stg_customer"} */

      drop view if exists "warehouse"."main_stg"."stg_customer__dbt_backup" cascade
    
[0m13:56:21.656003 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:56:21.657700 [debug] [Thread-1 (]: On model.raysearch_project.stg_customer: Close
[0m13:56:21.659663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17d391ff-03ef-41f8-9379-b12d5de372b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285FA78050>]}
[0m13:56:21.660188 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main_stg.stg_customer ......................... [[32mOK[0m in 0.08s]
[0m13:56:21.660978 [debug] [Thread-1 (]: Finished running node model.raysearch_project.stg_customer
[0m13:56:21.662365 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:21.662592 [debug] [MainThread]: On master: BEGIN
[0m13:56:21.662757 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:56:21.663275 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:56:21.663463 [debug] [MainThread]: On master: COMMIT
[0m13:56:21.663626 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:21.663772 [debug] [MainThread]: On master: COMMIT
[0m13:56:21.664158 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:56:21.664371 [debug] [MainThread]: On master: Close
[0m13:56:21.664623 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:21.664778 [debug] [MainThread]: Connection 'create_warehouse_main_stg' was properly closed.
[0m13:56:21.664914 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m13:56:21.665045 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m13:56:21.665182 [debug] [MainThread]: Connection 'model.raysearch_project.stg_customer' was properly closed.
[0m13:56:21.665377 [info ] [MainThread]: 
[0m13:56:21.665891 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m13:56:21.666972 [debug] [MainThread]: Command end result
[0m13:56:21.686195 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m13:56:21.690891 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m13:56:21.695916 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m13:56:21.696257 [info ] [MainThread]: 
[0m13:56:21.696891 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:56:21.697242 [info ] [MainThread]: 
[0m13:56:21.697569 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:56:21.698296 [debug] [MainThread]: Command `dbt run` succeeded at 13:56:21.698199 after 1.27 seconds
[0m13:56:21.698591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285F8E1D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022859F29A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285D1AF6B0>]}
[0m13:56:21.698853 [debug] [MainThread]: Flushing usage events
[0m13:56:22.502504 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:37:36.564094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276464F4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002764762FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002764762F9D0>]}


============================== 17:37:36.590333 | 711e7f10-3c15-4948-9f55-28ed57cc9a81 ==============================
[0m17:37:36.590333 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:37:36.592391 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt seed', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m17:37:38.069943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '711e7f10-3c15-4948-9f55-28ed57cc9a81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027646966060>]}
[0m17:37:38.198550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '711e7f10-3c15-4948-9f55-28ed57cc9a81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276476A29C0>]}
[0m17:37:38.280727 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:37:39.369949 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:37:45.589367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m17:37:45.591142 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://seeds\seeds.yml
[0m17:37:45.591870 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models\staging\stg_transaction.sql
[0m17:37:45.592482 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models\staging\stg_currency_exchange.sql
[0m17:37:46.606761 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'transaction' in
package 'raysearch_project' (seeds\seeds.yml). Arguments to generic tests should
be nested under the `arguments` property.
[0m17:37:46.608427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '711e7f10-3c15-4948-9f55-28ed57cc9a81', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027648B5B050>]}
[0m17:37:46.787900 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.intermediate
- models.raysearch_project.marts
[0m17:37:46.797169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '711e7f10-3c15-4948-9f55-28ed57cc9a81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027648DA6D50>]}
[0m17:37:46.958059 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m17:37:47.041488 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m17:37:47.188676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '711e7f10-3c15-4948-9f55-28ed57cc9a81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002764893AA50>]}
[0m17:37:47.190006 [info ] [MainThread]: Found 3 seeds, 16 data tests, 3 models, 472 macros
[0m17:37:47.192232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '711e7f10-3c15-4948-9f55-28ed57cc9a81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027648CF1230>]}
[0m17:37:47.196650 [info ] [MainThread]: 
[0m17:37:47.198083 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:37:47.199783 [info ] [MainThread]: 
[0m17:37:47.202567 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:37:47.217982 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m17:38:01.796593 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m17:38:01.797647 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m17:38:01.798294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:02.252397 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m17:38:02.253458 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:38:02.257334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:02.258295 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m17:38:02.259005 [info ] [MainThread]: 
[0m17:38:02.260274 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 15.06 seconds (15.06s).
[0m17:38:02.262081 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "c:\users\amandaka\workspaces\raysearch_project\warehouse.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Users\AMANDAKA\AppData\Local\DBeaver\dbeaver.exe (PID 40932)
[0m17:38:02.263728 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:38:02.266023 [debug] [MainThread]: Command `dbt seed` failed at 17:38:02.265757 after 26.24 seconds
[0m17:38:02.266866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276473CB890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027648EA9390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027648EA9B20>]}
[0m17:38:02.268261 [debug] [MainThread]: Flushing usage events
[0m17:38:04.017710 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:38:23.809202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D69734830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D6A867ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D6A8679D0>]}


============================== 17:38:23.819975 | b2030f5f-6ffd-4835-b7b4-7e2be3bd7a5d ==============================
[0m17:38:23.819975 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:38:23.821501 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt seed', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m17:38:24.289215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2030f5f-6ffd-4835-b7b4-7e2be3bd7a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D69BA6060>]}
[0m17:38:24.415185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2030f5f-6ffd-4835-b7b4-7e2be3bd7a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D6B8B29C0>]}
[0m17:38:24.421041 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:38:24.887611 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:38:25.234358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:38:25.235232 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:38:25.235703 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:38:25.247694 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.marts
- models.raysearch_project.intermediate
[0m17:38:25.327064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2030f5f-6ffd-4835-b7b4-7e2be3bd7a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D6BDBE450>]}
[0m17:38:25.484885 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m17:38:25.490833 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m17:38:25.568097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2030f5f-6ffd-4835-b7b4-7e2be3bd7a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D6BDE58B0>]}
[0m17:38:25.569662 [info ] [MainThread]: Found 3 seeds, 16 data tests, 3 models, 472 macros
[0m17:38:25.570949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2030f5f-6ffd-4835-b7b4-7e2be3bd7a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D6BFB33F0>]}
[0m17:38:25.575056 [info ] [MainThread]: 
[0m17:38:25.576162 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:38:25.577107 [info ] [MainThread]: 
[0m17:38:25.578600 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:38:25.588791 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m17:38:25.964282 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m17:38:25.965133 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m17:38:25.965650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:26.049806 [debug] [ThreadPool]: SQL status: OK in 0.084 seconds
[0m17:38:26.052887 [debug] [ThreadPool]: On list_warehouse: Close
[0m17:38:26.054452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_raw)
[0m17:38:26.055341 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_raw"
"
[0m17:38:26.067523 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m17:38:26.068349 [debug] [ThreadPool]: On create_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_raw"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m17:38:26.068880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:26.071267 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:38:26.074334 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m17:38:26.075473 [debug] [ThreadPool]: On create_warehouse_main_raw: BEGIN
[0m17:38:26.077111 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:38:26.077768 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m17:38:26.078255 [debug] [ThreadPool]: On create_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_raw"} */

    
    
        create schema if not exists "warehouse"."main_raw"
    
[0m17:38:26.079699 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:38:26.081844 [debug] [ThreadPool]: On create_warehouse_main_raw: COMMIT
[0m17:38:26.082511 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_raw"
[0m17:38:26.082995 [debug] [ThreadPool]: On create_warehouse_main_raw: COMMIT
[0m17:38:26.084144 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:38:26.084759 [debug] [ThreadPool]: On create_warehouse_main_raw: Close
[0m17:38:26.087770 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m17:38:26.089381 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m17:38:26.101170 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m17:38:26.104275 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m17:38:26.105031 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m17:38:26.105670 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m17:38:26.106202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:26.106723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:26.108096 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:38:26.108790 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:38:26.109351 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m17:38:26.109915 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m17:38:26.110493 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m17:38:26.111098 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m17:38:26.141487 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m17:38:26.142882 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m17:38:26.145314 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m17:38:26.147701 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m17:38:26.212030 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m17:38:26.212935 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m17:38:26.217610 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m17:38:26.218570 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m17:38:26.221479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2030f5f-6ffd-4835-b7b4-7e2be3bd7a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D6C1B7EE0>]}
[0m17:38:26.222500 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:26.223120 [debug] [MainThread]: On master: BEGIN
[0m17:38:26.223707 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:26.225110 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:38:26.226170 [debug] [MainThread]: On master: COMMIT
[0m17:38:26.227068 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:26.227664 [debug] [MainThread]: On master: COMMIT
[0m17:38:26.228946 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:38:26.229635 [debug] [MainThread]: On master: Close
[0m17:38:26.243011 [debug] [Thread-2 (]: Began running node seed.raysearch_project.customer
[0m17:38:26.244404 [debug] [Thread-3 (]: Began running node seed.raysearch_project.transaction
[0m17:38:26.245286 [debug] [Thread-1 (]: Began running node seed.raysearch_project.currency_exchange
[0m17:38:26.246298 [info ] [Thread-2 (]: 2 of 3 START seed file main_raw.customer ....................................... [RUN]
[0m17:38:26.249719 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.raysearch_project.customer'
[0m17:38:26.250365 [debug] [Thread-2 (]: Began compiling node seed.raysearch_project.customer
[0m17:38:26.247195 [info ] [Thread-3 (]: 3 of 3 START seed file main_raw.transaction .................................... [RUN]
[0m17:38:26.251212 [debug] [Thread-2 (]: Began executing node seed.raysearch_project.customer
[0m17:38:26.248679 [info ] [Thread-1 (]: 1 of 3 START seed file main_raw.currency_exchange .............................. [RUN]
[0m17:38:26.252590 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.raysearch_project.transaction'
[0m17:38:26.279382 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.raysearch_project.currency_exchange'
[0m17:38:26.286508 [debug] [Thread-3 (]: Began compiling node seed.raysearch_project.transaction
[0m17:38:26.287354 [debug] [Thread-1 (]: Began compiling node seed.raysearch_project.currency_exchange
[0m17:38:26.288321 [debug] [Thread-3 (]: Began executing node seed.raysearch_project.transaction
[0m17:38:26.289395 [debug] [Thread-1 (]: Began executing node seed.raysearch_project.currency_exchange
[0m17:38:26.327272 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m17:38:26.329505 [debug] [Thread-2 (]: On seed.raysearch_project.customer: BEGIN
[0m17:38:26.330115 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:38:26.383328 [debug] [Thread-2 (]: SQL status: OK in 0.053 seconds
[0m17:38:26.457878 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m17:38:26.482630 [debug] [Thread-2 (]: On seed.raysearch_project.customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "seed.raysearch_project.customer"} */
truncate table "warehouse"."main_raw"."customer"
[0m17:38:26.518539 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m17:38:26.523338 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: BEGIN
[0m17:38:26.524178 [debug] [Thread-2 (]: SQL status: OK in 0.041 seconds
[0m17:38:26.556269 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:38:26.641271 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m17:38:26.678443 [debug] [Thread-2 (]: On seed.raysearch_project.customer: 
          COPY "warehouse"."main_raw"."customer" FROM 'C:\Users\AMANDAKA\Workspaces\raysearch_project\seeds\customer.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:38:26.679475 [debug] [Thread-1 (]: SQL status: OK in 0.123 seconds
[0m17:38:26.730509 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m17:38:26.744084 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "seed.raysearch_project.currency_exchange"} */
truncate table "warehouse"."main_raw"."currency_exchange"
[0m17:38:26.759871 [debug] [Thread-2 (]: SQL status: OK in 0.049 seconds
[0m17:38:26.803212 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.raysearch_project.customer"
[0m17:38:26.817543 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m17:38:26.827638 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m17:38:26.850313 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: 
          COPY "warehouse"."main_raw"."currency_exchange" FROM 'C:\Users\AMANDAKA\Workspaces\raysearch_project\seeds\currency_exchange.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:38:26.933560 [debug] [Thread-2 (]: On seed.raysearch_project.customer: COMMIT
[0m17:38:26.940295 [debug] [Thread-2 (]: Using duckdb connection "seed.raysearch_project.customer"
[0m17:38:26.948470 [debug] [Thread-2 (]: On seed.raysearch_project.customer: COMMIT
[0m17:38:27.028077 [debug] [Thread-2 (]: SQL status: OK in 0.063 seconds
[0m17:38:27.065408 [debug] [Thread-2 (]: On seed.raysearch_project.customer: Close
[0m17:38:27.105868 [debug] [Thread-1 (]: SQL status: OK in 0.231 seconds
[0m17:38:27.115135 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.raysearch_project.currency_exchange"
[0m17:38:27.185217 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: COMMIT
[0m17:38:27.186113 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2030f5f-6ffd-4835-b7b4-7e2be3bd7a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D6C385790>]}
[0m17:38:27.216564 [debug] [Thread-1 (]: Using duckdb connection "seed.raysearch_project.currency_exchange"
[0m17:38:27.265363 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file main_raw.customer ................................... [[32mINSERT 67[0m in 0.86s]
[0m17:38:27.297643 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: COMMIT
[0m17:38:27.355993 [debug] [Thread-2 (]: Finished running node seed.raysearch_project.customer
[0m17:38:27.446238 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m17:38:27.478743 [debug] [Thread-1 (]: On seed.raysearch_project.currency_exchange: Close
[0m17:38:27.497159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2030f5f-6ffd-4835-b7b4-7e2be3bd7a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D6C0619C0>]}
[0m17:38:27.510875 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file main_raw.currency_exchange .......................... [[32mINSERT 1977[0m in 1.22s]
[0m17:38:27.544547 [debug] [Thread-1 (]: Finished running node seed.raysearch_project.currency_exchange
[0m17:38:27.591532 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m17:38:27.592985 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: BEGIN
[0m17:38:27.594998 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:38:27.596997 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:38:27.597725 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m17:38:27.598542 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "seed.raysearch_project.transaction"} */
truncate table "warehouse"."main_raw"."transaction"
[0m17:38:27.600687 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:38:27.603013 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m17:38:27.603606 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: 
          COPY "warehouse"."main_raw"."transaction" FROM 'C:\Users\AMANDAKA\Workspaces\raysearch_project\seeds\transaction.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:38:27.718061 [debug] [Thread-3 (]: SQL status: OK in 0.114 seconds
[0m17:38:27.719633 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.raysearch_project.transaction"
[0m17:38:27.724321 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: COMMIT
[0m17:38:27.725342 [debug] [Thread-3 (]: Using duckdb connection "seed.raysearch_project.transaction"
[0m17:38:27.726149 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: COMMIT
[0m17:38:27.768497 [debug] [Thread-3 (]: SQL status: OK in 0.042 seconds
[0m17:38:27.770177 [debug] [Thread-3 (]: On seed.raysearch_project.transaction: Close
[0m17:38:27.771196 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2030f5f-6ffd-4835-b7b4-7e2be3bd7a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D6C3CB1B0>]}
[0m17:38:27.772104 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file main_raw.transaction ................................ [[32mINSERT 38025[0m in 1.52s]
[0m17:38:27.773663 [debug] [Thread-3 (]: Finished running node seed.raysearch_project.transaction
[0m17:38:27.777012 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:27.777716 [debug] [MainThread]: On master: BEGIN
[0m17:38:27.778415 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:38:27.779667 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:38:27.780208 [debug] [MainThread]: On master: COMMIT
[0m17:38:27.780661 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:27.781075 [debug] [MainThread]: On master: COMMIT
[0m17:38:27.781906 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:38:27.782427 [debug] [MainThread]: On master: Close
[0m17:38:27.783081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:27.783492 [debug] [MainThread]: Connection 'create_warehouse_main_raw' was properly closed.
[0m17:38:27.784099 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m17:38:27.784936 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m17:38:27.785800 [debug] [MainThread]: Connection 'seed.raysearch_project.customer' was properly closed.
[0m17:38:27.786359 [debug] [MainThread]: Connection 'seed.raysearch_project.transaction' was properly closed.
[0m17:38:27.786769 [debug] [MainThread]: Connection 'seed.raysearch_project.currency_exchange' was properly closed.
[0m17:38:27.787333 [info ] [MainThread]: 
[0m17:38:27.788333 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 2.21 seconds (2.21s).
[0m17:38:27.791019 [debug] [MainThread]: Command end result
[0m17:38:27.838742 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m17:38:27.846202 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m17:38:27.858084 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m17:38:27.859475 [info ] [MainThread]: 
[0m17:38:27.860656 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:27.861625 [info ] [MainThread]: 
[0m17:38:27.862437 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m17:38:27.864187 [debug] [MainThread]: Command `dbt seed` succeeded at 17:38:27.863948 after 4.35 seconds
[0m17:38:27.865118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D6C23FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D69B42050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010D6A891A90>]}
[0m17:38:27.866106 [debug] [MainThread]: Flushing usage events
[0m17:38:29.597678 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:38:47.831413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6FFC64830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D680DBFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D680DBF9D0>]}


============================== 17:38:47.844677 | 5c4eb9fa-5139-4a5b-af75-37c71ba488fb ==============================
[0m17:38:47.844677 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:38:47.846583 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt test', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m17:38:48.349287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c4eb9fa-5139-4a5b-af75-37c71ba488fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6800F6060>]}
[0m17:38:48.478375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c4eb9fa-5139-4a5b-af75-37c71ba488fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D681E069C0>]}
[0m17:38:48.486405 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:38:48.988042 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:38:49.336636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:38:49.337479 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:38:49.337958 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:38:49.350708 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.intermediate
- models.raysearch_project.marts
[0m17:38:49.435205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c4eb9fa-5139-4a5b-af75-37c71ba488fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D682331F50>]}
[0m17:38:49.575029 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m17:38:49.585098 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m17:38:49.849735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c4eb9fa-5139-4a5b-af75-37c71ba488fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D68259F5C0>]}
[0m17:38:49.850787 [info ] [MainThread]: Found 3 seeds, 16 data tests, 3 models, 472 macros
[0m17:38:49.852148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c4eb9fa-5139-4a5b-af75-37c71ba488fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D681FD98D0>]}
[0m17:38:49.858134 [info ] [MainThread]: 
[0m17:38:49.859419 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:38:49.862810 [info ] [MainThread]: 
[0m17:38:49.864182 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:38:49.878565 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m17:38:49.903148 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m17:38:50.312687 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m17:38:50.314154 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m17:38:50.315069 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m17:38:50.315808 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m17:38:50.316602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:50.317204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:50.402968 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m17:38:50.404278 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m17:38:50.405151 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m17:38:50.405957 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m17:38:50.406731 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m17:38:50.408511 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m17:38:50.442449 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m17:38:50.443644 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m17:38:50.447996 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m17:38:50.452094 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m17:38:50.454992 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m17:38:50.455770 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m17:38:50.460656 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m17:38:50.461422 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m17:38:50.464394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c4eb9fa-5139-4a5b-af75-37c71ba488fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6827A31E0>]}
[0m17:38:50.465618 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:50.466473 [debug] [MainThread]: On master: BEGIN
[0m17:38:50.467210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:50.468836 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:38:50.469609 [debug] [MainThread]: On master: COMMIT
[0m17:38:50.470152 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:50.470620 [debug] [MainThread]: On master: COMMIT
[0m17:38:50.471543 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:38:50.472073 [debug] [MainThread]: On master: Close
[0m17:38:50.484737 [debug] [Thread-2 (]: Began running node test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773
[0m17:38:50.486226 [debug] [Thread-1 (]: Began running node test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c
[0m17:38:50.487030 [debug] [Thread-4 (]: Began running node test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41
[0m17:38:50.487816 [debug] [Thread-3 (]: Began running node test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb
[0m17:38:50.488728 [info ] [Thread-2 (]: 2 of 16 START test accepted_values_customer_VIP__0__1 .......................... [RUN]
[0m17:38:50.489586 [info ] [Thread-1 (]: 1 of 16 START test accepted_values_customer_KYC__0__1 .......................... [RUN]
[0m17:38:50.492997 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773'
[0m17:38:50.494160 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c'
[0m17:38:50.490727 [info ] [Thread-4 (]: 4 of 16 START test accepted_values_customer_wantsNewsletter__0__1 .............. [RUN]
[0m17:38:50.495499 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773
[0m17:38:50.496528 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c
[0m17:38:50.491605 [info ] [Thread-3 (]: 3 of 16 START test accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE . [RUN]
[0m17:38:50.498282 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41'
[0m17:38:50.541576 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"
[0m17:38:50.545623 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb'
[0m17:38:50.549073 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"
[0m17:38:50.549985 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41
[0m17:38:50.550974 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb
[0m17:38:50.558076 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"
[0m17:38:50.567745 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"
[0m17:38:50.569063 [debug] [Thread-2 (]: Began executing node test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773
[0m17:38:50.578427 [debug] [Thread-1 (]: Began executing node test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c
[0m17:38:50.633941 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"
[0m17:38:50.635882 [debug] [Thread-4 (]: Began executing node test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41
[0m17:38:50.646851 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"
[0m17:38:50.648251 [debug] [Thread-3 (]: Began executing node test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb
[0m17:38:50.642490 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"
[0m17:38:50.653310 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"
[0m17:38:50.654856 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"
[0m17:38:50.655545 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773: BEGIN
[0m17:38:50.656512 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:38:50.658997 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"
[0m17:38:50.661196 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c: BEGIN
[0m17:38:50.661883 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:38:50.662941 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"
[0m17:38:50.663672 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb: BEGIN
[0m17:38:50.664268 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:38:50.665316 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"
[0m17:38:50.665945 [debug] [Thread-4 (]: On test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41: BEGIN
[0m17:38:50.666640 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:38:50.667426 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:38:50.668067 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:38:50.668682 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m17:38:50.669247 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"
[0m17:38:50.669886 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"
[0m17:38:50.670782 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"
[0m17:38:50.671477 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."customer"
    group by state

)

select *
from all_values
where value_field not in (
    'VALIDATED','SIGNUP','INACTIVE'
)



  
  
      
    ) dbt_internal_test
[0m17:38:50.672128 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:38:50.672899 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        KYC as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."customer"
    group by KYC

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  
      
    ) dbt_internal_test
[0m17:38:50.673640 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        VIP as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."customer"
    group by VIP

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  
      
    ) dbt_internal_test
[0m17:38:50.675599 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"
[0m17:38:50.677573 [debug] [Thread-4 (]: On test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        wantsNewsletter as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."customer"
    group by wantsNewsletter

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  
      
    ) dbt_internal_test
[0m17:38:50.678996 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:38:50.679846 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:38:50.680669 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:38:50.681412 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:38:50.689670 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb: ROLLBACK
[0m17:38:50.693604 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c: ROLLBACK
[0m17:38:50.696854 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773: ROLLBACK
[0m17:38:50.699750 [debug] [Thread-4 (]: On test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41: ROLLBACK
[0m17:38:50.701593 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb'
[0m17:38:50.702292 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb: Close
[0m17:38:50.703414 [info ] [Thread-3 (]: 3 of 16 PASS accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE ....... [[32mPASS[0m in 0.16s]
[0m17:38:50.705607 [debug] [Thread-3 (]: Finished running node test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb
[0m17:38:50.706291 [debug] [Thread-3 (]: Began running node test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a
[0m17:38:50.706879 [info ] [Thread-3 (]: 5 of 16 START test accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL ..... [RUN]
[0m17:38:50.709040 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb, now test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a)
[0m17:38:50.709836 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a
[0m17:38:50.721437 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"
[0m17:38:50.725787 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c'
[0m17:38:50.727339 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c: Close
[0m17:38:50.729306 [info ] [Thread-1 (]: 1 of 16 PASS accepted_values_customer_KYC__0__1 ................................ [[32mPASS[0m in 0.24s]
[0m17:38:50.730907 [debug] [Thread-1 (]: Finished running node test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c
[0m17:38:50.732408 [debug] [Thread-1 (]: Began running node test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff
[0m17:38:50.733505 [debug] [Thread-3 (]: Began executing node test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a
[0m17:38:50.738782 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"
[0m17:38:50.734239 [info ] [Thread-1 (]: 6 of 16 START test not_null_currency_exchange_baseRateEuro ..................... [RUN]
[0m17:38:50.741054 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41'
[0m17:38:50.743556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c, now test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff)
[0m17:38:50.745053 [debug] [Thread-4 (]: On test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41: Close
[0m17:38:50.746700 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff
[0m17:38:50.762771 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"
[0m17:38:50.766474 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"
[0m17:38:50.764660 [info ] [Thread-4 (]: 4 of 16 PASS accepted_values_customer_wantsNewsletter__0__1 .................... [[32mPASS[0m in 0.27s]
[0m17:38:50.768145 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a: BEGIN
[0m17:38:50.769280 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773'
[0m17:38:50.770329 [debug] [Thread-4 (]: Finished running node test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41
[0m17:38:50.771128 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:38:50.771812 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773: Close
[0m17:38:50.772588 [debug] [Thread-4 (]: Began running node test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f
[0m17:38:50.777852 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m17:38:50.778861 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"
[0m17:38:50.774610 [info ] [Thread-4 (]: 7 of 16 START test not_null_currency_exchange_currency ......................... [RUN]
[0m17:38:50.780190 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        txType as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."transaction"
    group by txType

)

select *
from all_values
where value_field not in (
    'DEPOSIT','WITHDRAWAL'
)



  
  
      
    ) dbt_internal_test
[0m17:38:50.781178 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41, now test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f)
[0m17:38:50.776609 [info ] [Thread-2 (]: 2 of 16 PASS accepted_values_customer_VIP__0__1 ................................ [[32mPASS[0m in 0.28s]
[0m17:38:50.782850 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f
[0m17:38:50.783982 [debug] [Thread-2 (]: Finished running node test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773
[0m17:38:50.791686 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"
[0m17:38:50.792824 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m17:38:50.793752 [debug] [Thread-1 (]: Began executing node test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff
[0m17:38:50.795045 [debug] [Thread-2 (]: Began running node test.raysearch_project.not_null_currency_exchange_date.f508e913b3
[0m17:38:50.801745 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"
[0m17:38:50.805729 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a: ROLLBACK
[0m17:38:50.802746 [info ] [Thread-2 (]: 8 of 16 START test not_null_currency_exchange_date ............................. [RUN]
[0m17:38:50.808447 [debug] [Thread-4 (]: Began executing node test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f
[0m17:38:50.810686 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773, now test.raysearch_project.not_null_currency_exchange_date.f508e913b3)
[0m17:38:50.815902 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"
[0m17:38:50.816945 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.not_null_currency_exchange_date.f508e913b3
[0m17:38:50.818362 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"
[0m17:38:50.825602 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"
[0m17:38:50.827133 [debug] [Thread-1 (]: On test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff: BEGIN
[0m17:38:50.828882 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a'
[0m17:38:50.830364 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"
[0m17:38:50.831262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:50.832120 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a: Close
[0m17:38:50.832911 [debug] [Thread-4 (]: On test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f: BEGIN
[0m17:38:50.834278 [debug] [Thread-2 (]: Began executing node test.raysearch_project.not_null_currency_exchange_date.f508e913b3
[0m17:38:50.835117 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:38:50.836768 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:38:50.836112 [info ] [Thread-3 (]: 5 of 16 PASS accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL ........... [[32mPASS[0m in 0.13s]
[0m17:38:50.842243 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"
[0m17:38:50.843729 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"
[0m17:38:50.845842 [debug] [Thread-3 (]: Finished running node test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a
[0m17:38:50.846891 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m17:38:50.847669 [debug] [Thread-1 (]: On test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select baseRateEuro
from "warehouse"."main_raw"."currency_exchange"
where baseRateEuro is null



  
  
      
    ) dbt_internal_test
[0m17:38:50.848616 [debug] [Thread-3 (]: Began running node test.raysearch_project.not_null_customer_customerID.cdb9e51021
[0m17:38:50.849322 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"
[0m17:38:50.851449 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"
[0m17:38:50.852146 [debug] [Thread-4 (]: On test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from "warehouse"."main_raw"."currency_exchange"
where currency is null



  
  
      
    ) dbt_internal_test
[0m17:38:50.850679 [info ] [Thread-3 (]: 9 of 16 START test not_null_customer_customerID ................................ [RUN]
[0m17:38:50.853572 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:38:50.854226 [debug] [Thread-2 (]: On test.raysearch_project.not_null_currency_exchange_date.f508e913b3: BEGIN
[0m17:38:50.855688 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a, now test.raysearch_project.not_null_customer_customerID.cdb9e51021)
[0m17:38:50.859069 [debug] [Thread-1 (]: On test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff: ROLLBACK
[0m17:38:50.860045 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:38:50.860996 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m17:38:50.862540 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.not_null_customer_customerID.cdb9e51021
[0m17:38:50.867418 [debug] [Thread-4 (]: On test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f: ROLLBACK
[0m17:38:50.868195 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:38:50.877675 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.not_null_customer_customerID.cdb9e51021"
[0m17:38:50.880041 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"
[0m17:38:50.882080 [debug] [Thread-2 (]: On test.raysearch_project.not_null_currency_exchange_date.f508e913b3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_raw"."currency_exchange"
where date is null



  
  
      
    ) dbt_internal_test
[0m17:38:50.883949 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff'
[0m17:38:50.885013 [debug] [Thread-1 (]: On test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff: Close
[0m17:38:50.887078 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:38:50.888048 [debug] [Thread-3 (]: Began executing node test.raysearch_project.not_null_customer_customerID.cdb9e51021
[0m17:38:50.886443 [info ] [Thread-1 (]: 6 of 16 PASS not_null_currency_exchange_baseRateEuro ........................... [[32mPASS[0m in 0.14s]
[0m17:38:50.901820 [debug] [Thread-2 (]: On test.raysearch_project.not_null_currency_exchange_date.f508e913b3: ROLLBACK
[0m17:38:50.904548 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.not_null_customer_customerID.cdb9e51021"
[0m17:38:50.905957 [debug] [Thread-1 (]: Finished running node test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff
[0m17:38:50.907235 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f'
[0m17:38:50.909789 [debug] [Thread-1 (]: Began running node test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b
[0m17:38:50.911254 [debug] [Thread-4 (]: On test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f: Close
[0m17:38:50.913175 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.not_null_currency_exchange_date.f508e913b3'
[0m17:38:50.915202 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_customer_customerID.cdb9e51021"
[0m17:38:50.915929 [debug] [Thread-2 (]: On test.raysearch_project.not_null_currency_exchange_date.f508e913b3: Close
[0m17:38:50.914015 [info ] [Thread-1 (]: 10 of 16 START test not_null_customer_latestUpdate ............................. [RUN]
[0m17:38:50.917666 [debug] [Thread-3 (]: On test.raysearch_project.not_null_customer_customerID.cdb9e51021: BEGIN
[0m17:38:50.918553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff, now test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b)
[0m17:38:50.916917 [info ] [Thread-4 (]: 7 of 16 PASS not_null_currency_exchange_currency ............................... [[32mPASS[0m in 0.14s]
[0m17:38:50.920545 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:38:50.921504 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b
[0m17:38:50.919706 [info ] [Thread-2 (]: 8 of 16 PASS not_null_currency_exchange_date ................................... [[32mPASS[0m in 0.11s]
[0m17:38:50.922586 [debug] [Thread-4 (]: Finished running node test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f
[0m17:38:50.933342 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"
[0m17:38:50.934475 [debug] [Thread-2 (]: Finished running node test.raysearch_project.not_null_currency_exchange_date.f508e913b3
[0m17:38:50.935159 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m17:38:50.935905 [debug] [Thread-4 (]: Began running node test.raysearch_project.not_null_transaction_amount.8ca6f973e6
[0m17:38:50.937144 [debug] [Thread-2 (]: Began running node test.raysearch_project.not_null_transaction_customerId.63105569e2
[0m17:38:50.938135 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_customer_customerID.cdb9e51021"
[0m17:38:50.941117 [debug] [Thread-3 (]: On test.raysearch_project.not_null_customer_customerID.cdb9e51021: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_customer_customerID.cdb9e51021"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customerID
from "warehouse"."main_raw"."customer"
where customerID is null



  
  
      
    ) dbt_internal_test
[0m17:38:50.939021 [info ] [Thread-4 (]: 11 of 16 START test not_null_transaction_amount ................................ [RUN]
[0m17:38:50.943205 [debug] [Thread-1 (]: Began executing node test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b
[0m17:38:50.944465 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f, now test.raysearch_project.not_null_transaction_amount.8ca6f973e6)
[0m17:38:50.949702 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"
[0m17:38:50.950510 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m17:38:50.939814 [info ] [Thread-2 (]: 12 of 16 START test not_null_transaction_customerId ............................ [RUN]
[0m17:38:50.951507 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.not_null_transaction_amount.8ca6f973e6
[0m17:38:50.954876 [debug] [Thread-3 (]: On test.raysearch_project.not_null_customer_customerID.cdb9e51021: ROLLBACK
[0m17:38:50.955801 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_currency_exchange_date.f508e913b3, now test.raysearch_project.not_null_transaction_customerId.63105569e2)
[0m17:38:50.966416 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"
[0m17:38:50.967961 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"
[0m17:38:50.968717 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.not_null_transaction_customerId.63105569e2
[0m17:38:50.970103 [debug] [Thread-1 (]: On test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b: BEGIN
[0m17:38:50.979277 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.not_null_transaction_customerId.63105569e2"
[0m17:38:50.980574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:50.982386 [debug] [Thread-4 (]: Began executing node test.raysearch_project.not_null_transaction_amount.8ca6f973e6
[0m17:38:50.988194 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"
[0m17:38:50.989810 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.not_null_customer_customerID.cdb9e51021'
[0m17:38:50.991102 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m17:38:50.992041 [debug] [Thread-2 (]: Began executing node test.raysearch_project.not_null_transaction_customerId.63105569e2
[0m17:38:50.993024 [debug] [Thread-3 (]: On test.raysearch_project.not_null_customer_customerID.cdb9e51021: Close
[0m17:38:50.994461 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"
[0m17:38:50.998649 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.not_null_transaction_customerId.63105569e2"
[0m17:38:50.999654 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"
[0m17:38:51.000464 [debug] [Thread-1 (]: On test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latestUpdate
from "warehouse"."main_raw"."customer"
where latestUpdate is null



  
  
      
    ) dbt_internal_test
[0m17:38:51.002356 [debug] [Thread-4 (]: On test.raysearch_project.not_null_transaction_amount.8ca6f973e6: BEGIN
[0m17:38:51.001498 [info ] [Thread-3 (]: 9 of 16 PASS not_null_customer_customerID ...................................... [[32mPASS[0m in 0.15s]
[0m17:38:51.004117 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:38:51.005467 [debug] [Thread-3 (]: Finished running node test.raysearch_project.not_null_customer_customerID.cdb9e51021
[0m17:38:51.006797 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_customerId.63105569e2"
[0m17:38:51.007728 [debug] [Thread-3 (]: Began running node test.raysearch_project.not_null_transaction_date.8d1d66da2c
[0m17:38:51.008679 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:38:51.010821 [debug] [Thread-2 (]: On test.raysearch_project.not_null_transaction_customerId.63105569e2: BEGIN
[0m17:38:51.012391 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:38:51.013157 [info ] [Thread-3 (]: 13 of 16 START test not_null_transaction_date .................................. [RUN]
[0m17:38:51.016383 [debug] [Thread-1 (]: On test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b: ROLLBACK
[0m17:38:51.017091 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:38:51.017823 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"
[0m17:38:51.018640 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_customer_customerID.cdb9e51021, now test.raysearch_project.not_null_transaction_date.8d1d66da2c)
[0m17:38:51.020703 [debug] [Thread-4 (]: On test.raysearch_project.not_null_transaction_amount.8ca6f973e6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "warehouse"."main_raw"."transaction"
where amount is null



  
  
      
    ) dbt_internal_test
[0m17:38:51.021675 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:38:51.022695 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.not_null_transaction_date.8d1d66da2c
[0m17:38:51.024297 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_customerId.63105569e2"
[0m17:38:51.033606 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.not_null_transaction_date.8d1d66da2c"
[0m17:38:51.034928 [debug] [Thread-2 (]: On test.raysearch_project.not_null_transaction_customerId.63105569e2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_transaction_customerId.63105569e2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customerId
from "warehouse"."main_raw"."transaction"
where customerId is null



  
  
      
    ) dbt_internal_test
[0m17:38:51.035722 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m17:38:51.037939 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b'
[0m17:38:51.039156 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:38:51.042243 [debug] [Thread-4 (]: On test.raysearch_project.not_null_transaction_amount.8ca6f973e6: ROLLBACK
[0m17:38:51.043125 [debug] [Thread-1 (]: On test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b: Close
[0m17:38:51.044035 [debug] [Thread-3 (]: Began executing node test.raysearch_project.not_null_transaction_date.8d1d66da2c
[0m17:38:51.048785 [debug] [Thread-2 (]: On test.raysearch_project.not_null_transaction_customerId.63105569e2: ROLLBACK
[0m17:38:51.050749 [info ] [Thread-1 (]: 10 of 16 PASS not_null_customer_latestUpdate ................................... [[32mPASS[0m in 0.13s]
[0m17:38:51.057345 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.not_null_transaction_date.8d1d66da2c"
[0m17:38:51.059538 [debug] [Thread-1 (]: Finished running node test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b
[0m17:38:51.061122 [debug] [Thread-1 (]: Began running node test.raysearch_project.not_null_transaction_txCurrency.7798fc4041
[0m17:38:51.062476 [info ] [Thread-1 (]: 14 of 16 START test not_null_transaction_txCurrency ............................ [RUN]
[0m17:38:51.064380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b, now test.raysearch_project.not_null_transaction_txCurrency.7798fc4041)
[0m17:38:51.065335 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.not_null_transaction_txCurrency.7798fc4041
[0m17:38:51.072585 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"
[0m17:38:51.074868 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.not_null_transaction_amount.8ca6f973e6'
[0m17:38:51.076071 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_date.8d1d66da2c"
[0m17:38:51.077659 [debug] [Thread-4 (]: On test.raysearch_project.not_null_transaction_amount.8ca6f973e6: Close
[0m17:38:51.078787 [debug] [Thread-3 (]: On test.raysearch_project.not_null_transaction_date.8d1d66da2c: BEGIN
[0m17:38:51.079898 [debug] [Thread-1 (]: Began executing node test.raysearch_project.not_null_transaction_txCurrency.7798fc4041
[0m17:38:51.080951 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:38:51.087690 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"
[0m17:38:51.082551 [info ] [Thread-4 (]: 11 of 16 PASS not_null_transaction_amount ...................................... [[32mPASS[0m in 0.14s]
[0m17:38:51.089279 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.not_null_transaction_customerId.63105569e2'
[0m17:38:51.091289 [debug] [Thread-4 (]: Finished running node test.raysearch_project.not_null_transaction_amount.8ca6f973e6
[0m17:38:51.092454 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m17:38:51.093869 [debug] [Thread-2 (]: On test.raysearch_project.not_null_transaction_customerId.63105569e2: Close
[0m17:38:51.095734 [debug] [Thread-4 (]: Began running node test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8
[0m17:38:51.097102 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_date.8d1d66da2c"
[0m17:38:51.100210 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"
[0m17:38:51.098707 [info ] [Thread-2 (]: 12 of 16 PASS not_null_transaction_customerId .................................. [[32mPASS[0m in 0.14s]
[0m17:38:51.101177 [debug] [Thread-3 (]: On test.raysearch_project.not_null_transaction_date.8d1d66da2c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_transaction_date.8d1d66da2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_raw"."transaction"
where date is null



  
  
      
    ) dbt_internal_test
[0m17:38:51.102086 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_txCurrency.7798fc4041: BEGIN
[0m17:38:51.103200 [debug] [Thread-2 (]: Finished running node test.raysearch_project.not_null_transaction_customerId.63105569e2
[0m17:38:51.099465 [info ] [Thread-4 (]: 15 of 16 START test relationships_transaction_customerId__customerID__ref_customer_  [RUN]
[0m17:38:51.104559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:51.105424 [debug] [Thread-2 (]: Began running node test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506
[0m17:38:51.106322 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_transaction_amount.8ca6f973e6, now test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8)
[0m17:38:51.106975 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:38:51.109980 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:38:51.108245 [info ] [Thread-2 (]: 16 of 16 START test relationships_transaction_txCurrency__currency__ref_currency_exchange_  [RUN]
[0m17:38:51.109253 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8
[0m17:38:51.113228 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"
[0m17:38:51.114477 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_transaction_customerId.63105569e2, now test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506)
[0m17:38:51.117092 [debug] [Thread-3 (]: On test.raysearch_project.not_null_transaction_date.8d1d66da2c: ROLLBACK
[0m17:38:51.134874 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"
[0m17:38:51.135833 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_txCurrency.7798fc4041: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txCurrency
from "warehouse"."main_raw"."transaction"
where txCurrency is null



  
  
      
    ) dbt_internal_test
[0m17:38:51.136764 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506
[0m17:38:51.149697 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506"
[0m17:38:51.151712 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:38:51.152771 [debug] [Thread-4 (]: Began executing node test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8
[0m17:38:51.154060 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.not_null_transaction_date.8d1d66da2c'
[0m17:38:51.157167 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_txCurrency.7798fc4041: ROLLBACK
[0m17:38:51.162930 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"
[0m17:38:51.163905 [debug] [Thread-3 (]: On test.raysearch_project.not_null_transaction_date.8d1d66da2c: Close
[0m17:38:51.164784 [debug] [Thread-2 (]: Began executing node test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506
[0m17:38:51.170523 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506"
[0m17:38:51.166864 [info ] [Thread-3 (]: 13 of 16 PASS not_null_transaction_date ........................................ [[32mPASS[0m in 0.15s]
[0m17:38:51.172755 [debug] [Thread-3 (]: Finished running node test.raysearch_project.not_null_transaction_date.8d1d66da2c
[0m17:38:51.174418 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"
[0m17:38:51.175496 [debug] [Thread-4 (]: On test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8: BEGIN
[0m17:38:51.176287 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:38:51.177977 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.not_null_transaction_txCurrency.7798fc4041'
[0m17:38:51.178654 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_txCurrency.7798fc4041: Close
[0m17:38:51.180615 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:38:51.179973 [info ] [Thread-1 (]: 14 of 16 PASS not_null_transaction_txCurrency .................................. [[32mPASS[0m in 0.12s]
[0m17:38:51.181797 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"
[0m17:38:51.183200 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506"
[0m17:38:51.184874 [debug] [Thread-1 (]: Finished running node test.raysearch_project.not_null_transaction_txCurrency.7798fc4041
[0m17:38:51.186181 [debug] [Thread-4 (]: On test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customerId as from_field
    from "warehouse"."main_raw"."transaction"
    where customerId is not null
),

parent as (
    select customerID as to_field
    from "warehouse"."main_raw"."customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:38:51.187179 [debug] [Thread-2 (]: On test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506: BEGIN
[0m17:38:51.189189 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:38:51.191386 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:38:51.192503 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506"
[0m17:38:51.193581 [debug] [Thread-2 (]: On test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select txCurrency as from_field
    from "warehouse"."main_raw"."transaction"
    where txCurrency is not null
),

parent as (
    select currency as to_field
    from "warehouse"."main_raw"."currency_exchange"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:38:51.196909 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:38:51.200391 [debug] [Thread-4 (]: On test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8: ROLLBACK
[0m17:38:51.202769 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8'
[0m17:38:51.203722 [debug] [Thread-4 (]: On test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8: Close
[0m17:38:51.204911 [info ] [Thread-4 (]: 15 of 16 PASS relationships_transaction_customerId__customerID__ref_customer_ .. [[32mPASS[0m in 0.10s]
[0m17:38:51.206356 [debug] [Thread-4 (]: Finished running node test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8
[0m17:38:51.238985 [debug] [Thread-2 (]: SQL status: OK in 0.044 seconds
[0m17:38:51.243214 [debug] [Thread-2 (]: On test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506: ROLLBACK
[0m17:38:51.246071 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506'
[0m17:38:51.246845 [debug] [Thread-2 (]: On test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506: Close
[0m17:38:51.247971 [info ] [Thread-2 (]: 16 of 16 PASS relationships_transaction_txCurrency__currency__ref_currency_exchange_  [[32mPASS[0m in 0.13s]
[0m17:38:51.249547 [debug] [Thread-2 (]: Finished running node test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506
[0m17:38:51.252558 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:51.253269 [debug] [MainThread]: On master: BEGIN
[0m17:38:51.253784 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:38:51.255019 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:38:51.255608 [debug] [MainThread]: On master: COMMIT
[0m17:38:51.256079 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:51.256493 [debug] [MainThread]: On master: COMMIT
[0m17:38:51.257621 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:38:51.258404 [debug] [MainThread]: On master: Close
[0m17:38:51.259127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:51.259596 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m17:38:51.260079 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m17:38:51.260513 [debug] [MainThread]: Connection 'test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506' was properly closed.
[0m17:38:51.260952 [debug] [MainThread]: Connection 'test.raysearch_project.not_null_transaction_txCurrency.7798fc4041' was properly closed.
[0m17:38:51.261378 [debug] [MainThread]: Connection 'test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8' was properly closed.
[0m17:38:51.261799 [debug] [MainThread]: Connection 'test.raysearch_project.not_null_transaction_date.8d1d66da2c' was properly closed.
[0m17:38:51.262402 [info ] [MainThread]: 
[0m17:38:51.263357 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 1.40 seconds (1.40s).
[0m17:38:51.269765 [debug] [MainThread]: Command end result
[0m17:38:51.317229 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m17:38:51.324329 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m17:38:51.338492 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m17:38:51.339416 [info ] [MainThread]: 
[0m17:38:51.341413 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:51.342942 [info ] [MainThread]: 
[0m17:38:51.344037 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=16
[0m17:38:51.346078 [debug] [MainThread]: Command `dbt test` succeeded at 17:38:51.345790 after 3.86 seconds
[0m17:38:51.346908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D680B5B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6825ABE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6825AB490>]}
[0m17:38:51.347635 [debug] [MainThread]: Flushing usage events
[0m17:38:52.667842 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:03.089825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241EE4B4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241EF5E7ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241EF5E79D0>]}


============================== 18:04:03.113274 | a99eb927-6aeb-47b0-b892-5db2798bb73b ==============================
[0m18:04:03.113274 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:04:03.115034 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt snapshot --select customer_snapshot', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m18:04:04.410820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a99eb927-6aeb-47b0-b892-5db2798bb73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241EE926060>]}
[0m18:04:04.556376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a99eb927-6aeb-47b0-b892-5db2798bb73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241EF65E7A0>]}
[0m18:04:04.638163 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:04:05.690310 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:04:05.974250 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:04:05.975607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a99eb927-6aeb-47b0-b892-5db2798bb73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241F0ABE050>]}
[0m18:04:14.636443 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on 'customer' in
package 'raysearch_project' (seeds\seeds.yml). Arguments to generic tests should
be nested under the `arguments` property.
[0m18:04:14.638254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a99eb927-6aeb-47b0-b892-5db2798bb73b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241F0CCB980>]}
[0m18:04:14.923856 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.transformation
- models.raysearch_project.marts
[0m18:04:14.933847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a99eb927-6aeb-47b0-b892-5db2798bb73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241F0DD7E70>]}
[0m18:04:15.118859 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m18:04:15.197246 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m18:04:15.311473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a99eb927-6aeb-47b0-b892-5db2798bb73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241F0B2B040>]}
[0m18:04:15.312632 [info ] [MainThread]: Found 3 models, 1 snapshot, 3 seeds, 16 data tests, 472 macros
[0m18:04:15.314189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a99eb927-6aeb-47b0-b892-5db2798bb73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241F108D550>]}
[0m18:04:15.318296 [info ] [MainThread]: 
[0m18:04:15.319587 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:04:15.320788 [info ] [MainThread]: 
[0m18:04:15.322601 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:04:15.325395 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m18:04:30.251286 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m18:04:30.252787 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m18:04:30.253652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:30.811791 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m18:04:30.813478 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:04:30.818580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:30.819699 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m18:04:30.820950 [info ] [MainThread]: 
[0m18:04:30.822301 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 15.50 seconds (15.50s).
[0m18:04:30.824329 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "c:\users\amandaka\workspaces\raysearch_project\warehouse.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Users\AMANDAKA\AppData\Local\DBeaver\dbeaver.exe (PID 40932)
[0m18:04:30.826589 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:04:30.829749 [debug] [MainThread]: Command `dbt snapshot` failed at 18:04:30.829329 after 28.33 seconds
[0m18:04:30.830972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241F0FE64C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241F13E00F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241F13E0050>]}
[0m18:04:30.832431 [debug] [MainThread]: Flushing usage events
[0m18:04:32.571434 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:07:05.127697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB9584830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBA6BFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBA6BF9D0>]}


============================== 18:07:05.139424 | e8247866-420d-44fe-9c6d-6a28718680d0 ==============================
[0m18:07:05.139424 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:07:05.142245 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt snapshot --select customer_snapshot', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m18:07:05.609810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8247866-420d-44fe-9c6d-6a28718680d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB99F6060>]}
[0m18:07:05.737804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8247866-420d-44fe-9c6d-6a28718680d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBB7027A0>]}
[0m18:07:05.745816 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:07:06.213003 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:07:06.631755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:07:06.632560 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:07:06.633000 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:07:06.645331 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.raysearch_project.transformation
- models.raysearch_project.marts
[0m18:07:06.749839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8247866-420d-44fe-9c6d-6a28718680d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBBC4E050>]}
[0m18:07:06.915705 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m18:07:06.922904 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m18:07:07.017199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8247866-420d-44fe-9c6d-6a28718680d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBBC794F0>]}
[0m18:07:07.018566 [info ] [MainThread]: Found 3 models, 1 snapshot, 3 seeds, 16 data tests, 472 macros
[0m18:07:07.020149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8247866-420d-44fe-9c6d-6a28718680d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBBDD3CB0>]}
[0m18:07:07.024916 [info ] [MainThread]: 
[0m18:07:07.026116 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:07:07.027333 [info ] [MainThread]: 
[0m18:07:07.029361 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:07:07.032880 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m18:07:07.400919 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m18:07:07.402079 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m18:07:07.402918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:07.496916 [debug] [ThreadPool]: SQL status: OK in 0.094 seconds
[0m18:07:07.499611 [debug] [ThreadPool]: On list_warehouse: Close
[0m18:07:07.501951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_trf)
[0m18:07:07.503198 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "trf"
"
[0m18:07:07.516231 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_trf"
[0m18:07:07.517059 [debug] [ThreadPool]: On create_warehouse_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_trf"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m18:07:07.517569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:07.519755 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:07:07.522087 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_trf"
[0m18:07:07.522707 [debug] [ThreadPool]: On create_warehouse_trf: BEGIN
[0m18:07:07.524173 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:07:07.525204 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_trf"
[0m18:07:07.525822 [debug] [ThreadPool]: On create_warehouse_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_trf"} */

    
    
        create schema if not exists "warehouse"."trf"
    
[0m18:07:07.527100 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:07:07.528828 [debug] [ThreadPool]: On create_warehouse_trf: COMMIT
[0m18:07:07.529445 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_trf"
[0m18:07:07.530166 [debug] [ThreadPool]: On create_warehouse_trf: COMMIT
[0m18:07:07.543436 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m18:07:07.544314 [debug] [ThreadPool]: On create_warehouse_trf: Close
[0m18:07:07.557644 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m18:07:07.571774 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m18:07:07.572831 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m18:07:07.573850 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m18:07:07.575457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:07.579785 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m18:07:07.580873 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_trf'
[0m18:07:07.582363 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m18:07:07.585332 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_trf"
[0m18:07:07.585851 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:07:07.586540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:07.587173 [debug] [ThreadPool]: On list_warehouse_trf: BEGIN
[0m18:07:07.588436 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m18:07:07.589516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:07.590138 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m18:07:07.590737 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:07:07.592522 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:07:07.593763 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m18:07:07.594749 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_trf"
[0m18:07:07.595723 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m18:07:07.596920 [debug] [ThreadPool]: On list_warehouse_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_trf"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'trf'
    and lower(table_catalog) = 'warehouse'
  
[0m18:07:07.622821 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m18:07:07.624315 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m18:07:07.626933 [debug] [ThreadPool]: On list_warehouse_trf: ROLLBACK
[0m18:07:07.627746 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m18:07:07.630125 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m18:07:07.633435 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m18:07:07.696719 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m18:07:07.698264 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m18:07:07.702325 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m18:07:07.703263 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m18:07:07.706573 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_trf'
[0m18:07:07.710026 [debug] [ThreadPool]: On list_warehouse_trf: Close
[0m18:07:07.712560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8247866-420d-44fe-9c6d-6a28718680d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBBE23790>]}
[0m18:07:07.713626 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:07.714227 [debug] [MainThread]: On master: BEGIN
[0m18:07:07.714719 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:07.716150 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:07:07.716747 [debug] [MainThread]: On master: COMMIT
[0m18:07:07.717248 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:07.717763 [debug] [MainThread]: On master: COMMIT
[0m18:07:07.719015 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:07:07.719866 [debug] [MainThread]: On master: Close
[0m18:07:07.735565 [debug] [Thread-1 (]: Began running node snapshot.raysearch_project.customer_snapshot
[0m18:07:07.736935 [info ] [Thread-1 (]: 1 of 1 START snapshot trf.customer_snapshot .................................... [RUN]
[0m18:07:07.738746 [debug] [Thread-1 (]: Acquiring new duckdb connection 'snapshot.raysearch_project.customer_snapshot'
[0m18:07:07.740274 [debug] [Thread-1 (]: Began compiling node snapshot.raysearch_project.customer_snapshot
[0m18:07:07.754850 [debug] [Thread-1 (]: Began executing node snapshot.raysearch_project.customer_snapshot
[0m18:07:07.875122 [debug] [Thread-1 (]: Using duckdb connection "snapshot.raysearch_project.customer_snapshot"
[0m18:07:07.876151 [debug] [Thread-1 (]: On snapshot.raysearch_project.customer_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "snapshot.raysearch_project.customer_snapshot"} */
DESCRIBE (select * from (
        
    

    select *,
        md5(coalesce(cast(customerID as varchar ), '')
         || '|' || coalesce(cast(latest_update_ts as varchar ), '')
        ) as dbt_scd_id,
        latest_update_ts as dbt_updated_at,
        latest_update_ts as dbt_valid_from,
        
  
  coalesce(nullif(latest_update_ts, latest_update_ts), null)
  as dbt_valid_to
from (
        


select
  customerID as customerID,
  country as country,
  state as state,
  VIP as VIP,
  KYC as KYC,
  wantsNewsletter as wantsNewsletter,
  -- parse latestUpdate to a TIMESTAMP used by timestamp strategy
  try_strptime(cast(latestUpdate as varchar), '%m/%d/%Y') as latest_update_ts
from "warehouse"."main_raw"."customer"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:07:07.876771 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:07:07.882243 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:07:07.894209 [debug] [Thread-1 (]: Using duckdb connection "snapshot.raysearch_project.customer_snapshot"
[0m18:07:07.895960 [debug] [Thread-1 (]: On snapshot.raysearch_project.customer_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "snapshot.raysearch_project.customer_snapshot"} */
DESCRIBE (select * from (
        select now()::timestamp as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
)
[0m18:07:07.898388 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:07:07.899647 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.raysearch_project.customer_snapshot"
[0m18:07:07.903517 [debug] [Thread-1 (]: Using duckdb connection "snapshot.raysearch_project.customer_snapshot"
[0m18:07:07.904432 [debug] [Thread-1 (]: On snapshot.raysearch_project.customer_snapshot: BEGIN
[0m18:07:07.905815 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:07:07.907244 [debug] [Thread-1 (]: Using duckdb connection "snapshot.raysearch_project.customer_snapshot"
[0m18:07:07.907984 [debug] [Thread-1 (]: On snapshot.raysearch_project.customer_snapshot: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "snapshot.raysearch_project.customer_snapshot"} */

      
  
    
    

    create  table
      "warehouse"."trf"."customer_snapshot"
  
    as (
      
    

    select *,
        md5(coalesce(cast(customerID as varchar ), '')
         || '|' || coalesce(cast(latest_update_ts as varchar ), '')
        ) as dbt_scd_id,
        latest_update_ts as dbt_updated_at,
        latest_update_ts as dbt_valid_from,
        
  
  coalesce(nullif(latest_update_ts, latest_update_ts), null)
  as dbt_valid_to
from (
        


select
  customerID as customerID,
  country as country,
  state as state,
  VIP as VIP,
  KYC as KYC,
  wantsNewsletter as wantsNewsletter,
  -- parse latestUpdate to a TIMESTAMP used by timestamp strategy
  try_strptime(cast(latestUpdate as varchar), '%m/%d/%Y') as latest_update_ts
from "warehouse"."main_raw"."customer"

    ) sbq



    );
  
  
  
[0m18:07:07.913207 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:07:07.938199 [debug] [Thread-1 (]: On snapshot.raysearch_project.customer_snapshot: COMMIT
[0m18:07:07.939117 [debug] [Thread-1 (]: Using duckdb connection "snapshot.raysearch_project.customer_snapshot"
[0m18:07:07.939874 [debug] [Thread-1 (]: On snapshot.raysearch_project.customer_snapshot: COMMIT
[0m18:07:07.943965 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:07:07.947522 [debug] [Thread-1 (]: On snapshot.raysearch_project.customer_snapshot: Close
[0m18:07:07.952261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8247866-420d-44fe-9c6d-6a28718680d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBC190B90>]}
[0m18:07:07.953930 [info ] [Thread-1 (]: 1 of 1 OK snapshotted trf.customer_snapshot .................................... [[32mOK[0m in 0.21s]
[0m18:07:07.955549 [debug] [Thread-1 (]: Finished running node snapshot.raysearch_project.customer_snapshot
[0m18:07:07.958908 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:07.959603 [debug] [MainThread]: On master: BEGIN
[0m18:07:07.960098 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:07:07.961317 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:07:07.961840 [debug] [MainThread]: On master: COMMIT
[0m18:07:07.962315 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:07.962726 [debug] [MainThread]: On master: COMMIT
[0m18:07:07.963570 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:07:07.964131 [debug] [MainThread]: On master: Close
[0m18:07:07.965388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:07.966480 [debug] [MainThread]: Connection 'create_warehouse_trf' was properly closed.
[0m18:07:07.967130 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m18:07:07.967527 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m18:07:07.968068 [debug] [MainThread]: Connection 'list_warehouse_trf' was properly closed.
[0m18:07:07.968801 [debug] [MainThread]: Connection 'snapshot.raysearch_project.customer_snapshot' was properly closed.
[0m18:07:07.969419 [info ] [MainThread]: 
[0m18:07:07.970717 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m18:07:07.973261 [debug] [MainThread]: Command end result
[0m18:07:08.017067 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m18:07:08.023596 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m18:07:08.035591 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m18:07:08.036354 [info ] [MainThread]: 
[0m18:07:08.037607 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:07:08.038626 [info ] [MainThread]: 
[0m18:07:08.039854 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:07:08.042422 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:07:08.042089 after 3.26 seconds
[0m18:07:08.043525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBBE7B3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBC117430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBC1177F0>]}
[0m18:07:08.044962 [debug] [MainThread]: Flushing usage events
[0m18:07:10.125503 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:27:10.760918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE795C4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7A6FFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7A6FF9D0>]}


============================== 18:27:10.775459 | 36311659-bebd-4dbb-8f27-b54df1cff788 ==============================
[0m18:27:10.775459 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:27:10.777380 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select trf_customer_scd2', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m18:27:11.258578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36311659-bebd-4dbb-8f27-b54df1cff788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE79A36060>]}
[0m18:27:11.400106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36311659-bebd-4dbb-8f27-b54df1cff788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7B7427A0>]}
[0m18:27:11.408428 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:27:11.877876 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:27:12.331616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:27:12.333103 [debug] [MainThread]: Partial parsing: added file: raysearch_project://models\transformation\trf_customer_scd2.sql
[0m18:27:12.333980 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://snapshots\customer_snapshot.sql
[0m18:27:13.294444 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.raysearch_project.marts
[0m18:27:13.307376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36311659-bebd-4dbb-8f27-b54df1cff788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7BC1EB50>]}
[0m18:27:13.488034 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m18:27:13.494511 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m18:27:13.560230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36311659-bebd-4dbb-8f27-b54df1cff788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7BC494F0>]}
[0m18:27:13.561242 [info ] [MainThread]: Found 4 models, 3 seeds, 16 data tests, 1 snapshot, 472 macros
[0m18:27:13.562434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36311659-bebd-4dbb-8f27-b54df1cff788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7BFF0590>]}
[0m18:27:13.566644 [info ] [MainThread]: 
[0m18:27:13.567916 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:27:13.569985 [info ] [MainThread]: 
[0m18:27:13.571724 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:27:13.574083 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m18:27:13.833016 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m18:27:13.834089 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m18:27:13.834877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:13.874127 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m18:27:13.876662 [debug] [ThreadPool]: On list_warehouse: Close
[0m18:27:13.878366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_trf)
[0m18:27:13.879392 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_trf"
"
[0m18:27:13.890244 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m18:27:13.891095 [debug] [ThreadPool]: On create_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_trf"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m18:27:13.891654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:13.893821 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:27:13.896541 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m18:27:13.897197 [debug] [ThreadPool]: On create_warehouse_main_trf: BEGIN
[0m18:27:13.898466 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:27:13.899161 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m18:27:13.899766 [debug] [ThreadPool]: On create_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_trf"} */

    
    
        create schema if not exists "warehouse"."main_trf"
    
[0m18:27:13.901102 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:27:13.902654 [debug] [ThreadPool]: On create_warehouse_main_trf: COMMIT
[0m18:27:13.903188 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m18:27:13.903620 [debug] [ThreadPool]: On create_warehouse_main_trf: COMMIT
[0m18:27:13.917105 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m18:27:13.918030 [debug] [ThreadPool]: On create_warehouse_main_trf: Close
[0m18:27:13.928309 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_trf'
[0m18:27:13.936775 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m18:27:13.942000 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m18:27:13.945194 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m18:27:13.946053 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m18:27:13.947070 [debug] [ThreadPool]: On list_warehouse_main_trf: BEGIN
[0m18:27:13.947811 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m18:27:13.950506 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m18:27:13.951154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:13.951771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:13.952325 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m18:27:13.953632 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:27:13.954763 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:27:13.955361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:13.956021 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m18:27:13.956643 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m18:27:13.957563 [debug] [ThreadPool]: On list_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_trf"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_trf'
    and lower(table_catalog) = 'warehouse'
  
[0m18:27:13.958215 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m18:27:13.958758 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:27:13.960165 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m18:27:13.960842 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m18:27:13.983654 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m18:27:13.986662 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m18:27:13.987302 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m18:27:13.987934 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m18:27:13.990512 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m18:27:13.992313 [debug] [ThreadPool]: On list_warehouse_main_trf: ROLLBACK
[0m18:27:13.994970 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m18:27:13.995641 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m18:27:13.999863 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_trf'
[0m18:27:14.000570 [debug] [ThreadPool]: On list_warehouse_main_trf: Close
[0m18:27:14.002025 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m18:27:14.002574 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m18:27:14.004965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36311659-bebd-4dbb-8f27-b54df1cff788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7BF5B1E0>]}
[0m18:27:14.005824 [debug] [MainThread]: Using duckdb connection "master"
[0m18:27:14.006290 [debug] [MainThread]: On master: BEGIN
[0m18:27:14.006739 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:14.008009 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:27:14.008533 [debug] [MainThread]: On master: COMMIT
[0m18:27:14.008981 [debug] [MainThread]: Using duckdb connection "master"
[0m18:27:14.009387 [debug] [MainThread]: On master: COMMIT
[0m18:27:14.010201 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:27:14.010679 [debug] [MainThread]: On master: Close
[0m18:27:14.024201 [debug] [Thread-1 (]: Began running node model.raysearch_project.trf_customer_scd2
[0m18:27:14.025377 [info ] [Thread-1 (]: 1 of 1 START sql table model main_trf.trf_customer_scd2 ........................ [RUN]
[0m18:27:14.026761 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.raysearch_project.trf_customer_scd2'
[0m18:27:14.027409 [debug] [Thread-1 (]: Began compiling node model.raysearch_project.trf_customer_scd2
[0m18:27:14.041464 [debug] [Thread-1 (]: Writing injected SQL for node "model.raysearch_project.trf_customer_scd2"
[0m18:27:14.057435 [debug] [Thread-1 (]: Began executing node model.raysearch_project.trf_customer_scd2
[0m18:27:14.119928 [debug] [Thread-1 (]: Writing runtime sql for node "model.raysearch_project.trf_customer_scd2"
[0m18:27:14.124076 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_customer_scd2"
[0m18:27:14.124910 [debug] [Thread-1 (]: On model.raysearch_project.trf_customer_scd2: BEGIN
[0m18:27:14.125486 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:27:14.127292 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:27:14.128020 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_customer_scd2"
[0m18:27:14.128632 [debug] [Thread-1 (]: On model.raysearch_project.trf_customer_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_customer_scd2"} */

  
    
    

    create  table
      "warehouse"."main_trf"."trf_customer_scd2__dbt_tmp"
  
    as (
      -- SCD Type 2 using window functions over stg_customer

with src as (
    select
        customer_id,
        country_code,
        customer_state,
        is_vip,
        is_kyc,
        wants_newsletter,
        latest_update_date
    from "warehouse"."main_stg"."stg_customer"
),
-- eliminate duplicates per (customer_id, latest_update_date), keep a single record
unique_per_day as (
    select *
    from (
        select
            *,
            row_number() over (
                partition by customer_id, latest_update_date
                order by latest_update_date desc
            ) as rn
        from src
    ) t
    where rn = 1
),
scd2 as (
    select
        customer_id,
        country_code,
        customer_state,
        is_vip,
        is_kyc,
        wants_newsletter,
        latest_update_date as etl_valid_from,
        lead(latest_update_date) over (
            partition by customer_id
            order by latest_update_date
        ) as next_change_date
    from unique_per_day
)
select
    customer_id,
    country_code,
    customer_state,
    is_vip,
    is_kyc,
    wants_newsletter,
    etl_valid_from,
    case
        when next_change_date is not null then (next_change_date - interval 1 day)::date
        else null
    end as etl_valid_to,
    case when next_change_date is null then true else false end as is_current
from scd2
    );
  
  
[0m18:27:14.158785 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m18:27:14.171088 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_customer_scd2"
[0m18:27:14.171985 [debug] [Thread-1 (]: On model.raysearch_project.trf_customer_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_customer_scd2"} */
alter table "warehouse"."main_trf"."trf_customer_scd2__dbt_tmp" rename to "trf_customer_scd2"
[0m18:27:14.173859 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:27:14.197754 [debug] [Thread-1 (]: On model.raysearch_project.trf_customer_scd2: COMMIT
[0m18:27:14.198583 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_customer_scd2"
[0m18:27:14.199173 [debug] [Thread-1 (]: On model.raysearch_project.trf_customer_scd2: COMMIT
[0m18:27:14.206112 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:27:14.217598 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_customer_scd2"
[0m18:27:14.218641 [debug] [Thread-1 (]: On model.raysearch_project.trf_customer_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_customer_scd2"} */

      drop table if exists "warehouse"."main_trf"."trf_customer_scd2__dbt_backup" cascade
    
[0m18:27:14.220487 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:27:14.224684 [debug] [Thread-1 (]: On model.raysearch_project.trf_customer_scd2: Close
[0m18:27:14.229038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36311659-bebd-4dbb-8f27-b54df1cff788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7C201A90>]}
[0m18:27:14.230523 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_trf.trf_customer_scd2 ................... [[32mOK[0m in 0.20s]
[0m18:27:14.232387 [debug] [Thread-1 (]: Finished running node model.raysearch_project.trf_customer_scd2
[0m18:27:14.235414 [debug] [MainThread]: Using duckdb connection "master"
[0m18:27:14.236039 [debug] [MainThread]: On master: BEGIN
[0m18:27:14.236511 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:27:14.237772 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:27:14.238321 [debug] [MainThread]: On master: COMMIT
[0m18:27:14.238773 [debug] [MainThread]: Using duckdb connection "master"
[0m18:27:14.239184 [debug] [MainThread]: On master: COMMIT
[0m18:27:14.240038 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:27:14.241040 [debug] [MainThread]: On master: Close
[0m18:27:14.242220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:14.242718 [debug] [MainThread]: Connection 'create_warehouse_main_trf' was properly closed.
[0m18:27:14.243101 [debug] [MainThread]: Connection 'list_warehouse_main_trf' was properly closed.
[0m18:27:14.243449 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m18:27:14.243796 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m18:27:14.244139 [debug] [MainThread]: Connection 'model.raysearch_project.trf_customer_scd2' was properly closed.
[0m18:27:14.244833 [info ] [MainThread]: 
[0m18:27:14.245734 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m18:27:14.248512 [debug] [MainThread]: Command end result
[0m18:27:14.298818 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m18:27:14.305414 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m18:27:14.321641 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m18:27:14.322469 [info ] [MainThread]: 
[0m18:27:14.323762 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:27:14.324730 [info ] [MainThread]: 
[0m18:27:14.325638 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:27:14.327246 [debug] [MainThread]: Command `dbt run` succeeded at 18:27:14.327034 after 3.91 seconds
[0m18:27:14.327941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7BF47E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7C383E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7C3832F0>]}
[0m18:27:14.328566 [debug] [MainThread]: Flushing usage events
[0m18:27:15.738588 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:43:01.567099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B37954830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B38A8FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B38A8F9D0>]}


============================== 18:43:01.581226 | 0426308e-eb89-4509-940e-f46b2f049917 ==============================
[0m18:43:01.581226 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:43:01.582986 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt test', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m18:43:02.072579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0426308e-eb89-4509-940e-f46b2f049917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B37DC6060>]}
[0m18:43:02.209176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0426308e-eb89-4509-940e-f46b2f049917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B39AD29C0>]}
[0m18:43:02.215898 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:43:02.677752 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:43:02.967552 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:43:02.969053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0426308e-eb89-4509-940e-f46b2f049917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B39F62150>]}
[0m18:43:05.837381 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on 'customer' in
package 'raysearch_project' (seeds\seeds.yml). Arguments to generic tests should
be nested under the `arguments` property.
[0m18:43:05.839141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0426308e-eb89-4509-940e-f46b2f049917', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B3A1FB2F0>]}
[0m18:43:06.231825 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.raysearch_project.marts
[0m18:43:06.244376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0426308e-eb89-4509-940e-f46b2f049917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B3A57C3D0>]}
[0m18:43:06.452082 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m18:43:06.459548 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m18:43:06.590681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0426308e-eb89-4509-940e-f46b2f049917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B3A6F36C0>]}
[0m18:43:06.591846 [info ] [MainThread]: Found 5 models, 1 snapshot, 20 data tests, 3 seeds, 472 macros
[0m18:43:06.593133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0426308e-eb89-4509-940e-f46b2f049917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B3A699250>]}
[0m18:43:06.600264 [info ] [MainThread]: 
[0m18:43:06.601658 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:43:06.603631 [info ] [MainThread]: 
[0m18:43:06.606034 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:43:06.619281 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m18:43:06.629694 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m18:43:06.647447 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_trf'
[0m18:43:06.912720 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m18:43:06.913698 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m18:43:06.914410 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m18:43:06.914994 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m18:43:06.915621 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m18:43:06.916439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:06.917157 [debug] [ThreadPool]: On list_warehouse_main_trf: BEGIN
[0m18:43:06.917711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:06.918455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:07.345916 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m18:43:07.347141 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:43:07.744275 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m18:43:07.745298 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:43:08.096238 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m18:43:08.097008 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:43:08.100288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:08.101004 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m18:43:08.101434 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m18:43:08.101805 [debug] [MainThread]: Connection 'list_warehouse_main_trf' was properly closed.
[0m18:43:08.102381 [info ] [MainThread]: 
[0m18:43:08.103544 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.50 seconds (1.50s).
[0m18:43:08.104896 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "c:\users\amandaka\workspaces\raysearch_project\warehouse.duckdb": The process cannot access the file because it is being used by another process.
  
  File is already open in 
  C:\Users\AMANDAKA\AppData\Local\DBeaver\dbeaver.exe (PID 40932)
[0m18:43:08.106592 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:43:08.108681 [debug] [MainThread]: Command `dbt test` failed at 18:43:08.108415 after 6.99 seconds
[0m18:43:08.109530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B3A6AAA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B3AAC4FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B3AAC5090>]}
[0m18:43:08.110300 [debug] [MainThread]: Flushing usage events
[0m18:43:09.549316 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:43:21.820278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D836674830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D8377AFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D8377AF9D0>]}


============================== 18:43:21.835490 | 6f1c9720-7225-413d-98ed-4a1f6e325813 ==============================
[0m18:43:21.835490 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:43:21.837317 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt test', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m18:43:22.330201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f1c9720-7225-413d-98ed-4a1f6e325813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D836AE6060>]}
[0m18:43:22.454693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f1c9720-7225-413d-98ed-4a1f6e325813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D8387F29C0>]}
[0m18:43:22.462814 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:43:22.941987 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:43:23.400052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:43:23.400866 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:43:23.401322 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:43:23.412562 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.raysearch_project.marts
[0m18:43:23.539966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f1c9720-7225-413d-98ed-4a1f6e325813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D838CD5550>]}
[0m18:43:23.736893 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m18:43:23.744968 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m18:43:23.980147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f1c9720-7225-413d-98ed-4a1f6e325813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D8335835C0>]}
[0m18:43:23.981321 [info ] [MainThread]: Found 5 models, 1 snapshot, 20 data tests, 3 seeds, 472 macros
[0m18:43:23.982627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f1c9720-7225-413d-98ed-4a1f6e325813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D838A95B70>]}
[0m18:43:23.988886 [info ] [MainThread]: 
[0m18:43:23.991519 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:43:23.993495 [info ] [MainThread]: 
[0m18:43:23.995663 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:43:24.011380 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m18:43:24.018744 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_trf'
[0m18:43:24.055428 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m18:43:24.291272 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m18:43:24.292193 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m18:43:24.292918 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m18:43:24.293837 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m18:43:24.294454 [debug] [ThreadPool]: On list_warehouse_main_trf: BEGIN
[0m18:43:24.295122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:24.295662 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m18:43:24.296240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:24.296944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:24.334569 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m18:43:24.335954 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m18:43:24.336736 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m18:43:24.337496 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m18:43:24.338200 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m18:43:24.339429 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m18:43:24.340151 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m18:43:24.341080 [debug] [ThreadPool]: On list_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_trf"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_trf'
    and lower(table_catalog) = 'warehouse'
  
[0m18:43:24.341998 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m18:43:24.369111 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m18:43:24.370094 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m18:43:24.371001 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m18:43:24.373285 [debug] [ThreadPool]: On list_warehouse_main_trf: ROLLBACK
[0m18:43:24.375439 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m18:43:24.377646 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m18:43:24.383213 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_trf'
[0m18:43:24.384091 [debug] [ThreadPool]: On list_warehouse_main_trf: Close
[0m18:43:24.386561 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m18:43:24.387296 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m18:43:24.389554 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m18:43:24.390121 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m18:43:24.392123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f1c9720-7225-413d-98ed-4a1f6e325813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D838F8B450>]}
[0m18:43:24.392961 [debug] [MainThread]: Using duckdb connection "master"
[0m18:43:24.393483 [debug] [MainThread]: On master: BEGIN
[0m18:43:24.393951 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:43:24.395229 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:43:24.395759 [debug] [MainThread]: On master: COMMIT
[0m18:43:24.396189 [debug] [MainThread]: Using duckdb connection "master"
[0m18:43:24.396575 [debug] [MainThread]: On master: COMMIT
[0m18:43:24.397371 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:43:24.397875 [debug] [MainThread]: On master: Close
[0m18:43:24.407354 [debug] [Thread-1 (]: Began running node test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c
[0m18:43:24.408256 [debug] [Thread-2 (]: Began running node test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773
[0m18:43:24.408951 [debug] [Thread-4 (]: Began running node test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41
[0m18:43:24.409712 [debug] [Thread-3 (]: Began running node test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb
[0m18:43:24.410554 [info ] [Thread-1 (]: 1 of 20 START test accepted_values_customer_KYC__0__1 .......................... [RUN]
[0m18:43:24.411181 [info ] [Thread-2 (]: 2 of 20 START test accepted_values_customer_VIP__0__1 .......................... [RUN]
[0m18:43:24.413462 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c'
[0m18:43:24.414366 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773'
[0m18:43:24.411900 [info ] [Thread-4 (]: 4 of 20 START test accepted_values_customer_wantsNewsletter__0__1 .............. [RUN]
[0m18:43:24.415456 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c
[0m18:43:24.416233 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773
[0m18:43:24.412432 [info ] [Thread-3 (]: 3 of 20 START test accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE . [RUN]
[0m18:43:24.417539 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41'
[0m18:43:24.463628 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"
[0m18:43:24.465338 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"
[0m18:43:24.467623 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb'
[0m18:43:24.469305 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41
[0m18:43:24.471364 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb
[0m18:43:24.478410 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"
[0m18:43:24.492367 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"
[0m18:43:24.494120 [debug] [Thread-2 (]: Began executing node test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773
[0m18:43:24.495119 [debug] [Thread-1 (]: Began executing node test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c
[0m18:43:24.506450 [debug] [Thread-4 (]: Began executing node test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41
[0m18:43:24.539162 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"
[0m18:43:24.551518 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"
[0m18:43:24.555702 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"
[0m18:43:24.556770 [debug] [Thread-3 (]: Began executing node test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb
[0m18:43:24.561786 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"
[0m18:43:24.563682 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"
[0m18:43:24.564364 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773: BEGIN
[0m18:43:24.564901 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:43:24.566282 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"
[0m18:43:24.567166 [debug] [Thread-4 (]: On test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41: BEGIN
[0m18:43:24.568478 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"
[0m18:43:24.569113 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:43:24.569880 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m18:43:24.570501 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c: BEGIN
[0m18:43:24.571579 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"
[0m18:43:24.572286 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"
[0m18:43:24.572995 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m18:43:24.573624 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:43:24.574233 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        VIP as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."customer"
    group by VIP

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  
      
    ) dbt_internal_test
[0m18:43:24.574866 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb: BEGIN
[0m18:43:24.575482 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"
[0m18:43:24.577018 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:43:24.577587 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:43:24.578301 [debug] [Thread-4 (]: On test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        wantsNewsletter as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."customer"
    group by wantsNewsletter

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  
      
    ) dbt_internal_test
[0m18:43:24.579396 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"
[0m18:43:24.580120 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:43:24.580693 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m18:43:24.581666 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        KYC as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."customer"
    group by KYC

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  
      
    ) dbt_internal_test
[0m18:43:24.582325 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"
[0m18:43:24.589415 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773: ROLLBACK
[0m18:43:24.590732 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m18:43:24.591521 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."customer"
    group by state

)

select *
from all_values
where value_field not in (
    'VALIDATED','SIGNUP','INACTIVE'
)



  
  
      
    ) dbt_internal_test
[0m18:43:24.593173 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:43:24.596119 [debug] [Thread-4 (]: On test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41: ROLLBACK
[0m18:43:24.597527 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773'
[0m18:43:24.600936 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c: ROLLBACK
[0m18:43:24.602051 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m18:43:24.602678 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773: Close
[0m18:43:24.604712 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41'
[0m18:43:24.607241 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb: ROLLBACK
[0m18:43:24.608230 [debug] [Thread-4 (]: On test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41: Close
[0m18:43:24.609292 [info ] [Thread-2 (]: 2 of 20 PASS accepted_values_customer_VIP__0__1 ................................ [[32mPASS[0m in 0.19s]
[0m18:43:24.611044 [debug] [Thread-2 (]: Finished running node test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773
[0m18:43:24.612743 [debug] [Thread-2 (]: Began running node test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a
[0m18:43:24.612010 [info ] [Thread-4 (]: 4 of 20 PASS accepted_values_customer_wantsNewsletter__0__1 .................... [[32mPASS[0m in 0.19s]
[0m18:43:24.613759 [info ] [Thread-2 (]: 5 of 20 START test accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL ..... [RUN]
[0m18:43:24.616022 [debug] [Thread-4 (]: Finished running node test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41
[0m18:43:24.615133 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c'
[0m18:43:24.619349 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb'
[0m18:43:24.620862 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773, now test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a)
[0m18:43:24.622045 [debug] [Thread-4 (]: Began running node test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff
[0m18:43:24.623054 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c: Close
[0m18:43:24.624031 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb: Close
[0m18:43:24.625282 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a
[0m18:43:24.626087 [info ] [Thread-4 (]: 6 of 20 START test not_null_currency_exchange_baseRateEuro ..................... [RUN]
[0m18:43:24.641636 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41, now test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff)
[0m18:43:24.627671 [info ] [Thread-3 (]: 3 of 20 PASS accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE ....... [[32mPASS[0m in 0.16s]
[0m18:43:24.639401 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"
[0m18:43:24.643660 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff
[0m18:43:24.644953 [debug] [Thread-3 (]: Finished running node test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb
[0m18:43:24.628499 [info ] [Thread-1 (]: 1 of 20 PASS accepted_values_customer_KYC__0__1 ................................ [[32mPASS[0m in 0.22s]
[0m18:43:24.661916 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"
[0m18:43:24.662949 [debug] [Thread-3 (]: Began running node test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f
[0m18:43:24.664169 [debug] [Thread-1 (]: Finished running node test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c
[0m18:43:24.667150 [debug] [Thread-1 (]: Began running node test.raysearch_project.not_null_currency_exchange_date.f508e913b3
[0m18:43:24.670937 [debug] [Thread-2 (]: Began executing node test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a
[0m18:43:24.666343 [info ] [Thread-3 (]: 7 of 20 START test not_null_currency_exchange_currency ......................... [RUN]
[0m18:43:24.676879 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"
[0m18:43:24.678011 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb, now test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f)
[0m18:43:24.679024 [debug] [Thread-4 (]: Began executing node test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff
[0m18:43:24.669843 [info ] [Thread-1 (]: 8 of 20 START test not_null_currency_exchange_date ............................. [RUN]
[0m18:43:24.680743 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f
[0m18:43:24.686451 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"
[0m18:43:24.687493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c, now test.raysearch_project.not_null_currency_exchange_date.f508e913b3)
[0m18:43:24.695381 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"
[0m18:43:24.697600 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"
[0m18:43:24.696590 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.not_null_currency_exchange_date.f508e913b3
[0m18:43:24.699042 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a: BEGIN
[0m18:43:24.707989 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"
[0m18:43:24.708985 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:43:24.709839 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"
[0m18:43:24.711736 [debug] [Thread-4 (]: On test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff: BEGIN
[0m18:43:24.712736 [debug] [Thread-3 (]: Began executing node test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f
[0m18:43:24.713901 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:43:24.714605 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m18:43:24.716771 [debug] [Thread-1 (]: Began executing node test.raysearch_project.not_null_currency_exchange_date.f508e913b3
[0m18:43:24.722333 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"
[0m18:43:24.724141 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"
[0m18:43:24.728596 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"
[0m18:43:24.729344 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m18:43:24.730447 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        txType as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."transaction"
    group by txType

)

select *
from all_values
where value_field not in (
    'DEPOSIT','WITHDRAWAL'
)



  
  
      
    ) dbt_internal_test
[0m18:43:24.732079 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"
[0m18:43:24.733411 [debug] [Thread-4 (]: On test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select baseRateEuro
from "warehouse"."main_raw"."currency_exchange"
where baseRateEuro is null



  
  
      
    ) dbt_internal_test
[0m18:43:24.735208 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"
[0m18:43:24.736022 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:43:24.736654 [debug] [Thread-3 (]: On test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f: BEGIN
[0m18:43:24.740110 [debug] [Thread-4 (]: On test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff: ROLLBACK
[0m18:43:24.740945 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"
[0m18:43:24.741613 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m18:43:24.742281 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:43:24.743334 [debug] [Thread-1 (]: On test.raysearch_project.not_null_currency_exchange_date.f508e913b3: BEGIN
[0m18:43:24.746128 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a: ROLLBACK
[0m18:43:24.747366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:24.748229 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m18:43:24.749737 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff'
[0m18:43:24.751485 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"
[0m18:43:24.752250 [debug] [Thread-4 (]: On test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff: Close
[0m18:43:24.752886 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:43:24.753488 [debug] [Thread-3 (]: On test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from "warehouse"."main_raw"."currency_exchange"
where currency is null



  
  
      
    ) dbt_internal_test
[0m18:43:24.755325 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a'
[0m18:43:24.756608 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"
[0m18:43:24.756011 [info ] [Thread-4 (]: 6 of 20 PASS not_null_currency_exchange_baseRateEuro ........................... [[32mPASS[0m in 0.11s]
[0m18:43:24.757849 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a: Close
[0m18:43:24.758551 [debug] [Thread-1 (]: On test.raysearch_project.not_null_currency_exchange_date.f508e913b3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_raw"."currency_exchange"
where date is null



  
  
      
    ) dbt_internal_test
[0m18:43:24.759574 [debug] [Thread-4 (]: Finished running node test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff
[0m18:43:24.760237 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:43:24.761240 [info ] [Thread-2 (]: 5 of 20 PASS accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL ........... [[32mPASS[0m in 0.14s]
[0m18:43:24.762737 [debug] [Thread-4 (]: Began running node test.raysearch_project.not_null_customer_customerID.cdb9e51021
[0m18:43:24.766185 [debug] [Thread-3 (]: On test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f: ROLLBACK
[0m18:43:24.766960 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:43:24.768084 [debug] [Thread-2 (]: Finished running node test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a
[0m18:43:24.769031 [info ] [Thread-4 (]: 9 of 20 START test not_null_customer_customerID ................................ [RUN]
[0m18:43:24.771679 [debug] [Thread-2 (]: Began running node test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b
[0m18:43:24.774329 [debug] [Thread-1 (]: On test.raysearch_project.not_null_currency_exchange_date.f508e913b3: ROLLBACK
[0m18:43:24.775269 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff, now test.raysearch_project.not_null_customer_customerID.cdb9e51021)
[0m18:43:24.776182 [info ] [Thread-2 (]: 10 of 20 START test not_null_customer_latestUpdate ............................. [RUN]
[0m18:43:24.777310 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.not_null_customer_customerID.cdb9e51021
[0m18:43:24.778279 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a, now test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b)
[0m18:43:24.787150 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.not_null_customer_customerID.cdb9e51021"
[0m18:43:24.788717 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b
[0m18:43:24.797097 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f'
[0m18:43:24.798864 [debug] [Thread-3 (]: On test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f: Close
[0m18:43:24.801036 [debug] [Thread-4 (]: Began executing node test.raysearch_project.not_null_customer_customerID.cdb9e51021
[0m18:43:24.802545 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"
[0m18:43:24.808421 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.not_null_customer_customerID.cdb9e51021"
[0m18:43:24.804490 [info ] [Thread-3 (]: 7 of 20 PASS not_null_currency_exchange_currency ............................... [[32mPASS[0m in 0.13s]
[0m18:43:24.810736 [debug] [Thread-3 (]: Finished running node test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f
[0m18:43:24.811832 [debug] [Thread-3 (]: Began running node test.raysearch_project.not_null_transaction_amount.8ca6f973e6
[0m18:43:24.813589 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_customer_customerID.cdb9e51021"
[0m18:43:24.814571 [debug] [Thread-2 (]: Began executing node test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b
[0m18:43:24.812604 [info ] [Thread-3 (]: 11 of 20 START test not_null_transaction_amount ................................ [RUN]
[0m18:43:24.816543 [debug] [Thread-4 (]: On test.raysearch_project.not_null_customer_customerID.cdb9e51021: BEGIN
[0m18:43:24.822154 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"
[0m18:43:24.823450 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f, now test.raysearch_project.not_null_transaction_amount.8ca6f973e6)
[0m18:43:24.824590 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.not_null_currency_exchange_date.f508e913b3'
[0m18:43:24.825324 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:43:24.826442 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.not_null_transaction_amount.8ca6f973e6
[0m18:43:24.827193 [debug] [Thread-1 (]: On test.raysearch_project.not_null_currency_exchange_date.f508e913b3: Close
[0m18:43:24.845548 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m18:43:24.847850 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"
[0m18:43:24.849062 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_customer_customerID.cdb9e51021"
[0m18:43:24.850678 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"
[0m18:43:24.846996 [info ] [Thread-1 (]: 8 of 20 PASS not_null_currency_exchange_date ................................... [[32mPASS[0m in 0.16s]
[0m18:43:24.852274 [debug] [Thread-2 (]: On test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b: BEGIN
[0m18:43:24.853743 [debug] [Thread-4 (]: On test.raysearch_project.not_null_customer_customerID.cdb9e51021: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_customer_customerID.cdb9e51021"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customerID
from "warehouse"."main_raw"."customer"
where customerID is null



  
  
      
    ) dbt_internal_test
[0m18:43:24.855143 [debug] [Thread-1 (]: Finished running node test.raysearch_project.not_null_currency_exchange_date.f508e913b3
[0m18:43:24.855853 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:43:24.857222 [debug] [Thread-1 (]: Began running node test.raysearch_project.not_null_transaction_customerId.63105569e2
[0m18:43:24.859632 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:43:24.861819 [debug] [Thread-3 (]: Began executing node test.raysearch_project.not_null_transaction_amount.8ca6f973e6
[0m18:43:24.864244 [debug] [Thread-4 (]: On test.raysearch_project.not_null_customer_customerID.cdb9e51021: ROLLBACK
[0m18:43:24.858902 [info ] [Thread-1 (]: 12 of 20 START test not_null_transaction_customerId ............................ [RUN]
[0m18:43:24.865773 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m18:43:24.871515 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"
[0m18:43:24.872745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_currency_exchange_date.f508e913b3, now test.raysearch_project.not_null_transaction_customerId.63105569e2)
[0m18:43:24.873622 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"
[0m18:43:24.874656 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.not_null_transaction_customerId.63105569e2
[0m18:43:24.875949 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.not_null_customer_customerID.cdb9e51021'
[0m18:43:24.877332 [debug] [Thread-2 (]: On test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latestUpdate
from "warehouse"."main_raw"."customer"
where latestUpdate is null



  
  
      
    ) dbt_internal_test
[0m18:43:24.886390 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"
[0m18:43:24.887522 [debug] [Thread-4 (]: On test.raysearch_project.not_null_customer_customerID.cdb9e51021: Close
[0m18:43:24.890720 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.not_null_transaction_customerId.63105569e2"
[0m18:43:24.892170 [debug] [Thread-3 (]: On test.raysearch_project.not_null_transaction_amount.8ca6f973e6: BEGIN
[0m18:43:24.893371 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m18:43:24.894618 [info ] [Thread-4 (]: 9 of 20 PASS not_null_customer_customerID ...................................... [[32mPASS[0m in 0.12s]
[0m18:43:24.896380 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:43:24.897975 [debug] [Thread-4 (]: Finished running node test.raysearch_project.not_null_customer_customerID.cdb9e51021
[0m18:43:24.902331 [debug] [Thread-2 (]: On test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b: ROLLBACK
[0m18:43:24.904767 [debug] [Thread-4 (]: Began running node test.raysearch_project.not_null_transaction_date.8d1d66da2c
[0m18:43:24.906323 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m18:43:24.907327 [debug] [Thread-1 (]: Began executing node test.raysearch_project.not_null_transaction_customerId.63105569e2
[0m18:43:24.908782 [info ] [Thread-4 (]: 13 of 20 START test not_null_transaction_date .................................. [RUN]
[0m18:43:24.910416 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"
[0m18:43:24.915424 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.not_null_transaction_customerId.63105569e2"
[0m18:43:24.917452 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b'
[0m18:43:24.918874 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_customer_customerID.cdb9e51021, now test.raysearch_project.not_null_transaction_date.8d1d66da2c)
[0m18:43:24.920459 [debug] [Thread-3 (]: On test.raysearch_project.not_null_transaction_amount.8ca6f973e6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "warehouse"."main_raw"."transaction"
where amount is null



  
  
      
    ) dbt_internal_test
[0m18:43:24.922253 [debug] [Thread-2 (]: On test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b: Close
[0m18:43:24.923503 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.not_null_transaction_date.8d1d66da2c
[0m18:43:24.925998 [info ] [Thread-2 (]: 10 of 20 PASS not_null_customer_latestUpdate ................................... [[32mPASS[0m in 0.15s]
[0m18:43:24.936186 [debug] [Thread-2 (]: Finished running node test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b
[0m18:43:24.937687 [debug] [Thread-2 (]: Began running node test.raysearch_project.not_null_transaction_txCurrency.7798fc4041
[0m18:43:24.938675 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_customerId.63105569e2"
[0m18:43:24.939863 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.not_null_transaction_date.8d1d66da2c"
[0m18:43:24.940747 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m18:43:24.942152 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_customerId.63105569e2: BEGIN
[0m18:43:24.941449 [info ] [Thread-2 (]: 14 of 20 START test not_null_transaction_txCurrency ............................ [RUN]
[0m18:43:24.946250 [debug] [Thread-3 (]: On test.raysearch_project.not_null_transaction_amount.8ca6f973e6: ROLLBACK
[0m18:43:24.947200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:24.948731 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b, now test.raysearch_project.not_null_transaction_txCurrency.7798fc4041)
[0m18:43:24.949823 [debug] [Thread-4 (]: Began executing node test.raysearch_project.not_null_transaction_date.8d1d66da2c
[0m18:43:24.952283 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.not_null_transaction_txCurrency.7798fc4041
[0m18:43:24.957210 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.not_null_transaction_date.8d1d66da2c"
[0m18:43:24.958381 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.not_null_transaction_amount.8ca6f973e6'
[0m18:43:24.959172 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m18:43:24.967412 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"
[0m18:43:24.969065 [debug] [Thread-3 (]: On test.raysearch_project.not_null_transaction_amount.8ca6f973e6: Close
[0m18:43:24.970379 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_customerId.63105569e2"
[0m18:43:24.972597 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_date.8d1d66da2c"
[0m18:43:24.974693 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_customerId.63105569e2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_transaction_customerId.63105569e2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customerId
from "warehouse"."main_raw"."transaction"
where customerId is null



  
  
      
    ) dbt_internal_test
[0m18:43:24.973891 [info ] [Thread-3 (]: 11 of 20 PASS not_null_transaction_amount ...................................... [[32mPASS[0m in 0.15s]
[0m18:43:24.976262 [debug] [Thread-4 (]: On test.raysearch_project.not_null_transaction_date.8d1d66da2c: BEGIN
[0m18:43:24.977840 [debug] [Thread-2 (]: Began executing node test.raysearch_project.not_null_transaction_txCurrency.7798fc4041
[0m18:43:24.979140 [debug] [Thread-3 (]: Finished running node test.raysearch_project.not_null_transaction_amount.8ca6f973e6
[0m18:43:24.979952 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:43:24.987022 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"
[0m18:43:24.987967 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m18:43:24.988923 [debug] [Thread-3 (]: Began running node test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb
[0m18:43:24.993271 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_customerId.63105569e2: ROLLBACK
[0m18:43:24.994298 [info ] [Thread-3 (]: 15 of 20 START test not_null_trf_customer_scd2_customer_id ..................... [RUN]
[0m18:43:24.995834 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_transaction_amount.8ca6f973e6, now test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb)
[0m18:43:24.996893 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"
[0m18:43:24.997831 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m18:43:24.998681 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb
[0m18:43:25.000456 [debug] [Thread-2 (]: On test.raysearch_project.not_null_transaction_txCurrency.7798fc4041: BEGIN
[0m18:43:25.001969 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_date.8d1d66da2c"
[0m18:43:25.008248 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.not_null_transaction_customerId.63105569e2'
[0m18:43:25.012291 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb"
[0m18:43:25.013409 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:43:25.014417 [debug] [Thread-4 (]: On test.raysearch_project.not_null_transaction_date.8d1d66da2c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_transaction_date.8d1d66da2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_raw"."transaction"
where date is null



  
  
      
    ) dbt_internal_test
[0m18:43:25.016547 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_customerId.63105569e2: Close
[0m18:43:25.018913 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m18:43:25.020310 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:43:25.022958 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"
[0m18:43:25.022024 [info ] [Thread-1 (]: 12 of 20 PASS not_null_transaction_customerId .................................. [[32mPASS[0m in 0.15s]
[0m18:43:25.027024 [debug] [Thread-4 (]: On test.raysearch_project.not_null_transaction_date.8d1d66da2c: ROLLBACK
[0m18:43:25.027914 [debug] [Thread-3 (]: Began executing node test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb
[0m18:43:25.028644 [debug] [Thread-2 (]: On test.raysearch_project.not_null_transaction_txCurrency.7798fc4041: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txCurrency
from "warehouse"."main_raw"."transaction"
where txCurrency is null



  
  
      
    ) dbt_internal_test
[0m18:43:25.029672 [debug] [Thread-1 (]: Finished running node test.raysearch_project.not_null_transaction_customerId.63105569e2
[0m18:43:25.034925 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb"
[0m18:43:25.037540 [debug] [Thread-1 (]: Began running node test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94
[0m18:43:25.038865 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:43:25.040610 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.not_null_transaction_date.8d1d66da2c'
[0m18:43:25.041810 [info ] [Thread-1 (]: 16 of 20 START test not_null_trf_customer_scd2_etl_valid_from .................. [RUN]
[0m18:43:25.046226 [debug] [Thread-2 (]: On test.raysearch_project.not_null_transaction_txCurrency.7798fc4041: ROLLBACK
[0m18:43:25.047279 [debug] [Thread-4 (]: On test.raysearch_project.not_null_transaction_date.8d1d66da2c: Close
[0m18:43:25.049271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_transaction_customerId.63105569e2, now test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94)
[0m18:43:25.053416 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94
[0m18:43:25.052097 [info ] [Thread-4 (]: 13 of 20 PASS not_null_transaction_date ........................................ [[32mPASS[0m in 0.13s]
[0m18:43:25.056796 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb"
[0m18:43:25.063181 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94"
[0m18:43:25.064409 [debug] [Thread-4 (]: Finished running node test.raysearch_project.not_null_transaction_date.8d1d66da2c
[0m18:43:25.065817 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb: BEGIN
[0m18:43:25.067641 [debug] [Thread-4 (]: Began running node test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595
[0m18:43:25.069679 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.not_null_transaction_txCurrency.7798fc4041'
[0m18:43:25.070857 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:43:25.072346 [debug] [Thread-2 (]: On test.raysearch_project.not_null_transaction_txCurrency.7798fc4041: Close
[0m18:43:25.071684 [info ] [Thread-4 (]: 17 of 20 START test not_null_trf_customer_scd2_is_current ...................... [RUN]
[0m18:43:25.075016 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_transaction_date.8d1d66da2c, now test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595)
[0m18:43:25.074271 [info ] [Thread-2 (]: 14 of 20 PASS not_null_transaction_txCurrency .................................. [[32mPASS[0m in 0.13s]
[0m18:43:25.075966 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595
[0m18:43:25.076629 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m18:43:25.077484 [debug] [Thread-2 (]: Finished running node test.raysearch_project.not_null_transaction_txCurrency.7798fc4041
[0m18:43:25.087537 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595"
[0m18:43:25.088492 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb"
[0m18:43:25.089613 [debug] [Thread-2 (]: Began running node test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8
[0m18:43:25.090913 [debug] [Thread-1 (]: Began executing node test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94
[0m18:43:25.091685 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "warehouse"."main_trf"."trf_customer_scd2"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m18:43:25.097464 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94"
[0m18:43:25.092525 [info ] [Thread-2 (]: 18 of 20 START test relationships_transaction_customerId__customerID__ref_customer_  [RUN]
[0m18:43:25.100843 [debug] [Thread-4 (]: Began executing node test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595
[0m18:43:25.102429 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_transaction_txCurrency.7798fc4041, now test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8)
[0m18:43:25.103697 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m18:43:25.108363 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595"
[0m18:43:25.109582 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8
[0m18:43:25.110547 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94"
[0m18:43:25.113225 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb: ROLLBACK
[0m18:43:25.132538 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"
[0m18:43:25.133835 [debug] [Thread-1 (]: On test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94: BEGIN
[0m18:43:25.136514 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595"
[0m18:43:25.137779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:25.138836 [debug] [Thread-4 (]: On test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595: BEGIN
[0m18:43:25.140330 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:43:25.141395 [debug] [Thread-2 (]: Began executing node test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8
[0m18:43:25.145992 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"
[0m18:43:25.146952 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:43:25.148075 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m18:43:25.149079 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94"
[0m18:43:25.150704 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb'
[0m18:43:25.152233 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595"
[0m18:43:25.153322 [debug] [Thread-1 (]: On test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select etl_valid_from
from "warehouse"."main_trf"."trf_customer_scd2"
where etl_valid_from is null



  
  
      
    ) dbt_internal_test
[0m18:43:25.154278 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"
[0m18:43:25.154960 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb: Close
[0m18:43:25.155739 [debug] [Thread-4 (]: On test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_current
from "warehouse"."main_trf"."trf_customer_scd2"
where is_current is null



  
  
      
    ) dbt_internal_test
[0m18:43:25.157006 [debug] [Thread-2 (]: On test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8: BEGIN
[0m18:43:25.159518 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:43:25.158281 [info ] [Thread-3 (]: 15 of 20 PASS not_null_trf_customer_scd2_customer_id ........................... [[32mPASS[0m in 0.16s]
[0m18:43:25.160595 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:43:25.161227 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:43:25.163865 [debug] [Thread-1 (]: On test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94: ROLLBACK
[0m18:43:25.164914 [debug] [Thread-3 (]: Finished running node test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb
[0m18:43:25.168924 [debug] [Thread-4 (]: On test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595: ROLLBACK
[0m18:43:25.170048 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m18:43:25.170834 [debug] [Thread-3 (]: Began running node test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506
[0m18:43:25.172272 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"
[0m18:43:25.173995 [debug] [Thread-2 (]: On test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customerId as from_field
    from "warehouse"."main_raw"."transaction"
    where customerId is not null
),

parent as (
    select customerID as to_field
    from "warehouse"."main_raw"."customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m18:43:25.173127 [info ] [Thread-3 (]: 19 of 20 START test relationships_transaction_txCurrency__currency__ref_currency_exchange_  [RUN]
[0m18:43:25.176011 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb, now test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506)
[0m18:43:25.177103 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506
[0m18:43:25.189626 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94'
[0m18:43:25.193466 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506"
[0m18:43:25.194579 [debug] [Thread-1 (]: On test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94: Close
[0m18:43:25.195367 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m18:43:25.197429 [info ] [Thread-1 (]: 16 of 20 PASS not_null_trf_customer_scd2_etl_valid_from ........................ [[32mPASS[0m in 0.15s]
[0m18:43:25.199399 [debug] [Thread-1 (]: Finished running node test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94
[0m18:43:25.200661 [debug] [Thread-1 (]: Began running node test.raysearch_project.trf_customer_scd2_unique_combination
[0m18:43:25.201896 [info ] [Thread-1 (]: 20 of 20 START test trf_customer_scd2_unique_combination ....................... [RUN]
[0m18:43:25.203648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94, now test.raysearch_project.trf_customer_scd2_unique_combination)
[0m18:43:25.205048 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.trf_customer_scd2_unique_combination
[0m18:43:25.208257 [debug] [Thread-2 (]: On test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8: ROLLBACK
[0m18:43:25.209033 [debug] [Thread-3 (]: Began executing node test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506
[0m18:43:25.215268 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.trf_customer_scd2_unique_combination"
[0m18:43:25.216812 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595'
[0m18:43:25.221505 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506"
[0m18:43:25.223500 [debug] [Thread-4 (]: On test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595: Close
[0m18:43:25.227248 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8'
[0m18:43:25.225652 [info ] [Thread-4 (]: 17 of 20 PASS not_null_trf_customer_scd2_is_current ............................ [[32mPASS[0m in 0.15s]
[0m18:43:25.228326 [debug] [Thread-2 (]: On test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8: Close
[0m18:43:25.229254 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506"
[0m18:43:25.230255 [debug] [Thread-4 (]: Finished running node test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595
[0m18:43:25.231057 [debug] [Thread-3 (]: On test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506: BEGIN
[0m18:43:25.232450 [info ] [Thread-2 (]: 18 of 20 PASS relationships_transaction_customerId__customerID__ref_customer_ .. [[32mPASS[0m in 0.13s]
[0m18:43:25.234290 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:43:25.236058 [debug] [Thread-2 (]: Finished running node test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8
[0m18:43:25.238172 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m18:43:25.239054 [debug] [Thread-1 (]: Began executing node test.raysearch_project.trf_customer_scd2_unique_combination
[0m18:43:25.239743 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506"
[0m18:43:25.243579 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.trf_customer_scd2_unique_combination"
[0m18:43:25.244359 [debug] [Thread-3 (]: On test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select txCurrency as from_field
    from "warehouse"."main_raw"."transaction"
    where txCurrency is not null
),

parent as (
    select currency as to_field
    from "warehouse"."main_raw"."currency_exchange"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m18:43:25.249100 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.trf_customer_scd2_unique_combination"
[0m18:43:25.250218 [debug] [Thread-1 (]: On test.raysearch_project.trf_customer_scd2_unique_combination: BEGIN
[0m18:43:25.251573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:25.253847 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:43:25.254831 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.trf_customer_scd2_unique_combination"
[0m18:43:25.255546 [debug] [Thread-1 (]: On test.raysearch_project.trf_customer_scd2_unique_combination: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.trf_customer_scd2_unique_combination"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select customer_id, etl_valid_from, count(*) as cnt
from "warehouse"."main_trf"."trf_customer_scd2"
group by customer_id, etl_valid_from
having count(*) > 1
  
  
      
    ) dbt_internal_test
[0m18:43:25.263065 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m18:43:25.266812 [debug] [Thread-1 (]: On test.raysearch_project.trf_customer_scd2_unique_combination: ROLLBACK
[0m18:43:25.270192 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.trf_customer_scd2_unique_combination'
[0m18:43:25.271088 [debug] [Thread-1 (]: On test.raysearch_project.trf_customer_scd2_unique_combination: Close
[0m18:43:25.272290 [info ] [Thread-1 (]: 20 of 20 PASS trf_customer_scd2_unique_combination ............................. [[32mPASS[0m in 0.07s]
[0m18:43:25.273668 [debug] [Thread-1 (]: Finished running node test.raysearch_project.trf_customer_scd2_unique_combination
[0m18:43:25.292280 [debug] [Thread-3 (]: SQL status: OK in 0.047 seconds
[0m18:43:25.295382 [debug] [Thread-3 (]: On test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506: ROLLBACK
[0m18:43:25.297339 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506'
[0m18:43:25.298045 [debug] [Thread-3 (]: On test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506: Close
[0m18:43:25.299998 [info ] [Thread-3 (]: 19 of 20 PASS relationships_transaction_txCurrency__currency__ref_currency_exchange_  [[32mPASS[0m in 0.12s]
[0m18:43:25.301484 [debug] [Thread-3 (]: Finished running node test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506
[0m18:43:25.304531 [debug] [MainThread]: Using duckdb connection "master"
[0m18:43:25.305224 [debug] [MainThread]: On master: BEGIN
[0m18:43:25.305726 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:43:25.306950 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:43:25.307585 [debug] [MainThread]: On master: COMMIT
[0m18:43:25.308067 [debug] [MainThread]: Using duckdb connection "master"
[0m18:43:25.308488 [debug] [MainThread]: On master: COMMIT
[0m18:43:25.309309 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:43:25.309866 [debug] [MainThread]: On master: Close
[0m18:43:25.310581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:25.311479 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m18:43:25.312198 [debug] [MainThread]: Connection 'list_warehouse_main_trf' was properly closed.
[0m18:43:25.312898 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m18:43:25.313393 [debug] [MainThread]: Connection 'test.raysearch_project.trf_customer_scd2_unique_combination' was properly closed.
[0m18:43:25.313772 [debug] [MainThread]: Connection 'test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8' was properly closed.
[0m18:43:25.314137 [debug] [MainThread]: Connection 'test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595' was properly closed.
[0m18:43:25.314526 [debug] [MainThread]: Connection 'test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506' was properly closed.
[0m18:43:25.315439 [info ] [MainThread]: 
[0m18:43:25.316824 [info ] [MainThread]: Finished running 20 data tests in 0 hours 0 minutes and 1.32 seconds (1.32s).
[0m18:43:25.324271 [debug] [MainThread]: Command end result
[0m18:43:25.371369 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m18:43:25.377526 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m18:43:25.395699 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m18:43:25.396703 [info ] [MainThread]: 
[0m18:43:25.398275 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:43:25.399599 [info ] [MainThread]: 
[0m18:43:25.400954 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=20
[0m18:43:25.403076 [debug] [MainThread]: Command `dbt test` succeeded at 18:43:25.402809 after 3.91 seconds
[0m18:43:25.403958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D83754B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D838FBE150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D838FBEA40>]}
[0m18:43:25.404780 [debug] [MainThread]: Flushing usage events
[0m18:43:27.058880 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:10:44.457691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234065E4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340771BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340771B9D0>]}


============================== 19:10:44.472620 | d83f8ba8-08e6-40ef-98ac-252b32dc3628 ==============================
[0m19:10:44.472620 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:10:44.476100 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'invocation_command': 'dbt run --select trf_currency_exchange', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m19:10:45.681277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd83f8ba8-08e6-40ef-98ac-252b32dc3628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023406A56060>]}
[0m19:10:45.812565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd83f8ba8-08e6-40ef-98ac-252b32dc3628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234087629C0>]}
[0m19:10:45.877555 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:10:47.019839 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:10:53.442150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m19:10:53.443908 [debug] [MainThread]: Partial parsing: added file: raysearch_project://models\transformation\trf_currency_exchange.sql
[0m19:10:53.444805 [debug] [MainThread]: Partial parsing: added file: raysearch_project://models\transformation\trf_transaction.sql
[0m19:10:54.131658 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.raysearch_project.marts
[0m19:10:54.142977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd83f8ba8-08e6-40ef-98ac-252b32dc3628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023408C32D50>]}
[0m19:10:54.350595 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m19:10:54.418227 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m19:10:54.528695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd83f8ba8-08e6-40ef-98ac-252b32dc3628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023407592C60>]}
[0m19:10:54.529744 [info ] [MainThread]: Found 7 models, 1 snapshot, 20 data tests, 3 seeds, 472 macros
[0m19:10:54.531052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd83f8ba8-08e6-40ef-98ac-252b32dc3628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023408984C90>]}
[0m19:10:54.535652 [info ] [MainThread]: 
[0m19:10:54.537000 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:10:54.538122 [info ] [MainThread]: 
[0m19:10:54.539645 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:10:54.542666 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m19:11:09.744276 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m19:11:09.745592 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m19:11:09.746435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:09.961275 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m19:11:09.962800 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m19:11:09.967692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:11:09.969021 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m19:11:09.969916 [info ] [MainThread]: 
[0m19:11:09.970947 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 15.43 seconds (15.43s).
[0m19:11:09.972287 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "c:\users\amandaka\workspaces\raysearch_project\warehouse.duckdb": The process cannot access the file because it is being used by another process.
  
[0m19:11:09.976139 [debug] [MainThread]: Command `dbt run` failed at 19:11:09.975618 after 26.08 seconds
[0m19:11:09.978040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234090AA680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234074BB890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234090ECDD0>]}
[0m19:11:09.979329 [debug] [MainThread]: Flushing usage events
[0m19:11:11.770317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:11:20.466553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017205964830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017206A9FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017206A9F9D0>]}


============================== 19:11:20.480901 | 0490dd4c-88e7-4003-8f6f-1e0a6432ce22 ==============================
[0m19:11:20.480901 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:11:20.482826 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'invocation_command': 'dbt run --select trf_currency_exchange', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m19:11:21.022463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0490dd4c-88e7-4003-8f6f-1e0a6432ce22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017205DD6060>]}
[0m19:11:21.153366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0490dd4c-88e7-4003-8f6f-1e0a6432ce22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017207AE29C0>]}
[0m19:11:21.160439 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:11:21.620247 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:11:22.079394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:11:22.080294 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:11:22.080799 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:11:22.092783 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.raysearch_project.marts
[0m19:11:22.218526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0490dd4c-88e7-4003-8f6f-1e0a6432ce22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017208061550>]}
[0m19:11:22.422259 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m19:11:22.430736 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m19:11:22.520518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0490dd4c-88e7-4003-8f6f-1e0a6432ce22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017206912C60>]}
[0m19:11:22.522190 [info ] [MainThread]: Found 7 models, 1 snapshot, 20 data tests, 3 seeds, 472 macros
[0m19:11:22.524139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0490dd4c-88e7-4003-8f6f-1e0a6432ce22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172081F3930>]}
[0m19:11:22.527914 [info ] [MainThread]: 
[0m19:11:22.529323 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:11:22.530622 [info ] [MainThread]: 
[0m19:11:22.532421 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:11:22.534936 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m19:11:22.995353 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m19:11:22.996383 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m19:11:22.997042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:23.101810 [debug] [ThreadPool]: SQL status: OK in 0.105 seconds
[0m19:11:23.104753 [debug] [ThreadPool]: On list_warehouse: Close
[0m19:11:23.106988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_trf)
[0m19:11:23.107890 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_trf"
"
[0m19:11:23.119816 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:11:23.120657 [debug] [ThreadPool]: On create_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_trf"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m19:11:23.121150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:11:23.123641 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:11:23.125947 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:11:23.126487 [debug] [ThreadPool]: On create_warehouse_main_trf: BEGIN
[0m19:11:23.127470 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:11:23.127943 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:11:23.128368 [debug] [ThreadPool]: On create_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_trf"} */

    
    
        create schema if not exists "warehouse"."main_trf"
    
[0m19:11:23.129339 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:11:23.131244 [debug] [ThreadPool]: On create_warehouse_main_trf: COMMIT
[0m19:11:23.132083 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:11:23.132764 [debug] [ThreadPool]: On create_warehouse_main_trf: COMMIT
[0m19:11:23.134096 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:11:23.134700 [debug] [ThreadPool]: On create_warehouse_main_trf: Close
[0m19:11:23.146405 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m19:11:23.155800 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_trf'
[0m19:11:23.162350 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m19:11:23.165605 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m19:11:23.166819 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m19:11:23.167625 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m19:11:23.168221 [debug] [ThreadPool]: On list_warehouse_main_trf: BEGIN
[0m19:11:23.172185 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m19:11:23.173010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:23.173749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:23.174710 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m19:11:23.176270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:23.176851 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:11:23.177746 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:11:23.178557 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m19:11:23.179259 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m19:11:23.179803 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:11:23.180318 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m19:11:23.181502 [debug] [ThreadPool]: On list_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_trf"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_trf'
    and lower(table_catalog) = 'warehouse'
  
[0m19:11:23.182789 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m19:11:23.184367 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m19:11:23.212722 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m19:11:23.213730 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m19:11:23.216835 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m19:11:23.217661 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m19:11:23.220083 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m19:11:23.222048 [debug] [ThreadPool]: On list_warehouse_main_trf: ROLLBACK
[0m19:11:23.273244 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m19:11:23.274049 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m19:11:23.277814 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_trf'
[0m19:11:23.278614 [debug] [ThreadPool]: On list_warehouse_main_trf: Close
[0m19:11:23.280308 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m19:11:23.280850 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m19:11:23.284209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0490dd4c-88e7-4003-8f6f-1e0a6432ce22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720825AC30>]}
[0m19:11:23.285616 [debug] [MainThread]: Using duckdb connection "master"
[0m19:11:23.286626 [debug] [MainThread]: On master: BEGIN
[0m19:11:23.287910 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:11:23.289972 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:11:23.290574 [debug] [MainThread]: On master: COMMIT
[0m19:11:23.291076 [debug] [MainThread]: Using duckdb connection "master"
[0m19:11:23.291543 [debug] [MainThread]: On master: COMMIT
[0m19:11:23.292382 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:11:23.292880 [debug] [MainThread]: On master: Close
[0m19:11:23.304205 [debug] [Thread-1 (]: Began running node model.raysearch_project.trf_currency_exchange
[0m19:11:23.305331 [info ] [Thread-1 (]: 1 of 1 START sql table model main_trf.trf_currency_exchange .................... [RUN]
[0m19:11:23.306857 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.raysearch_project.trf_currency_exchange'
[0m19:11:23.307510 [debug] [Thread-1 (]: Began compiling node model.raysearch_project.trf_currency_exchange
[0m19:11:23.322101 [debug] [Thread-1 (]: Writing injected SQL for node "model.raysearch_project.trf_currency_exchange"
[0m19:11:23.326026 [debug] [Thread-1 (]: Began executing node model.raysearch_project.trf_currency_exchange
[0m19:11:23.398726 [debug] [Thread-1 (]: Writing runtime sql for node "model.raysearch_project.trf_currency_exchange"
[0m19:11:23.404417 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange"
[0m19:11:23.405734 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: BEGIN
[0m19:11:23.406789 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:11:23.408963 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:11:23.409661 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange"
[0m19:11:23.410238 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange"} */

  
    
    

    create  table
      "warehouse"."main_trf"."trf_currency_exchange__dbt_tmp"
  
    as (
      with src as (
    select * from "warehouse"."main_stg"."stg_currency_exchange"
),
dedup as (
    select *,
           row_number() over (partition by rate_date order by currency_code) as rn
    from src
)
select rate_date, currency_code, base_rate_eur
from dedup
where rn = 1
    );
  
  
[0m19:11:23.427496 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m19:11:23.438711 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange"
[0m19:11:23.439531 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange"} */
alter table "warehouse"."main_trf"."trf_currency_exchange__dbt_tmp" rename to "trf_currency_exchange"
[0m19:11:23.441301 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:11:23.469553 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: COMMIT
[0m19:11:23.470514 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange"
[0m19:11:23.471122 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: COMMIT
[0m19:11:23.484749 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m19:11:23.495202 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange"
[0m19:11:23.496073 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange"} */

      drop table if exists "warehouse"."main_trf"."trf_currency_exchange__dbt_backup" cascade
    
[0m19:11:23.497503 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:11:23.502302 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: Close
[0m19:11:23.507396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0490dd4c-88e7-4003-8f6f-1e0a6432ce22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172085CD550>]}
[0m19:11:23.508995 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_trf.trf_currency_exchange ............... [[32mOK[0m in 0.20s]
[0m19:11:23.510733 [debug] [Thread-1 (]: Finished running node model.raysearch_project.trf_currency_exchange
[0m19:11:23.513888 [debug] [MainThread]: Using duckdb connection "master"
[0m19:11:23.514802 [debug] [MainThread]: On master: BEGIN
[0m19:11:23.515813 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:11:23.517094 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:11:23.517650 [debug] [MainThread]: On master: COMMIT
[0m19:11:23.518158 [debug] [MainThread]: Using duckdb connection "master"
[0m19:11:23.518593 [debug] [MainThread]: On master: COMMIT
[0m19:11:23.519423 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:11:23.520008 [debug] [MainThread]: On master: Close
[0m19:11:23.520737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:11:23.521171 [debug] [MainThread]: Connection 'create_warehouse_main_trf' was properly closed.
[0m19:11:23.521551 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m19:11:23.521907 [debug] [MainThread]: Connection 'list_warehouse_main_trf' was properly closed.
[0m19:11:23.522291 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m19:11:23.522649 [debug] [MainThread]: Connection 'model.raysearch_project.trf_currency_exchange' was properly closed.
[0m19:11:23.523139 [info ] [MainThread]: 
[0m19:11:23.524398 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m19:11:23.527051 [debug] [MainThread]: Command end result
[0m19:11:23.577515 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m19:11:23.585403 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m19:11:23.599745 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m19:11:23.601219 [info ] [MainThread]: 
[0m19:11:23.602559 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:11:23.603641 [info ] [MainThread]: 
[0m19:11:23.604652 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:11:23.606573 [debug] [MainThread]: Command `dbt run` succeeded at 19:11:23.606326 after 3.48 seconds
[0m19:11:23.607312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720826FE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017202AE9A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017207D18050>]}
[0m19:11:23.607951 [debug] [MainThread]: Flushing usage events
[0m19:11:25.193609 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:37:09.822607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEABE54830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEACF8BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEACF8B9D0>]}


============================== 19:37:09.839451 | 02263c8c-a7cf-4fda-b382-de2a0d319867 ==============================
[0m19:37:09.839451 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:37:09.842270 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --select trf_currency_exchange_scd2', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m19:37:11.205218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02263c8c-a7cf-4fda-b382-de2a0d319867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEAC2C6060>]}
[0m19:37:11.350871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02263c8c-a7cf-4fda-b382-de2a0d319867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEADFD27A0>]}
[0m19:37:11.415672 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:37:12.447631 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m19:37:12.450634 [debug] [MainThread]: Command `dbt run` failed at 19:37:12.450324 after 3.32 seconds
[0m19:37:12.451439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEAE023050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEAE022F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEADFDAE40>]}
[0m19:37:12.452119 [debug] [MainThread]: Flushing usage events
[0m19:37:13.912113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:37:31.602851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021346D54830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021347E87ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021347E879D0>]}


============================== 19:37:31.616469 | 2090ee16-779d-4f0f-a5a0-e66f43d57e8a ==============================
[0m19:37:31.616469 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:37:31.618349 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m19:37:31.930464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2090ee16-779d-4f0f-a5a0-e66f43d57e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213471C6060>]}
[0m19:37:32.036172 [debug] [MainThread]: Set downloads directory='C:\Users\AMANDAKA\AppData\Local\Temp\dbt-downloads-417ka6sj'
[0m19:37:32.037266 [error] [MainThread]: Encountered an error:
">=1.1.1,<2.0.0" is not a valid semantic version.
[0m19:37:32.269475 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 258, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\cli\main.py", line 461, in deps
    results = task.run()
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\task\deps.py", line 289, in run
    self.lock()
    ~~~~~~~~~^^
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\task\deps.py", line 261, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\deps\resolver.py", line 121, in resolve_packages
    pending = PackageListing.from_contracts(packages)
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\deps\resolver.py", line 91, in from_contracts
    self.update_from(src)
    ~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\deps\resolver.py", line 83, in update_from
    pkg = RegistryUnpinnedPackage.from_contract(contract)
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\deps\registry.py", line 83, in from_contract
    versions = [semver.VersionSpecifier.from_version_string(v) for v in raw_version]
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt_common\semver.py", line 99, in from_version_string
    raise dbt_common.exceptions.base.SemverError(
        f'"{version_string}" is not a valid semantic version.'
    )
dbt_common.exceptions.base.SemverError: ">=1.1.1,<2.0.0" is not a valid semantic version.

[0m19:37:32.274325 [debug] [MainThread]: Command `dbt deps` failed at 19:37:32.273988 after 1.01 seconds
[0m19:37:32.275151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021348ED1D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021348ED3DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021349166750>]}
[0m19:37:32.275843 [debug] [MainThread]: Flushing usage events
[0m19:37:34.806930 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:38:26.791090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BEA24830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BFB57ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BFB579D0>]}


============================== 19:38:26.805205 | 1055d710-02bb-4818-8b8e-6a40f81b6ffa ==============================
[0m19:38:26.805205 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:38:26.806990 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt deps', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m19:38:27.074675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1055d710-02bb-4818-8b8e-6a40f81b6ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BEE96060>]}
[0m19:38:27.168830 [debug] [MainThread]: Set downloads directory='C:\Users\AMANDAKA\AppData\Local\Temp\dbt-downloads-dks6m0th'
[0m19:38:27.170515 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:38:27.988039 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:38:27.991508 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:38:28.709804 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:38:28.740817 [info ] [MainThread]: Updating lock file in file path: C:\Users\AMANDAKA\Workspaces\raysearch_project/package-lock.yml
[0m19:38:28.799677 [debug] [MainThread]: Set downloads directory='C:\Users\AMANDAKA\AppData\Local\Temp\dbt-downloads-r4x83x0b'
[0m19:38:28.807443 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:38:31.435529 [info ] [MainThread]: Installed from version 1.1.1
[0m19:38:31.437095 [info ] [MainThread]: Updated version available: 1.3.3
[0m19:38:31.438251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1055d710-02bb-4818-8b8e-6a40f81b6ffa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C0BA3DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C0BA1D00>]}
[0m19:38:31.439342 [info ] [MainThread]: 
[0m19:38:31.440533 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m19:38:31.444975 [debug] [MainThread]: Command `dbt deps` succeeded at 19:38:31.444599 after 5.00 seconds
[0m19:38:31.445815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C0D66750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BF35AE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C0BF8140>]}
[0m19:38:31.446486 [debug] [MainThread]: Flushing usage events
[0m19:38:32.910238 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:03.920043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA0244830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA137BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA137B9D0>]}


============================== 19:39:03.933964 | d3c44ea4-5f6e-4f93-ae75-fdcc30106080 ==============================
[0m19:39:03.933964 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:39:03.935805 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --select trf_currency_exchange_scd2', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m19:39:04.450903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3c44ea4-5f6e-4f93-ae75-fdcc30106080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA06B6060>]}
[0m19:39:04.590676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3c44ea4-5f6e-4f93-ae75-fdcc30106080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA23C27A0>]}
[0m19:39:04.597234 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:39:05.215108 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:39:05.526773 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m19:39:05.528328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd3c44ea4-5f6e-4f93-ae75-fdcc30106080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA282E650>]}
[0m19:39:16.840854 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on 'customer' in
package 'raysearch_project' (seeds\seeds.yml). Arguments to generic tests should
be nested under the `arguments` property.
[0m19:39:16.842399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd3c44ea4-5f6e-4f93-ae75-fdcc30106080', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA284E7B0>]}
[0m19:39:17.061255 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'trf_currency_exchange' in the 'models' section of file 'models\transformation\trf_schema.yml'
[0m19:39:17.151331 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.raysearch_project.trf_currency_exchange_scd2' (models\transformation\trf_currency_exchange_scd2.sql) depends on a node named 'trf_currency_exchange' which was not found
[0m19:39:17.153504 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 11 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:39:17.156405 [debug] [MainThread]: Command `dbt run` failed at 19:39:17.155973 after 13.58 seconds
[0m19:39:17.157386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA135BE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA2E69630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CA2834FC0>]}
[0m19:39:17.158192 [debug] [MainThread]: Flushing usage events
[0m19:39:18.336671 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:40:26.241470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BA3F24830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BA505FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BA505F9D0>]}


============================== 19:40:26.254460 | 575ebbf7-6101-4df4-9bdf-5faa25058871 ==============================
[0m19:40:26.254460 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:40:26.255909 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'invocation_command': 'dbt run --select trf_currency_exchange_scd2', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m19:40:26.758973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '575ebbf7-6101-4df4-9bdf-5faa25058871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BA4396060>]}
[0m19:40:26.900907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '575ebbf7-6101-4df4-9bdf-5faa25058871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BA609E7A0>]}
[0m19:40:26.908573 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:40:27.388204 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:40:27.633843 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m19:40:27.635372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '575ebbf7-6101-4df4-9bdf-5faa25058871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BA650A650>]}
[0m19:40:30.545351 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on 'customer' in
package 'raysearch_project' (seeds\seeds.yml). Arguments to generic tests should
be nested under the `arguments` property.
[0m19:40:30.546866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '575ebbf7-6101-4df4-9bdf-5faa25058871', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BA652A7B0>]}
[0m19:40:30.772047 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'trf_currency_exchange' in the 'models' section of file 'models\transformation\trf_schema.yml'
[0m19:40:30.862092 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.raysearch_project.not_null_trf_currency_exchange_rate_date.e5151cbcc2' (models\transformation\trf_schema.yml) depends on a node named 'trf_currency_exchange' in package '' which was not found
[0m19:40:30.864208 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.raysearch_project.not_null_trf_currency_exchange_currency_code.753af6a7de' (models\transformation\trf_schema.yml) depends on a node named 'trf_currency_exchange' in package '' which was not found
[0m19:40:30.865737 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_rate_date__currency_code.225df91bc9' (models\transformation\trf_schema.yml) depends on a node named 'trf_currency_exchange' in package '' which was not found
[0m19:40:31.037668 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.raysearch_project.marts
[0m19:40:31.048701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '575ebbf7-6101-4df4-9bdf-5faa25058871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BA69B8BB0>]}
[0m19:40:31.237452 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m19:40:31.311150 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m19:40:31.413739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '575ebbf7-6101-4df4-9bdf-5faa25058871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BA64D0530>]}
[0m19:40:31.414956 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 seeds, 29 data tests, 586 macros
[0m19:40:31.415976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '575ebbf7-6101-4df4-9bdf-5faa25058871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BA69D2810>]}
[0m19:40:31.419340 [info ] [MainThread]: 
[0m19:40:31.420395 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:40:31.421302 [info ] [MainThread]: 
[0m19:40:31.422938 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:40:31.425115 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m19:40:46.310436 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m19:40:46.313084 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m19:40:46.313761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:46.393662 [debug] [ThreadPool]: SQL status: OK in 0.080 seconds
[0m19:40:46.396459 [debug] [ThreadPool]: On list_warehouse: Close
[0m19:40:46.397901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_trf)
[0m19:40:46.398732 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_trf"
"
[0m19:40:46.409323 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:40:46.409914 [debug] [ThreadPool]: On create_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_trf"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m19:40:46.410398 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:40:46.413071 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m19:40:46.415296 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:40:46.415811 [debug] [ThreadPool]: On create_warehouse_main_trf: BEGIN
[0m19:40:46.416635 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:40:46.417085 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:40:46.417491 [debug] [ThreadPool]: On create_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_trf"} */

    
    
        create schema if not exists "warehouse"."main_trf"
    
[0m19:40:46.418717 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:40:46.420586 [debug] [ThreadPool]: On create_warehouse_main_trf: COMMIT
[0m19:40:46.421145 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:40:46.421581 [debug] [ThreadPool]: On create_warehouse_main_trf: COMMIT
[0m19:40:46.422445 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:40:46.422967 [debug] [ThreadPool]: On create_warehouse_main_trf: Close
[0m19:40:46.433580 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m19:40:46.443399 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m19:40:46.444007 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m19:40:46.444771 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m19:40:46.445270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:46.448798 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m19:40:46.449655 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_trf'
[0m19:40:46.450669 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m19:40:46.456108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:46.455448 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m19:40:46.454466 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m19:40:46.457225 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:40:46.457764 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m19:40:46.458345 [debug] [ThreadPool]: On list_warehouse_main_trf: BEGIN
[0m19:40:46.458782 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m19:40:46.459338 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m19:40:46.459829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:46.460279 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m19:40:46.462001 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:40:46.465830 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m19:40:46.466431 [debug] [ThreadPool]: On list_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_trf"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_trf'
    and lower(table_catalog) = 'warehouse'
  
[0m19:40:46.489891 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m19:40:46.491323 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m19:40:46.492136 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m19:40:46.494586 [debug] [ThreadPool]: On list_warehouse_main_trf: ROLLBACK
[0m19:40:46.496758 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m19:40:46.498854 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m19:40:46.577199 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m19:40:46.578427 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m19:40:46.581052 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m19:40:46.582008 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m19:40:46.584959 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_trf'
[0m19:40:46.585444 [debug] [ThreadPool]: On list_warehouse_main_trf: Close
[0m19:40:46.588244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '575ebbf7-6101-4df4-9bdf-5faa25058871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BA64FFC20>]}
[0m19:40:46.589567 [debug] [MainThread]: Using duckdb connection "master"
[0m19:40:46.590610 [debug] [MainThread]: On master: BEGIN
[0m19:40:46.591159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:40:46.592883 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:40:46.593782 [debug] [MainThread]: On master: COMMIT
[0m19:40:46.594445 [debug] [MainThread]: Using duckdb connection "master"
[0m19:40:46.594982 [debug] [MainThread]: On master: COMMIT
[0m19:40:46.596214 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:40:46.596990 [debug] [MainThread]: On master: Close
[0m19:40:46.612663 [debug] [Thread-1 (]: Began running node model.raysearch_project.trf_currency_exchange_scd2
[0m19:40:46.614163 [info ] [Thread-1 (]: 1 of 1 START sql table model main_trf.trf_currency_exchange_scd2 ............... [RUN]
[0m19:40:46.616604 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.raysearch_project.trf_currency_exchange_scd2'
[0m19:40:46.617553 [debug] [Thread-1 (]: Began compiling node model.raysearch_project.trf_currency_exchange_scd2
[0m19:40:46.632531 [debug] [Thread-1 (]: Writing injected SQL for node "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:40:46.637361 [debug] [Thread-1 (]: Began executing node model.raysearch_project.trf_currency_exchange_scd2
[0m19:40:46.703833 [debug] [Thread-1 (]: Writing runtime sql for node "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:40:46.707378 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:40:46.708118 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: BEGIN
[0m19:40:46.708659 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:40:46.710285 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:40:46.711174 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:40:46.712558 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange_scd2"} */

  
    
    

    create  table
      "warehouse"."main_trf"."trf_currency_exchange_scd2__dbt_tmp"
  
    as (
      with daily as (
    select * from "warehouse"."main_stg"."stg_currency_exchange"
),
scd2 as (
    select
        currency_code,
        base_rate_eur,
        rate_date as effective_start_date,
        lead(rate_date) over (
            partition by currency_code
            order by rate_date
        ) as next_rate_date
    from daily
)
select
    currency_code,
    base_rate_eur,
    effective_start_date,
    case
        when next_rate_date is not null then (next_rate_date - interval 1 day)::date
        else null
    end as effective_end_date,
    case when next_rate_date is null then true else false end as is_current
from scd2
    );
  
  
[0m19:40:46.730953 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m19:40:46.743133 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:40:46.744013 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange_scd2"} */
alter table "warehouse"."main_trf"."trf_currency_exchange_scd2__dbt_tmp" rename to "trf_currency_exchange_scd2"
[0m19:40:46.746363 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:40:46.770520 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: COMMIT
[0m19:40:46.771427 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:40:46.772006 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: COMMIT
[0m19:40:46.777445 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:40:46.789062 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:40:46.789844 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange_scd2"} */

      drop table if exists "warehouse"."main_trf"."trf_currency_exchange_scd2__dbt_backup" cascade
    
[0m19:40:46.791320 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:40:46.796730 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: Close
[0m19:40:46.802777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '575ebbf7-6101-4df4-9bdf-5faa25058871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BA431F6B0>]}
[0m19:40:46.804408 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_trf.trf_currency_exchange_scd2 .......... [[32mOK[0m in 0.18s]
[0m19:40:46.806152 [debug] [Thread-1 (]: Finished running node model.raysearch_project.trf_currency_exchange_scd2
[0m19:40:46.809156 [debug] [MainThread]: Using duckdb connection "master"
[0m19:40:46.809691 [debug] [MainThread]: On master: BEGIN
[0m19:40:46.810111 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:40:46.811288 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:40:46.811826 [debug] [MainThread]: On master: COMMIT
[0m19:40:46.812827 [debug] [MainThread]: Using duckdb connection "master"
[0m19:40:46.813376 [debug] [MainThread]: On master: COMMIT
[0m19:40:46.814327 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:40:46.814921 [debug] [MainThread]: On master: Close
[0m19:40:46.816006 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:46.816941 [debug] [MainThread]: Connection 'create_warehouse_main_trf' was properly closed.
[0m19:40:46.817529 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m19:40:46.818078 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m19:40:46.818774 [debug] [MainThread]: Connection 'list_warehouse_main_trf' was properly closed.
[0m19:40:46.819795 [debug] [MainThread]: Connection 'model.raysearch_project.trf_currency_exchange_scd2' was properly closed.
[0m19:40:46.820954 [info ] [MainThread]: 
[0m19:40:46.822729 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.40 seconds (15.40s).
[0m19:40:46.824905 [debug] [MainThread]: Command end result
[0m19:40:46.889057 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m19:40:46.895718 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m19:40:46.908398 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m19:40:46.909144 [info ] [MainThread]: 
[0m19:40:46.910510 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:40:46.911992 [info ] [MainThread]: 
[0m19:40:46.913266 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:40:46.914760 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 11 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:40:46.917035 [debug] [MainThread]: Command `dbt run` succeeded at 19:40:46.916655 after 21.03 seconds
[0m19:40:46.918096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BA43264D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BA6B170D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BA5085A90>]}
[0m19:40:46.919230 [debug] [MainThread]: Flushing usage events
[0m19:40:48.307647 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:43:03.569653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DC3674830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DC47AFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DC47AF9D0>]}


============================== 19:43:03.582586 | 81acf8e1-58e7-41b4-8734-ba7c549bfd5d ==============================
[0m19:43:03.582586 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:43:03.584123 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --select trf_currency_exchange_scd2', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m19:43:04.098673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81acf8e1-58e7-41b4-8734-ba7c549bfd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DC3AE6060>]}
[0m19:43:04.251310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81acf8e1-58e7-41b4-8734-ba7c549bfd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DC57EE7A0>]}
[0m19:43:04.259378 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:43:04.749352 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:43:05.281090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:43:05.282590 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models\transformation\trf_transaction.sql
[0m19:43:05.283363 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models\transformation\trf_currency_exchange_scd2.sql
[0m19:43:06.129400 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`
defined on 'trf_transaction' in package 'raysearch_project'
(models\transformation\trf_schema.yml). Arguments to generic tests should be
nested under the `arguments` property.
[0m19:43:06.131349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '81acf8e1-58e7-41b4-8734-ba7c549bfd5d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DC5C6B450>]}
[0m19:43:06.349250 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.raysearch_project.marts
[0m19:43:06.362679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81acf8e1-58e7-41b4-8734-ba7c549bfd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DC5EF3F20>]}
[0m19:43:06.569908 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m19:43:06.577064 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m19:43:06.651868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81acf8e1-58e7-41b4-8734-ba7c549bfd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DC5FE90F0>]}
[0m19:43:06.652913 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 seeds, 29 data tests, 586 macros
[0m19:43:06.654543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81acf8e1-58e7-41b4-8734-ba7c549bfd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DC5FA8940>]}
[0m19:43:06.658178 [info ] [MainThread]: 
[0m19:43:06.659336 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:43:06.660400 [info ] [MainThread]: 
[0m19:43:06.661542 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:43:06.666460 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m19:43:06.923533 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m19:43:06.924338 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m19:43:06.925093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:43:06.965551 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m19:43:06.968131 [debug] [ThreadPool]: On list_warehouse: Close
[0m19:43:06.969538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_trf)
[0m19:43:06.970353 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_trf"
"
[0m19:43:06.982950 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:43:06.983667 [debug] [ThreadPool]: On create_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_trf"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m19:43:06.984135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:43:06.986185 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:43:06.989308 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:43:06.989878 [debug] [ThreadPool]: On create_warehouse_main_trf: BEGIN
[0m19:43:06.990833 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:43:06.991316 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:43:06.991721 [debug] [ThreadPool]: On create_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_trf"} */

    
    
        create schema if not exists "warehouse"."main_trf"
    
[0m19:43:06.992910 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:43:06.994287 [debug] [ThreadPool]: On create_warehouse_main_trf: COMMIT
[0m19:43:06.994821 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:43:06.995245 [debug] [ThreadPool]: On create_warehouse_main_trf: COMMIT
[0m19:43:06.996057 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:43:06.996819 [debug] [ThreadPool]: On create_warehouse_main_trf: Close
[0m19:43:07.007887 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m19:43:07.012456 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_trf'
[0m19:43:07.025449 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m19:43:07.028575 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m19:43:07.029791 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m19:43:07.030802 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m19:43:07.031706 [debug] [ThreadPool]: On list_warehouse_main_trf: BEGIN
[0m19:43:07.032300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:43:07.035720 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m19:43:07.036339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:43:07.039291 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m19:43:07.040649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:43:07.041925 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m19:43:07.042519 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m19:43:07.043006 [debug] [ThreadPool]: On list_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_trf"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_trf'
    and lower(table_catalog) = 'warehouse'
  
[0m19:43:07.044108 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m19:43:07.044941 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m19:43:07.045871 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m19:43:07.047023 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m19:43:07.047897 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m19:43:07.049838 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m19:43:07.073163 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m19:43:07.074799 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m19:43:07.075591 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m19:43:07.077722 [debug] [ThreadPool]: On list_warehouse_main_trf: ROLLBACK
[0m19:43:07.080523 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m19:43:07.082291 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m19:43:07.088115 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_trf'
[0m19:43:07.089063 [debug] [ThreadPool]: On list_warehouse_main_trf: Close
[0m19:43:07.091200 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m19:43:07.091842 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m19:43:07.093943 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m19:43:07.094461 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m19:43:07.097008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81acf8e1-58e7-41b4-8734-ba7c549bfd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DC608DC10>]}
[0m19:43:07.098225 [debug] [MainThread]: Using duckdb connection "master"
[0m19:43:07.098732 [debug] [MainThread]: On master: BEGIN
[0m19:43:07.099141 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:43:07.100348 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:43:07.100848 [debug] [MainThread]: On master: COMMIT
[0m19:43:07.101272 [debug] [MainThread]: Using duckdb connection "master"
[0m19:43:07.101686 [debug] [MainThread]: On master: COMMIT
[0m19:43:07.102616 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:43:07.103200 [debug] [MainThread]: On master: Close
[0m19:43:07.111982 [debug] [Thread-1 (]: Began running node model.raysearch_project.trf_currency_exchange_scd2
[0m19:43:07.113171 [info ] [Thread-1 (]: 1 of 1 START sql table model main_trf.trf_currency_exchange_scd2 ............... [RUN]
[0m19:43:07.116078 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.raysearch_project.trf_currency_exchange_scd2'
[0m19:43:07.116735 [debug] [Thread-1 (]: Began compiling node model.raysearch_project.trf_currency_exchange_scd2
[0m19:43:07.132109 [debug] [Thread-1 (]: Writing injected SQL for node "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:43:07.134936 [debug] [Thread-1 (]: Began executing node model.raysearch_project.trf_currency_exchange_scd2
[0m19:43:07.201956 [debug] [Thread-1 (]: Writing runtime sql for node "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:43:07.205446 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:43:07.206436 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: BEGIN
[0m19:43:07.206967 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:43:07.208597 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:43:07.209216 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:43:07.210359 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange_scd2"} */

  
    
    

    create  table
      "warehouse"."main_trf"."trf_currency_exchange_scd2__dbt_tmp"
  
    as (
      with daily as (
    select * from "warehouse"."main_stg"."stg_currency_exchange"
),
scd2 as (
    select
        currency_code,
        base_rate_eur,
        rate_date as etl_valid_from,
        lead(rate_date) over (
            partition by currency_code
            order by rate_date
        ) as next_rate_date
    from daily
)
select
    currency_code,
    base_rate_eur,
    etl_valid_from,
    case
        when next_rate_date is not null then (next_rate_date - interval 1 day)::date
        else null
    end as etl_valid_to,
    case when next_rate_date is null then true else false end as is_current
from scd2
    );
  
  
[0m19:43:07.226711 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m19:43:07.236671 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:43:07.237873 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange_scd2"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_trf'
      AND table_name = 'trf_currency_exchange_scd2'
  
[0m19:43:07.240485 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:43:07.242882 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:43:07.243527 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange_scd2"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_trf'
      AND table_name = 'trf_currency_exchange_scd2'
  
[0m19:43:07.245465 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:43:07.257000 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:43:07.257864 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange_scd2"} */
alter table "warehouse"."main_trf"."trf_currency_exchange_scd2" rename to "trf_currency_exchange_scd2__dbt_backup"
[0m19:43:07.259985 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:43:07.265567 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:43:07.266197 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange_scd2"} */
alter table "warehouse"."main_trf"."trf_currency_exchange_scd2__dbt_tmp" rename to "trf_currency_exchange_scd2"
[0m19:43:07.267418 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:43:07.296679 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: COMMIT
[0m19:43:07.297555 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:43:07.298085 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: COMMIT
[0m19:43:07.312196 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m19:43:07.322349 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:43:07.323133 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange_scd2"} */

      drop table if exists "warehouse"."main_trf"."trf_currency_exchange_scd2__dbt_backup" cascade
    
[0m19:43:07.326244 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:43:07.330658 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: Close
[0m19:43:07.335743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81acf8e1-58e7-41b4-8734-ba7c549bfd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DC62B1910>]}
[0m19:43:07.337771 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_trf.trf_currency_exchange_scd2 .......... [[32mOK[0m in 0.22s]
[0m19:43:07.339639 [debug] [Thread-1 (]: Finished running node model.raysearch_project.trf_currency_exchange_scd2
[0m19:43:07.342565 [debug] [MainThread]: Using duckdb connection "master"
[0m19:43:07.343539 [debug] [MainThread]: On master: BEGIN
[0m19:43:07.344066 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:43:07.345266 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:43:07.345777 [debug] [MainThread]: On master: COMMIT
[0m19:43:07.346220 [debug] [MainThread]: Using duckdb connection "master"
[0m19:43:07.346615 [debug] [MainThread]: On master: COMMIT
[0m19:43:07.347431 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:43:07.347900 [debug] [MainThread]: On master: Close
[0m19:43:07.348518 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:43:07.348919 [debug] [MainThread]: Connection 'create_warehouse_main_trf' was properly closed.
[0m19:43:07.349305 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m19:43:07.350200 [debug] [MainThread]: Connection 'list_warehouse_main_trf' was properly closed.
[0m19:43:07.351454 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m19:43:07.352817 [debug] [MainThread]: Connection 'model.raysearch_project.trf_currency_exchange_scd2' was properly closed.
[0m19:43:07.353650 [info ] [MainThread]: 
[0m19:43:07.355393 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m19:43:07.357751 [debug] [MainThread]: Command end result
[0m19:43:07.430951 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m19:43:07.436749 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m19:43:07.449844 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m19:43:07.450900 [info ] [MainThread]: 
[0m19:43:07.452587 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:43:07.453634 [info ] [MainThread]: 
[0m19:43:07.455048 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:43:07.456776 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:43:07.459847 [debug] [MainThread]: Command `dbt run` succeeded at 19:43:07.459366 after 4.23 seconds
[0m19:43:07.460587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DC6362D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DC60999A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DC47BF550>]}
[0m19:43:07.461204 [debug] [MainThread]: Flushing usage events
[0m19:43:08.960885 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:49:29.231746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A28B4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A39EFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A39EF9D0>]}


============================== 19:49:29.245588 | a9a37aff-0cbb-4bce-b0d8-9e4fc789b453 ==============================
[0m19:49:29.245588 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:49:29.247254 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select trf_currency_exchange_scd2', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m19:49:29.749189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9a37aff-0cbb-4bce-b0d8-9e4fc789b453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A2D26060>]}
[0m19:49:29.880126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9a37aff-0cbb-4bce-b0d8-9e4fc789b453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A4A327A0>]}
[0m19:49:29.887607 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:49:30.393389 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:49:30.849272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:49:30.850700 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models\transformation\trf_currency_exchange_scd2.sql
[0m19:49:30.851454 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models\transformation\trf_customer_scd2.sql
[0m19:49:31.607612 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`
defined on 'trf_currency_exchange_scd2' in package 'raysearch_project'
(models\transformation\trf_schema.yml). Arguments to generic tests should be
nested under the `arguments` property.
[0m19:49:31.609294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a9a37aff-0cbb-4bce-b0d8-9e4fc789b453', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A4F0B750>]}
[0m19:49:31.797430 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.raysearch_project.marts
[0m19:49:31.809064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9a37aff-0cbb-4bce-b0d8-9e4fc789b453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A518CE60>]}
[0m19:49:32.011207 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m19:49:32.019586 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m19:49:32.102874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9a37aff-0cbb-4bce-b0d8-9e4fc789b453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A5293690>]}
[0m19:49:32.104182 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 seeds, 29 data tests, 586 macros
[0m19:49:32.105468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9a37aff-0cbb-4bce-b0d8-9e4fc789b453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A524C1F0>]}
[0m19:49:32.108868 [info ] [MainThread]: 
[0m19:49:32.110145 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:49:32.111207 [info ] [MainThread]: 
[0m19:49:32.112741 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:49:32.115334 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m19:49:32.366560 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m19:49:32.367335 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m19:49:32.367825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:32.408434 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m19:49:32.411234 [debug] [ThreadPool]: On list_warehouse: Close
[0m19:49:32.412426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_trf)
[0m19:49:32.413230 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_trf"
"
[0m19:49:32.425081 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:49:32.425889 [debug] [ThreadPool]: On create_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_trf"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m19:49:32.426363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:49:32.428448 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:49:32.430667 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:49:32.431182 [debug] [ThreadPool]: On create_warehouse_main_trf: BEGIN
[0m19:49:32.432240 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:49:32.432939 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:49:32.433469 [debug] [ThreadPool]: On create_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_trf"} */

    
    
        create schema if not exists "warehouse"."main_trf"
    
[0m19:49:32.434892 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:49:32.437075 [debug] [ThreadPool]: On create_warehouse_main_trf: COMMIT
[0m19:49:32.437659 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:49:32.438130 [debug] [ThreadPool]: On create_warehouse_main_trf: COMMIT
[0m19:49:32.439271 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:49:32.439831 [debug] [ThreadPool]: On create_warehouse_main_trf: Close
[0m19:49:32.449693 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_trf'
[0m19:49:32.453851 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m19:49:32.467482 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m19:49:32.468770 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m19:49:32.472013 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m19:49:32.472847 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m19:49:32.476623 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m19:49:32.477374 [debug] [ThreadPool]: On list_warehouse_main_trf: BEGIN
[0m19:49:32.478144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:32.478950 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m19:49:32.479474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:32.480925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:32.482827 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:49:32.483640 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m19:49:32.484502 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m19:49:32.487004 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m19:49:32.487740 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m19:49:32.488340 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m19:49:32.489126 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m19:49:32.489684 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m19:49:32.490714 [debug] [ThreadPool]: On list_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_trf"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_trf'
    and lower(table_catalog) = 'warehouse'
  
[0m19:49:32.514879 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m19:49:32.516273 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m19:49:32.517110 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m19:49:32.519741 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m19:49:32.521725 [debug] [ThreadPool]: On list_warehouse_main_trf: ROLLBACK
[0m19:49:32.523703 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m19:49:32.528489 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_trf'
[0m19:49:32.529279 [debug] [ThreadPool]: On list_warehouse_main_trf: Close
[0m19:49:32.531590 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m19:49:32.532151 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m19:49:32.534299 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m19:49:32.534964 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m19:49:32.537452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9a37aff-0cbb-4bce-b0d8-9e4fc789b453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A5321A90>]}
[0m19:49:32.538278 [debug] [MainThread]: Using duckdb connection "master"
[0m19:49:32.538733 [debug] [MainThread]: On master: BEGIN
[0m19:49:32.539164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:49:32.540426 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:49:32.540940 [debug] [MainThread]: On master: COMMIT
[0m19:49:32.541560 [debug] [MainThread]: Using duckdb connection "master"
[0m19:49:32.542425 [debug] [MainThread]: On master: COMMIT
[0m19:49:32.543670 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:49:32.544335 [debug] [MainThread]: On master: Close
[0m19:49:32.555321 [debug] [Thread-1 (]: Began running node model.raysearch_project.trf_currency_exchange_scd2
[0m19:49:32.556577 [info ] [Thread-1 (]: 1 of 1 START sql table model main_trf.trf_currency_exchange_scd2 ............... [RUN]
[0m19:49:32.558144 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.raysearch_project.trf_currency_exchange_scd2'
[0m19:49:32.558811 [debug] [Thread-1 (]: Began compiling node model.raysearch_project.trf_currency_exchange_scd2
[0m19:49:32.571332 [debug] [Thread-1 (]: Writing injected SQL for node "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:49:32.574174 [debug] [Thread-1 (]: Began executing node model.raysearch_project.trf_currency_exchange_scd2
[0m19:49:32.637070 [debug] [Thread-1 (]: Writing runtime sql for node "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:49:32.640568 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:49:32.641304 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: BEGIN
[0m19:49:32.641822 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:49:32.643355 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:49:32.643965 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:49:32.644554 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange_scd2"} */

  
    
    

    create  table
      "warehouse"."main_trf"."trf_currency_exchange_scd2__dbt_tmp"
  
    as (
      with daily as (
    select * from "warehouse"."main_stg"."stg_currency_exchange"
),
scd2 as (
    select
        currency_code,
        base_rate_eur,
        rate_date as etl_valid_from,
        lead(rate_date) over (
            partition by currency_code
            order by rate_date
        ) as next_rate_date
    from daily
)
select
    currency_code,
    base_rate_eur,
    etl_valid_from,
    case
        when next_rate_date is not null then (next_rate_date - interval 1 day)::date
        else CAST('9999-12-31' AS DATE)
    end as etl_valid_to,
    case when next_rate_date is null then true else false end as is_current
from scd2
    );
  
  
[0m19:49:32.659708 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m19:49:32.670191 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:49:32.671243 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange_scd2"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_trf'
      AND table_name = 'trf_currency_exchange_scd2'
  
[0m19:49:32.673219 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:49:32.675450 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:49:32.676055 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange_scd2"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_trf'
      AND table_name = 'trf_currency_exchange_scd2'
  
[0m19:49:32.677852 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:49:32.690264 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:49:32.691333 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange_scd2"} */
alter table "warehouse"."main_trf"."trf_currency_exchange_scd2" rename to "trf_currency_exchange_scd2__dbt_backup"
[0m19:49:32.693290 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:49:32.699684 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:49:32.700355 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange_scd2"} */
alter table "warehouse"."main_trf"."trf_currency_exchange_scd2__dbt_tmp" rename to "trf_currency_exchange_scd2"
[0m19:49:32.702029 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:49:32.731150 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: COMMIT
[0m19:49:32.732151 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:49:32.732801 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: COMMIT
[0m19:49:32.739257 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m19:49:32.750630 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange_scd2"
[0m19:49:32.751983 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange_scd2"} */

      drop table if exists "warehouse"."main_trf"."trf_currency_exchange_scd2__dbt_backup" cascade
    
[0m19:49:32.755393 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:49:32.760723 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange_scd2: Close
[0m19:49:32.765284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9a37aff-0cbb-4bce-b0d8-9e4fc789b453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A55457B0>]}
[0m19:49:32.766526 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_trf.trf_currency_exchange_scd2 .......... [[32mOK[0m in 0.20s]
[0m19:49:32.768566 [debug] [Thread-1 (]: Finished running node model.raysearch_project.trf_currency_exchange_scd2
[0m19:49:32.771513 [debug] [MainThread]: Using duckdb connection "master"
[0m19:49:32.772169 [debug] [MainThread]: On master: BEGIN
[0m19:49:32.772912 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:49:32.774081 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:49:32.774625 [debug] [MainThread]: On master: COMMIT
[0m19:49:32.775088 [debug] [MainThread]: Using duckdb connection "master"
[0m19:49:32.775491 [debug] [MainThread]: On master: COMMIT
[0m19:49:32.776290 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:49:32.776887 [debug] [MainThread]: On master: Close
[0m19:49:32.777535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:49:32.777944 [debug] [MainThread]: Connection 'create_warehouse_main_trf' was properly closed.
[0m19:49:32.778313 [debug] [MainThread]: Connection 'list_warehouse_main_trf' was properly closed.
[0m19:49:32.778683 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m19:49:32.779025 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m19:49:32.779356 [debug] [MainThread]: Connection 'model.raysearch_project.trf_currency_exchange_scd2' was properly closed.
[0m19:49:32.779806 [info ] [MainThread]: 
[0m19:49:32.780945 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m19:49:32.782293 [debug] [MainThread]: Command end result
[0m19:49:32.846447 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m19:49:32.854408 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m19:49:32.867881 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m19:49:32.868938 [info ] [MainThread]: 
[0m19:49:32.870247 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:49:32.871236 [info ] [MainThread]: 
[0m19:49:32.872215 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:49:32.873488 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:49:32.875413 [debug] [MainThread]: Command `dbt run` succeeded at 19:49:32.875183 after 4.01 seconds
[0m19:49:32.876130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A55F2B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A534D7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A39FE7D0>]}
[0m19:49:32.876820 [debug] [MainThread]: Flushing usage events
[0m19:49:34.422781 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:49:57.132613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A6D1F4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A6E32BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A6E32B9D0>]}


============================== 19:49:57.144830 | 7bc139ac-8cb3-4d5a-9007-a603df62d336 ==============================
[0m19:49:57.144830 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:49:57.146360 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt run --select trf_customer_scd2', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m19:49:57.669090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bc139ac-8cb3-4d5a-9007-a603df62d336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A6D666060>]}
[0m19:49:57.798543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bc139ac-8cb3-4d5a-9007-a603df62d336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A6F36E7A0>]}
[0m19:49:57.805441 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:49:58.299692 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:49:58.754686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:49:58.755501 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:49:58.756076 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:49:58.767978 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.raysearch_project.marts
[0m19:49:58.878153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bc139ac-8cb3-4d5a-9007-a603df62d336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A6F899C50>]}
[0m19:49:59.213113 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m19:49:59.220530 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m19:49:59.301352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bc139ac-8cb3-4d5a-9007-a603df62d336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A6F37AE40>]}
[0m19:49:59.302870 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 seeds, 29 data tests, 586 macros
[0m19:49:59.304391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bc139ac-8cb3-4d5a-9007-a603df62d336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A6F604750>]}
[0m19:49:59.308019 [info ] [MainThread]: 
[0m19:49:59.309544 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:49:59.311376 [info ] [MainThread]: 
[0m19:49:59.313531 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:49:59.315676 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m19:49:59.587665 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m19:49:59.588697 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m19:49:59.589391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:59.677280 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m19:49:59.679825 [debug] [ThreadPool]: On list_warehouse: Close
[0m19:49:59.681144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_trf)
[0m19:49:59.681938 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_trf"
"
[0m19:49:59.693582 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:49:59.694319 [debug] [ThreadPool]: On create_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_trf"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m19:49:59.694780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:49:59.697029 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:49:59.699942 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:49:59.700846 [debug] [ThreadPool]: On create_warehouse_main_trf: BEGIN
[0m19:49:59.701829 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:49:59.702395 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:49:59.702876 [debug] [ThreadPool]: On create_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_trf"} */

    
    
        create schema if not exists "warehouse"."main_trf"
    
[0m19:49:59.703989 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:49:59.705714 [debug] [ThreadPool]: On create_warehouse_main_trf: COMMIT
[0m19:49:59.706296 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:49:59.706982 [debug] [ThreadPool]: On create_warehouse_main_trf: COMMIT
[0m19:49:59.708349 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:49:59.709187 [debug] [ThreadPool]: On create_warehouse_main_trf: Close
[0m19:49:59.722213 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_trf'
[0m19:49:59.732775 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m19:49:59.733572 [debug] [ThreadPool]: On list_warehouse_main_trf: BEGIN
[0m19:49:59.734044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:59.735576 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m19:49:59.740974 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m19:49:59.742060 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m19:49:59.739852 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m19:49:59.746657 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m19:49:59.747617 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m19:49:59.748394 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m19:49:59.749095 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m19:49:59.751448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:59.750953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:59.749867 [debug] [ThreadPool]: On list_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_trf"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_trf'
    and lower(table_catalog) = 'warehouse'
  
[0m19:49:59.753216 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:49:59.753830 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m19:49:59.754422 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m19:49:59.755007 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:49:59.755941 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m19:49:59.756406 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m19:49:59.779314 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m19:49:59.780313 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m19:49:59.781023 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m19:49:59.783520 [debug] [ThreadPool]: On list_warehouse_main_trf: ROLLBACK
[0m19:49:59.785533 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m19:49:59.788441 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m19:49:59.793893 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m19:49:59.794825 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m19:49:59.797256 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_trf'
[0m19:49:59.797856 [debug] [ThreadPool]: On list_warehouse_main_trf: Close
[0m19:49:59.799707 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m19:49:59.800533 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m19:49:59.802857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bc139ac-8cb3-4d5a-9007-a603df62d336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A6FCE9CC0>]}
[0m19:49:59.803741 [debug] [MainThread]: Using duckdb connection "master"
[0m19:49:59.804232 [debug] [MainThread]: On master: BEGIN
[0m19:49:59.804657 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:49:59.805838 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:49:59.806419 [debug] [MainThread]: On master: COMMIT
[0m19:49:59.806898 [debug] [MainThread]: Using duckdb connection "master"
[0m19:49:59.807327 [debug] [MainThread]: On master: COMMIT
[0m19:49:59.808140 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:49:59.808606 [debug] [MainThread]: On master: Close
[0m19:49:59.816127 [debug] [Thread-1 (]: Began running node model.raysearch_project.trf_customer_scd2
[0m19:49:59.817091 [info ] [Thread-1 (]: 1 of 1 START sql table model main_trf.trf_customer_scd2 ........................ [RUN]
[0m19:49:59.819671 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.raysearch_project.trf_customer_scd2'
[0m19:49:59.820374 [debug] [Thread-1 (]: Began compiling node model.raysearch_project.trf_customer_scd2
[0m19:49:59.833238 [debug] [Thread-1 (]: Writing injected SQL for node "model.raysearch_project.trf_customer_scd2"
[0m19:49:59.837641 [debug] [Thread-1 (]: Began executing node model.raysearch_project.trf_customer_scd2
[0m19:49:59.906698 [debug] [Thread-1 (]: Writing runtime sql for node "model.raysearch_project.trf_customer_scd2"
[0m19:49:59.910451 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_customer_scd2"
[0m19:49:59.911533 [debug] [Thread-1 (]: On model.raysearch_project.trf_customer_scd2: BEGIN
[0m19:49:59.912172 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:49:59.914047 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:49:59.914705 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_customer_scd2"
[0m19:49:59.915337 [debug] [Thread-1 (]: On model.raysearch_project.trf_customer_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_customer_scd2"} */

  
    
    

    create  table
      "warehouse"."main_trf"."trf_customer_scd2__dbt_tmp"
  
    as (
      -- SCD Type 2 using window functions over stg_customer

with src as (
    select
        customer_id,
        country_code,
        customer_state,
        is_vip,
        is_kyc,
        wants_newsletter,
        latest_update_date
    from "warehouse"."main_stg"."stg_customer"
),
-- eliminate duplicates per (customer_id, latest_update_date), keep a single record
unique_per_day as (
    select *
    from (
        select
            *,
            row_number() over (
                partition by customer_id, latest_update_date
                order by latest_update_date desc
            ) as rn
        from src
    ) t
    where rn = 1
),
scd2 as (
    select
        customer_id,
        country_code,
        customer_state,
        is_vip,
        is_kyc,
        wants_newsletter,
        latest_update_date as etl_valid_from,
        lead(latest_update_date) over (
            partition by customer_id
            order by latest_update_date
        ) as next_change_date
    from unique_per_day
)
select
    customer_id,
    country_code,
    customer_state,
    is_vip,
    is_kyc,
    wants_newsletter,
    etl_valid_from,
    case
        when next_change_date is not null then (next_change_date - interval 1 day)::date
        else CAST('9999-12-31' AS DATE)
    end as etl_valid_to,
    case when next_change_date is null then true else false end as is_current
from scd2
    );
  
  
[0m19:49:59.940784 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m19:49:59.950484 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_customer_scd2"
[0m19:49:59.951668 [debug] [Thread-1 (]: On model.raysearch_project.trf_customer_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_customer_scd2"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_trf'
      AND table_name = 'trf_customer_scd2'
  
[0m19:49:59.953752 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:49:59.955938 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_customer_scd2"
[0m19:49:59.956546 [debug] [Thread-1 (]: On model.raysearch_project.trf_customer_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_customer_scd2"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_trf'
      AND table_name = 'trf_customer_scd2'
  
[0m19:49:59.958727 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:49:59.970868 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_customer_scd2"
[0m19:49:59.971736 [debug] [Thread-1 (]: On model.raysearch_project.trf_customer_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_customer_scd2"} */
alter table "warehouse"."main_trf"."trf_customer_scd2" rename to "trf_customer_scd2__dbt_backup"
[0m19:49:59.973834 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:49:59.978987 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_customer_scd2"
[0m19:49:59.979702 [debug] [Thread-1 (]: On model.raysearch_project.trf_customer_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_customer_scd2"} */
alter table "warehouse"."main_trf"."trf_customer_scd2__dbt_tmp" rename to "trf_customer_scd2"
[0m19:49:59.981391 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:50:00.008945 [debug] [Thread-1 (]: On model.raysearch_project.trf_customer_scd2: COMMIT
[0m19:50:00.009944 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_customer_scd2"
[0m19:50:00.010532 [debug] [Thread-1 (]: On model.raysearch_project.trf_customer_scd2: COMMIT
[0m19:50:00.025148 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m19:50:00.037754 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_customer_scd2"
[0m19:50:00.038679 [debug] [Thread-1 (]: On model.raysearch_project.trf_customer_scd2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_customer_scd2"} */

      drop table if exists "warehouse"."main_trf"."trf_customer_scd2__dbt_backup" cascade
    
[0m19:50:00.042254 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:50:00.049178 [debug] [Thread-1 (]: On model.raysearch_project.trf_customer_scd2: Close
[0m19:50:00.055450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bc139ac-8cb3-4d5a-9007-a603df62d336', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A6FCBA210>]}
[0m19:50:00.057711 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_trf.trf_customer_scd2 ................... [[32mOK[0m in 0.23s]
[0m19:50:00.059691 [debug] [Thread-1 (]: Finished running node model.raysearch_project.trf_customer_scd2
[0m19:50:00.062444 [debug] [MainThread]: Using duckdb connection "master"
[0m19:50:00.063087 [debug] [MainThread]: On master: BEGIN
[0m19:50:00.063570 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:50:00.064799 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:50:00.065325 [debug] [MainThread]: On master: COMMIT
[0m19:50:00.065806 [debug] [MainThread]: Using duckdb connection "master"
[0m19:50:00.066228 [debug] [MainThread]: On master: COMMIT
[0m19:50:00.067312 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:50:00.067927 [debug] [MainThread]: On master: Close
[0m19:50:00.068623 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:00.069075 [debug] [MainThread]: Connection 'create_warehouse_main_trf' was properly closed.
[0m19:50:00.069463 [debug] [MainThread]: Connection 'list_warehouse_main_trf' was properly closed.
[0m19:50:00.069866 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m19:50:00.070239 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m19:50:00.070631 [debug] [MainThread]: Connection 'model.raysearch_project.trf_customer_scd2' was properly closed.
[0m19:50:00.071150 [info ] [MainThread]: 
[0m19:50:00.072341 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m19:50:00.074184 [debug] [MainThread]: Command end result
[0m19:50:00.149801 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m19:50:00.159013 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m19:50:00.175867 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m19:50:00.177259 [info ] [MainThread]: 
[0m19:50:00.178865 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:50:00.180818 [info ] [MainThread]: 
[0m19:50:00.182012 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:50:00.185909 [debug] [MainThread]: Command `dbt run` succeeded at 19:50:00.185434 after 3.40 seconds
[0m19:50:00.187126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A6FB23E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A6FD727B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A6FD728F0>]}
[0m19:50:00.188550 [debug] [MainThread]: Flushing usage events
[0m19:50:01.738643 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:59:23.537554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A34B4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A45EFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A45EF9D0>]}


============================== 19:59:23.548851 | 72052c42-f9c5-4b7a-8437-a1a0eaed75fe ==============================
[0m19:59:23.548851 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:59:23.550625 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select trf_transaction', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m19:59:24.071503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72052c42-f9c5-4b7a-8437-a1a0eaed75fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A3926060>]}
[0m19:59:24.218686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72052c42-f9c5-4b7a-8437-a1a0eaed75fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A56327A0>]}
[0m19:59:24.226002 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:59:24.699125 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:59:25.224486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 1 files changed.
[0m19:59:25.225805 [debug] [MainThread]: Partial parsing: added file: raysearch_project://models\transformation\tests\trf_transaction_exchange_on_day.sql
[0m19:59:25.226426 [debug] [MainThread]: Partial parsing: added file: raysearch_project://models\transformation\tests\trf_transaction_customer_on_day.sql
[0m19:59:25.226979 [debug] [MainThread]: Partial parsing: added file: raysearch_project://models/transformation/tests\trf_transaction_exchange_on_day.sql
[0m19:59:25.227500 [debug] [MainThread]: Partial parsing: added file: raysearch_project://models/transformation/tests\trf_transaction_customer_on_day.sql
[0m19:59:25.228206 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models\transformation\trf_transaction.sql
[0m19:59:26.178900 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`
defined on 'trf_transaction' in package 'raysearch_project'
(models\transformation\trf_schema.yml). Arguments to generic tests should be
nested under the `arguments` property.
[0m19:59:26.180670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '72052c42-f9c5-4b7a-8437-a1a0eaed75fe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A5F2C650>]}
[0m19:59:26.369157 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.raysearch_project.marts
[0m19:59:26.383547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72052c42-f9c5-4b7a-8437-a1a0eaed75fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A5BF26C0>]}
[0m19:59:26.598155 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m19:59:26.606416 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m19:59:26.684816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72052c42-f9c5-4b7a-8437-a1a0eaed75fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A5D29FD0>]}
[0m19:59:26.686087 [info ] [MainThread]: Found 8 models, 1 snapshot, 3 seeds, 31 data tests, 586 macros
[0m19:59:26.687550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72052c42-f9c5-4b7a-8437-a1a0eaed75fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A601E340>]}
[0m19:59:26.691393 [info ] [MainThread]: 
[0m19:59:26.692737 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:59:26.694959 [info ] [MainThread]: 
[0m19:59:26.696794 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:59:26.698933 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m19:59:26.986642 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m19:59:26.987450 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m19:59:26.987935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:27.028447 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m19:59:27.031057 [debug] [ThreadPool]: On list_warehouse: Close
[0m19:59:27.032557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_trf)
[0m19:59:27.033642 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_trf"
"
[0m19:59:27.044979 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:59:27.045745 [debug] [ThreadPool]: On create_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_trf"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m19:59:27.046260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:27.048357 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:59:27.050737 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:59:27.051315 [debug] [ThreadPool]: On create_warehouse_main_trf: BEGIN
[0m19:59:27.052319 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:59:27.052854 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:59:27.053272 [debug] [ThreadPool]: On create_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_trf"} */

    
    
        create schema if not exists "warehouse"."main_trf"
    
[0m19:59:27.054243 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:59:27.055678 [debug] [ThreadPool]: On create_warehouse_main_trf: COMMIT
[0m19:59:27.056265 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m19:59:27.056712 [debug] [ThreadPool]: On create_warehouse_main_trf: COMMIT
[0m19:59:27.057586 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:59:27.058184 [debug] [ThreadPool]: On create_warehouse_main_trf: Close
[0m19:59:27.068657 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_trf'
[0m19:59:27.079119 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m19:59:27.080185 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m19:59:27.080825 [debug] [ThreadPool]: On list_warehouse_main_trf: BEGIN
[0m19:59:27.084167 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m19:59:27.084772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:27.085508 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m19:59:27.086125 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m19:59:27.094259 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m19:59:27.095149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:27.095797 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m19:59:27.096435 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m19:59:27.097451 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m19:59:27.097961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:27.098482 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m19:59:27.099029 [debug] [ThreadPool]: On list_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_trf"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_trf'
    and lower(table_catalog) = 'warehouse'
  
[0m19:59:27.100041 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m19:59:27.100913 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m19:59:27.101532 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m19:59:27.102304 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m19:59:27.103247 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m19:59:27.129411 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m19:59:27.130601 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m19:59:27.131252 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m19:59:27.133867 [debug] [ThreadPool]: On list_warehouse_main_trf: ROLLBACK
[0m19:59:27.136424 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m19:59:27.138438 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m19:59:27.142126 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_trf'
[0m19:59:27.142764 [debug] [ThreadPool]: On list_warehouse_main_trf: Close
[0m19:59:27.145826 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m19:59:27.146489 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m19:59:27.148613 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m19:59:27.149135 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m19:59:27.151551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72052c42-f9c5-4b7a-8437-a1a0eaed75fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A5ED9F10>]}
[0m19:59:27.152410 [debug] [MainThread]: Using duckdb connection "master"
[0m19:59:27.152879 [debug] [MainThread]: On master: BEGIN
[0m19:59:27.153328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:59:27.154477 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:59:27.155013 [debug] [MainThread]: On master: COMMIT
[0m19:59:27.155547 [debug] [MainThread]: Using duckdb connection "master"
[0m19:59:27.156029 [debug] [MainThread]: On master: COMMIT
[0m19:59:27.157258 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:59:27.157793 [debug] [MainThread]: On master: Close
[0m19:59:27.165318 [debug] [Thread-1 (]: Began running node model.raysearch_project.trf_transaction
[0m19:59:27.166346 [info ] [Thread-1 (]: 1 of 1 START sql table model main_trf.trf_transaction .......................... [RUN]
[0m19:59:27.167752 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.raysearch_project.trf_transaction'
[0m19:59:27.168428 [debug] [Thread-1 (]: Began compiling node model.raysearch_project.trf_transaction
[0m19:59:27.183813 [debug] [Thread-1 (]: Writing injected SQL for node "model.raysearch_project.trf_transaction"
[0m19:59:27.186543 [debug] [Thread-1 (]: Began executing node model.raysearch_project.trf_transaction
[0m19:59:27.246929 [debug] [Thread-1 (]: Writing runtime sql for node "model.raysearch_project.trf_transaction"
[0m19:59:27.249992 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_transaction"
[0m19:59:27.251105 [debug] [Thread-1 (]: On model.raysearch_project.trf_transaction: BEGIN
[0m19:59:27.251898 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:59:27.253815 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:59:27.254489 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_transaction"
[0m19:59:27.255100 [debug] [Thread-1 (]: On model.raysearch_project.trf_transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_transaction"} */

  
    
    

    create  table
      "warehouse"."main_trf"."trf_transaction__dbt_tmp"
  
    as (
      with st as (
    select * from "warehouse"."main_stg"."stg_transaction"
),
cust as (
    select * from "warehouse"."main_trf"."trf_customer_scd2"
),
curr_exc as (
    select * from "warehouse"."main_trf"."trf_currency_exchange_scd2"
),
joined as (
    select
        st.transaction_date,
        st.customer_id,
        cust.country_code,
        st.account_type,
        st.transaction_type,
        st.amount * curr_exc.base_rate_eur as amount
    from st
    inner join cust
        on st.customer_id = cust.customer_id
       and st.transaction_date between cust.etl_valid_from and cust.etl_valid_to
    left join curr_exc
        on st.transaction_date between curr_exc.etl_valid_from and coalesce(curr_exc.etl_valid_to, current_date)
        and st.currency = curr_exc.currency_code
),
agg as (
    select
        transaction_date,
        customer_id,
        country_code,
        account_type,
        sum(case when transaction_type = 'WITHDRAWAL' then amount else 0 end) as withdrawal,
        sum(case when transaction_type = 'DEPOSIT' then amount else 0 end) as deposit
    from joined
    group by transaction_date, customer_id, country_code, account_type
)
select * from agg
    );
  
  
[0m19:59:27.312725 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m19:59:27.324619 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_transaction"
[0m19:59:27.325723 [debug] [Thread-1 (]: On model.raysearch_project.trf_transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_transaction"} */
alter table "warehouse"."main_trf"."trf_transaction__dbt_tmp" rename to "trf_transaction"
[0m19:59:27.327785 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:59:27.351329 [debug] [Thread-1 (]: On model.raysearch_project.trf_transaction: COMMIT
[0m19:59:27.352211 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_transaction"
[0m19:59:27.352750 [debug] [Thread-1 (]: On model.raysearch_project.trf_transaction: COMMIT
[0m19:59:27.368978 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m19:59:27.382777 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_transaction"
[0m19:59:27.383791 [debug] [Thread-1 (]: On model.raysearch_project.trf_transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_transaction"} */

      drop table if exists "warehouse"."main_trf"."trf_transaction__dbt_backup" cascade
    
[0m19:59:27.385400 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:59:27.390221 [debug] [Thread-1 (]: On model.raysearch_project.trf_transaction: Close
[0m19:59:27.396005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72052c42-f9c5-4b7a-8437-a1a0eaed75fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A60F1F40>]}
[0m19:59:27.397668 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_trf.trf_transaction ..................... [[32mOK[0m in 0.22s]
[0m19:59:27.399521 [debug] [Thread-1 (]: Finished running node model.raysearch_project.trf_transaction
[0m19:59:27.403145 [debug] [MainThread]: Using duckdb connection "master"
[0m19:59:27.403881 [debug] [MainThread]: On master: BEGIN
[0m19:59:27.404407 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:59:27.405692 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:59:27.406364 [debug] [MainThread]: On master: COMMIT
[0m19:59:27.407026 [debug] [MainThread]: Using duckdb connection "master"
[0m19:59:27.407544 [debug] [MainThread]: On master: COMMIT
[0m19:59:27.409263 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:59:27.409899 [debug] [MainThread]: On master: Close
[0m19:59:27.410650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:59:27.411088 [debug] [MainThread]: Connection 'create_warehouse_main_trf' was properly closed.
[0m19:59:27.411473 [debug] [MainThread]: Connection 'list_warehouse_main_trf' was properly closed.
[0m19:59:27.411845 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m19:59:27.412253 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m19:59:27.412621 [debug] [MainThread]: Connection 'model.raysearch_project.trf_transaction' was properly closed.
[0m19:59:27.413189 [info ] [MainThread]: 
[0m19:59:27.414493 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m19:59:27.416289 [debug] [MainThread]: Command end result
[0m19:59:27.476891 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m19:59:27.483749 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m19:59:27.499268 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m19:59:27.500258 [info ] [MainThread]: 
[0m19:59:27.501413 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:59:27.502354 [info ] [MainThread]: 
[0m19:59:27.503224 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:59:27.504484 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:59:27.507475 [debug] [MainThread]: Command `dbt run` succeeded at 19:59:27.507121 after 4.29 seconds
[0m19:59:27.508243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A634ACB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A625A600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8A638AE50>]}
[0m19:59:27.508910 [debug] [MainThread]: Flushing usage events
[0m19:59:28.781654 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:59:43.916047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFA904830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFBA3FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFBA3F9D0>]}


============================== 19:59:43.931234 | ca867112-6d8a-49b3-b622-e07e0298917b ==============================
[0m19:59:43.931234 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:59:43.933032 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt test', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m19:59:45.016174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca867112-6d8a-49b3-b622-e07e0298917b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFAD76060>]}
[0m19:59:45.156691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca867112-6d8a-49b3-b622-e07e0298917b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFCA827A0>]}
[0m19:59:45.218642 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m19:59:46.356255 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:59:55.401520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:59:55.402532 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:59:55.403089 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:59:55.417014 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.raysearch_project.marts
[0m19:59:55.541778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca867112-6d8a-49b3-b622-e07e0298917b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFCEF6C50>]}
[0m19:59:55.891494 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m19:59:55.956104 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m19:59:56.077014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca867112-6d8a-49b3-b622-e07e0298917b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFD210230>]}
[0m19:59:56.078034 [info ] [MainThread]: Found 8 models, 1 snapshot, 3 seeds, 31 data tests, 586 macros
[0m19:59:56.079340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca867112-6d8a-49b3-b622-e07e0298917b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFD0735B0>]}
[0m19:59:56.085670 [info ] [MainThread]: 
[0m19:59:56.086916 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:59:56.088288 [info ] [MainThread]: 
[0m19:59:56.089542 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:59:56.102558 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_trf'
[0m19:59:56.104841 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m19:59:56.119534 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m20:00:10.980329 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m20:00:10.981447 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m20:00:10.982138 [debug] [ThreadPool]: On list_warehouse_main_trf: BEGIN
[0m20:00:10.982914 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m20:00:10.983653 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m20:00:10.984348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:10.985021 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m20:00:10.985646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:10.987110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:11.068821 [debug] [ThreadPool]: SQL status: OK in 0.084 seconds
[0m20:00:11.069705 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m20:00:11.071015 [debug] [ThreadPool]: On list_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_trf"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_trf'
    and lower(table_catalog) = 'warehouse'
  
[0m20:00:11.072635 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m20:00:11.073532 [debug] [ThreadPool]: SQL status: OK in 0.088 seconds
[0m20:00:11.074520 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m20:00:11.075883 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m20:00:11.077096 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m20:00:11.078132 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m20:00:11.108564 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m20:00:11.111627 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m20:00:11.112592 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m20:00:11.113569 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m20:00:11.118129 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m20:00:11.121444 [debug] [ThreadPool]: On list_warehouse_main_trf: ROLLBACK
[0m20:00:11.182929 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m20:00:11.183881 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m20:00:11.188335 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m20:00:11.189971 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m20:00:11.193126 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_trf'
[0m20:00:11.193775 [debug] [ThreadPool]: On list_warehouse_main_trf: Close
[0m20:00:11.196630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca867112-6d8a-49b3-b622-e07e0298917b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFD21BC70>]}
[0m20:00:11.197598 [debug] [MainThread]: Using duckdb connection "master"
[0m20:00:11.198066 [debug] [MainThread]: On master: BEGIN
[0m20:00:11.198501 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:00:11.199681 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:00:11.200197 [debug] [MainThread]: On master: COMMIT
[0m20:00:11.200618 [debug] [MainThread]: Using duckdb connection "master"
[0m20:00:11.201011 [debug] [MainThread]: On master: COMMIT
[0m20:00:11.201812 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:00:11.202303 [debug] [MainThread]: On master: Close
[0m20:00:11.217574 [debug] [Thread-3 (]: Began running node test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb
[0m20:00:11.218567 [debug] [Thread-2 (]: Began running node test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773
[0m20:00:11.219399 [debug] [Thread-1 (]: Began running node test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c
[0m20:00:11.221265 [debug] [Thread-4 (]: Began running node test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41
[0m20:00:11.220447 [info ] [Thread-3 (]: 3 of 31 START test accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE . [RUN]
[0m20:00:11.222744 [info ] [Thread-2 (]: 2 of 31 START test accepted_values_customer_VIP__0__1 .......................... [RUN]
[0m20:00:11.225947 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb'
[0m20:00:11.223647 [info ] [Thread-1 (]: 1 of 31 START test accepted_values_customer_KYC__0__1 .......................... [RUN]
[0m20:00:11.227985 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb
[0m20:00:11.228641 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773'
[0m20:00:11.230023 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c'
[0m20:00:11.224522 [info ] [Thread-4 (]: 4 of 31 START test accepted_values_customer_wantsNewsletter__0__1 .............. [RUN]
[0m20:00:11.245918 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773
[0m20:00:11.267826 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"
[0m20:00:11.269032 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c
[0m20:00:11.270640 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41'
[0m20:00:11.279499 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"
[0m20:00:11.288793 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"
[0m20:00:11.290354 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41
[0m20:00:11.298806 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"
[0m20:00:11.299937 [debug] [Thread-3 (]: Began executing node test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb
[0m20:00:11.324878 [debug] [Thread-1 (]: Began executing node test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c
[0m20:00:11.336240 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"
[0m20:00:11.341299 [debug] [Thread-2 (]: Began executing node test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773
[0m20:00:11.340903 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"
[0m20:00:11.350665 [debug] [Thread-4 (]: Began executing node test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41
[0m20:00:11.353896 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"
[0m20:00:11.358092 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"
[0m20:00:11.359527 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"
[0m20:00:11.360679 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb: BEGIN
[0m20:00:11.361479 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:00:11.363417 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:00:11.364272 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"
[0m20:00:11.364982 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"
[0m20:00:11.365635 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"
[0m20:00:11.366237 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c: BEGIN
[0m20:00:11.366981 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"
[0m20:00:11.367873 [debug] [Thread-4 (]: On test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41: BEGIN
[0m20:00:11.368757 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."customer"
    group by state

)

select *
from all_values
where value_field not in (
    'VALIDATED','SIGNUP','INACTIVE'
)



  
  
      
    ) dbt_internal_test
[0m20:00:11.369547 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:00:11.370330 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773: BEGIN
[0m20:00:11.371084 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:00:11.372817 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:00:11.374418 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:00:11.375103 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"
[0m20:00:11.375740 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:00:11.376375 [debug] [Thread-4 (]: On test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        wantsNewsletter as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."customer"
    group by wantsNewsletter

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  
      
    ) dbt_internal_test
[0m20:00:11.377017 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:00:11.377568 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m20:00:11.378194 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"
[0m20:00:11.379261 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"
[0m20:00:11.380198 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        VIP as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."customer"
    group by VIP

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  
      
    ) dbt_internal_test
[0m20:00:11.388025 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb: ROLLBACK
[0m20:00:11.388944 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        KYC as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."customer"
    group by KYC

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  
      
    ) dbt_internal_test
[0m20:00:11.389622 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m20:00:11.392433 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:00:11.393646 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb'
[0m20:00:11.396519 [debug] [Thread-4 (]: On test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41: ROLLBACK
[0m20:00:11.397586 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:00:11.400481 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773: ROLLBACK
[0m20:00:11.401226 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb: Close
[0m20:00:11.404575 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c: ROLLBACK
[0m20:00:11.406272 [info ] [Thread-3 (]: 3 of 31 PASS accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE ....... [[32mPASS[0m in 0.18s]
[0m20:00:11.408382 [debug] [Thread-3 (]: Finished running node test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb
[0m20:00:11.409494 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41'
[0m20:00:11.410250 [debug] [Thread-3 (]: Began running node test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a
[0m20:00:11.411170 [debug] [Thread-4 (]: On test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41: Close
[0m20:00:11.411884 [info ] [Thread-3 (]: 5 of 31 START test accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL ..... [RUN]
[0m20:00:11.413428 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773'
[0m20:00:11.414580 [info ] [Thread-4 (]: 4 of 31 PASS accepted_values_customer_wantsNewsletter__0__1 .................... [[32mPASS[0m in 0.14s]
[0m20:00:11.415655 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb, now test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a)
[0m20:00:11.417586 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773: Close
[0m20:00:11.418933 [debug] [Thread-4 (]: Finished running node test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41
[0m20:00:11.420094 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a
[0m20:00:11.422056 [debug] [Thread-4 (]: Began running node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date.1f2c3ce24e
[0m20:00:11.423905 [info ] [Thread-2 (]: 2 of 31 PASS accepted_values_customer_VIP__0__1 ................................ [[32mPASS[0m in 0.20s]
[0m20:00:11.433957 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c'
[0m20:00:11.434895 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"
[0m20:00:11.436923 [debug] [Thread-2 (]: Finished running node test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773
[0m20:00:11.438075 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c: Close
[0m20:00:11.435621 [info ] [Thread-4 (]: 6 of 31 START test dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date  [RUN]
[0m20:00:11.440299 [debug] [Thread-2 (]: Began running node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49
[0m20:00:11.444013 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41, now test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date.1f2c3ce24e)
[0m20:00:11.443034 [info ] [Thread-1 (]: 1 of 31 PASS accepted_values_customer_KYC__0__1 ................................ [[32mPASS[0m in 0.21s]
[0m20:00:11.445022 [debug] [Thread-3 (]: Began executing node test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a
[0m20:00:11.446372 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date.1f2c3ce24e
[0m20:00:11.447376 [debug] [Thread-1 (]: Finished running node test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c
[0m20:00:11.445755 [info ] [Thread-2 (]: 7 of 31 START test dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from  [RUN]
[0m20:00:11.454555 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"
[0m20:00:11.465859 [debug] [Thread-1 (]: Began running node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78
[0m20:00:11.478810 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date.1f2c3ce24e"
[0m20:00:11.479889 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773, now test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49)
[0m20:00:11.481007 [info ] [Thread-1 (]: 8 of 31 START test dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type  [RUN]
[0m20:00:11.482293 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49
[0m20:00:11.483214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c, now test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78)
[0m20:00:11.495718 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49"
[0m20:00:11.496787 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78
[0m20:00:11.499244 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"
[0m20:00:11.500073 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a: BEGIN
[0m20:00:11.510391 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78"
[0m20:00:11.511703 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:11.512412 [debug] [Thread-4 (]: Began executing node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date.1f2c3ce24e
[0m20:00:11.514112 [debug] [Thread-2 (]: Began executing node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49
[0m20:00:11.518844 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date.1f2c3ce24e"
[0m20:00:11.524926 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49"
[0m20:00:11.525913 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m20:00:11.527017 [debug] [Thread-1 (]: Began executing node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78
[0m20:00:11.527711 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"
[0m20:00:11.532990 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        txType as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."transaction"
    group by txType

)

select *
from all_values
where value_field not in (
    'DEPOSIT','WITHDRAWAL'
)



  
  
      
    ) dbt_internal_test
[0m20:00:11.531781 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78"
[0m20:00:11.535183 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date.1f2c3ce24e"
[0m20:00:11.536499 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49"
[0m20:00:11.538869 [debug] [Thread-4 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date.1f2c3ce24e: BEGIN
[0m20:00:11.540056 [debug] [Thread-2 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49: BEGIN
[0m20:00:11.540862 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:11.541523 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m20:00:11.542558 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:11.544035 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78"
[0m20:00:11.545133 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:00:11.546129 [debug] [Thread-1 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78: BEGIN
[0m20:00:11.550364 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a: ROLLBACK
[0m20:00:11.551331 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date.1f2c3ce24e"
[0m20:00:11.552054 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m20:00:11.552829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:11.554296 [debug] [Thread-4 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date.1f2c3ce24e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date.1f2c3ce24e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        currency_code, effective_start_date
    from "warehouse"."main_trf"."trf_currency_exchange_scd2"
    group by currency_code, effective_start_date
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m20:00:11.555843 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49"
[0m20:00:11.557433 [debug] [Thread-2 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        customer_id, etl_valid_from
    from "warehouse"."main_trf"."trf_customer_scd2"
    group by customer_id, etl_valid_from
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m20:00:11.559110 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:00:11.560247 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date.1f2c3ce24e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        currency_code, effective_start_date
    from "warehouse"."main_trf"."trf_currency_exchange_scd2"
    group by currency_code, effective_start_date
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m20:00:11.561212 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78"
[0m20:00:11.562106 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m20:00:11.563091 [debug] [Thread-1 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        transaction_date, customer_id, country_code, account_type
    from "warehouse"."main_trf"."trf_transaction"
    group by transaction_date, customer_id, country_code, account_type
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m20:00:11.564095 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m20:00:11.564951 [debug] [Thread-4 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date.1f2c3ce24e: ROLLBACK
[0m20:00:11.565968 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a'
[0m20:00:11.570235 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a: Close
[0m20:00:11.569173 [debug] [Thread-2 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49: ROLLBACK
[0m20:00:11.572573 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:00:11.571421 [info ] [Thread-3 (]: 5 of 31 PASS accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL ........... [[32mPASS[0m in 0.16s]
[0m20:00:11.574571 [debug] [Thread-3 (]: Finished running node test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a
[0m20:00:11.577558 [debug] [Thread-1 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78: ROLLBACK
[0m20:00:11.578475 [debug] [Thread-3 (]: Began running node test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff
[0m20:00:11.579701 [info ] [Thread-3 (]: 9 of 31 START test not_null_currency_exchange_baseRateEuro ..................... [RUN]
[0m20:00:11.580934 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a, now test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff)
[0m20:00:11.581929 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff
[0m20:00:11.594315 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"
[0m20:00:11.597747 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49'
[0m20:00:11.598971 [debug] [Thread-2 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49: Close
[0m20:00:11.601121 [info ] [Thread-2 (]: 7 of 31 PASS dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from  [[32mPASS[0m in 0.12s]
[0m20:00:11.603652 [debug] [Thread-3 (]: Began executing node test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff
[0m20:00:11.607308 [debug] [Thread-2 (]: Finished running node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49
[0m20:00:11.612986 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"
[0m20:00:11.614337 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78'
[0m20:00:11.615134 [debug] [Thread-2 (]: Began running node test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f
[0m20:00:11.616192 [debug] [Thread-1 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78: Close
[0m20:00:11.616931 [info ] [Thread-2 (]: 10 of 31 START test not_null_currency_exchange_currency ........................ [RUN]
[0m20:00:11.619216 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49, now test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f)
[0m20:00:11.619882 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f
[0m20:00:11.629052 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"
[0m20:00:11.618276 [info ] [Thread-1 (]: 8 of 31 PASS dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type  [[32mPASS[0m in 0.13s]
[0m20:00:11.632004 [debug] [Thread-1 (]: Finished running node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78
[0m20:00:11.630957 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"
[0m20:00:11.633493 [debug] [Thread-1 (]: Began running node test.raysearch_project.not_null_currency_exchange_date.f508e913b3
[0m20:00:11.634424 [debug] [Thread-3 (]: On test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff: BEGIN
[0m20:00:11.636120 [debug] [Thread-2 (]: Began executing node test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f
[0m20:00:11.637081 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:11.635450 [info ] [Thread-1 (]: 11 of 31 START test not_null_currency_exchange_date ............................ [RUN]
[0m20:00:11.643497 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"
[0m20:00:11.644549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78, now test.raysearch_project.not_null_currency_exchange_date.f508e913b3)
[0m20:00:11.646003 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m20:00:11.646680 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.not_null_currency_exchange_date.f508e913b3
[0m20:00:11.647422 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"
[0m20:00:11.656896 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"
[0m20:00:11.658481 [debug] [Thread-3 (]: On test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select baseRateEuro
from "warehouse"."main_raw"."currency_exchange"
where baseRateEuro is null



  
  
      
    ) dbt_internal_test
[0m20:00:11.660140 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"
[0m20:00:11.661760 [debug] [Thread-2 (]: On test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f: BEGIN
[0m20:00:11.662712 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:11.663591 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:00:11.666887 [debug] [Thread-3 (]: On test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff: ROLLBACK
[0m20:00:11.667830 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m20:00:11.668435 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"
[0m20:00:11.668993 [debug] [Thread-2 (]: On test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from "warehouse"."main_raw"."currency_exchange"
where currency is null



  
  
      
    ) dbt_internal_test
[0m20:00:11.670945 [debug] [Thread-1 (]: Began executing node test.raysearch_project.not_null_currency_exchange_date.f508e913b3
[0m20:00:11.677053 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"
[0m20:00:11.678442 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m20:00:11.681349 [debug] [Thread-2 (]: On test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f: ROLLBACK
[0m20:00:11.682844 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff'
[0m20:00:11.683502 [debug] [Thread-3 (]: On test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff: Close
[0m20:00:11.685620 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"
[0m20:00:11.684690 [info ] [Thread-3 (]: 9 of 31 PASS not_null_currency_exchange_baseRateEuro ........................... [[32mPASS[0m in 0.10s]
[0m20:00:11.687232 [debug] [Thread-1 (]: On test.raysearch_project.not_null_currency_exchange_date.f508e913b3: BEGIN
[0m20:00:11.689392 [debug] [Thread-3 (]: Finished running node test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff
[0m20:00:11.691180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:11.692200 [debug] [Thread-3 (]: Began running node test.raysearch_project.not_null_customer_customerID.cdb9e51021
[0m20:00:11.693244 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f'
[0m20:00:11.695440 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:00:11.696070 [debug] [Thread-2 (]: On test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f: Close
[0m20:00:11.694707 [info ] [Thread-3 (]: 12 of 31 START test not_null_customer_customerID ............................... [RUN]
[0m20:00:11.697134 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"
[0m20:00:11.699100 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff, now test.raysearch_project.not_null_customer_customerID.cdb9e51021)
[0m20:00:11.698371 [info ] [Thread-2 (]: 10 of 31 PASS not_null_currency_exchange_currency .............................. [[32mPASS[0m in 0.08s]
[0m20:00:11.700115 [debug] [Thread-1 (]: On test.raysearch_project.not_null_currency_exchange_date.f508e913b3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_raw"."currency_exchange"
where date is null



  
  
      
    ) dbt_internal_test
[0m20:00:11.700829 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.not_null_customer_customerID.cdb9e51021
[0m20:00:11.701728 [debug] [Thread-2 (]: Finished running node test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f
[0m20:00:11.710893 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.not_null_customer_customerID.cdb9e51021"
[0m20:00:11.711945 [debug] [Thread-2 (]: Began running node test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b
[0m20:00:11.712675 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m20:00:11.713683 [info ] [Thread-2 (]: 13 of 31 START test not_null_customer_latestUpdate ............................. [RUN]
[0m20:00:11.715855 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f, now test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b)
[0m20:00:11.719330 [debug] [Thread-1 (]: On test.raysearch_project.not_null_currency_exchange_date.f508e913b3: ROLLBACK
[0m20:00:11.720762 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b
[0m20:00:11.730492 [debug] [Thread-3 (]: Began executing node test.raysearch_project.not_null_customer_customerID.cdb9e51021
[0m20:00:11.735169 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.not_null_customer_customerID.cdb9e51021"
[0m20:00:11.736398 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"
[0m20:00:11.739849 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.not_null_currency_exchange_date.f508e913b3'
[0m20:00:11.741931 [debug] [Thread-1 (]: On test.raysearch_project.not_null_currency_exchange_date.f508e913b3: Close
[0m20:00:11.742891 [debug] [Thread-2 (]: Began executing node test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b
[0m20:00:11.743767 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_customer_customerID.cdb9e51021"
[0m20:00:11.748090 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"
[0m20:00:11.749708 [debug] [Thread-3 (]: On test.raysearch_project.not_null_customer_customerID.cdb9e51021: BEGIN
[0m20:00:11.749061 [info ] [Thread-1 (]: 11 of 31 PASS not_null_currency_exchange_date .................................. [[32mPASS[0m in 0.10s]
[0m20:00:11.751017 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:11.752606 [debug] [Thread-1 (]: Finished running node test.raysearch_project.not_null_currency_exchange_date.f508e913b3
[0m20:00:11.754555 [debug] [Thread-1 (]: Began running node test.raysearch_project.not_null_transaction_amount.8ca6f973e6
[0m20:00:11.756505 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m20:00:11.757476 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_customer_customerID.cdb9e51021"
[0m20:00:11.758667 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"
[0m20:00:11.759513 [debug] [Thread-3 (]: On test.raysearch_project.not_null_customer_customerID.cdb9e51021: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_customer_customerID.cdb9e51021"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customerID
from "warehouse"."main_raw"."customer"
where customerID is null



  
  
      
    ) dbt_internal_test
[0m20:00:11.755861 [info ] [Thread-1 (]: 14 of 31 START test not_null_transaction_amount ................................ [RUN]
[0m20:00:11.760812 [debug] [Thread-2 (]: On test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b: BEGIN
[0m20:00:11.762341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_currency_exchange_date.f508e913b3, now test.raysearch_project.not_null_transaction_amount.8ca6f973e6)
[0m20:00:11.763073 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:11.763719 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.not_null_transaction_amount.8ca6f973e6
[0m20:00:11.764325 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:00:11.773844 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"
[0m20:00:11.775461 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m20:00:11.778906 [debug] [Thread-3 (]: On test.raysearch_project.not_null_customer_customerID.cdb9e51021: ROLLBACK
[0m20:00:11.780215 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"
[0m20:00:11.781668 [debug] [Thread-2 (]: On test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latestUpdate
from "warehouse"."main_raw"."customer"
where latestUpdate is null



  
  
      
    ) dbt_internal_test
[0m20:00:11.783837 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.not_null_customer_customerID.cdb9e51021'
[0m20:00:11.785062 [debug] [Thread-1 (]: Began executing node test.raysearch_project.not_null_transaction_amount.8ca6f973e6
[0m20:00:11.785867 [debug] [Thread-3 (]: On test.raysearch_project.not_null_customer_customerID.cdb9e51021: Close
[0m20:00:11.786621 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:00:11.793325 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"
[0m20:00:11.797807 [debug] [Thread-2 (]: On test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b: ROLLBACK
[0m20:00:11.794928 [info ] [Thread-3 (]: 12 of 31 PASS not_null_customer_customerID ..................................... [[32mPASS[0m in 0.10s]
[0m20:00:11.799939 [debug] [Thread-3 (]: Finished running node test.raysearch_project.not_null_customer_customerID.cdb9e51021
[0m20:00:11.800618 [debug] [Thread-3 (]: Began running node test.raysearch_project.not_null_transaction_customerId.63105569e2
[0m20:00:11.801190 [info ] [Thread-3 (]: 15 of 31 START test not_null_transaction_customerId ............................ [RUN]
[0m20:00:11.802703 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b'
[0m20:00:11.804016 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_customer_customerID.cdb9e51021, now test.raysearch_project.not_null_transaction_customerId.63105569e2)
[0m20:00:11.804913 [debug] [Thread-2 (]: On test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b: Close
[0m20:00:11.806053 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.not_null_transaction_customerId.63105569e2
[0m20:00:11.807644 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"
[0m20:00:11.816387 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.not_null_transaction_customerId.63105569e2"
[0m20:00:11.808842 [info ] [Thread-2 (]: 13 of 31 PASS not_null_customer_latestUpdate ................................... [[32mPASS[0m in 0.09s]
[0m20:00:11.817485 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_amount.8ca6f973e6: BEGIN
[0m20:00:11.818627 [debug] [Thread-2 (]: Finished running node test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b
[0m20:00:11.819516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:11.821089 [debug] [Thread-2 (]: Began running node test.raysearch_project.not_null_transaction_date.8d1d66da2c
[0m20:00:11.824548 [debug] [Thread-3 (]: Began executing node test.raysearch_project.not_null_transaction_customerId.63105569e2
[0m20:00:11.823518 [info ] [Thread-2 (]: 16 of 31 START test not_null_transaction_date .................................. [RUN]
[0m20:00:11.825892 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:00:11.830538 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.not_null_transaction_customerId.63105569e2"
[0m20:00:11.831514 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b, now test.raysearch_project.not_null_transaction_date.8d1d66da2c)
[0m20:00:11.832284 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"
[0m20:00:11.833104 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.not_null_transaction_date.8d1d66da2c
[0m20:00:11.833747 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_amount.8ca6f973e6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "warehouse"."main_raw"."transaction"
where amount is null



  
  
      
    ) dbt_internal_test
[0m20:00:11.842052 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.not_null_transaction_date.8d1d66da2c"
[0m20:00:11.844450 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_customerId.63105569e2"
[0m20:00:11.845182 [debug] [Thread-3 (]: On test.raysearch_project.not_null_transaction_customerId.63105569e2: BEGIN
[0m20:00:11.845846 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:00:11.846511 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:11.847654 [debug] [Thread-2 (]: Began executing node test.raysearch_project.not_null_transaction_date.8d1d66da2c
[0m20:00:11.850221 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_amount.8ca6f973e6: ROLLBACK
[0m20:00:11.856362 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.not_null_transaction_date.8d1d66da2c"
[0m20:00:11.858142 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m20:00:11.859766 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_customerId.63105569e2"
[0m20:00:11.860737 [debug] [Thread-3 (]: On test.raysearch_project.not_null_transaction_customerId.63105569e2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_transaction_customerId.63105569e2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customerId
from "warehouse"."main_raw"."transaction"
where customerId is null



  
  
      
    ) dbt_internal_test
[0m20:00:11.862803 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.not_null_transaction_amount.8ca6f973e6'
[0m20:00:11.863500 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_amount.8ca6f973e6: Close
[0m20:00:11.864296 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_date.8d1d66da2c"
[0m20:00:11.864870 [debug] [Thread-2 (]: On test.raysearch_project.not_null_transaction_date.8d1d66da2c: BEGIN
[0m20:00:11.865384 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:11.867517 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m20:00:11.868311 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:00:11.866729 [info ] [Thread-1 (]: 14 of 31 PASS not_null_transaction_amount ...................................... [[32mPASS[0m in 0.10s]
[0m20:00:11.872767 [debug] [Thread-3 (]: On test.raysearch_project.not_null_transaction_customerId.63105569e2: ROLLBACK
[0m20:00:11.873794 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_date.8d1d66da2c"
[0m20:00:11.875375 [debug] [Thread-1 (]: Finished running node test.raysearch_project.not_null_transaction_amount.8ca6f973e6
[0m20:00:11.876271 [debug] [Thread-2 (]: On test.raysearch_project.not_null_transaction_date.8d1d66da2c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_transaction_date.8d1d66da2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_raw"."transaction"
where date is null



  
  
      
    ) dbt_internal_test
[0m20:00:11.877683 [debug] [Thread-1 (]: Began running node test.raysearch_project.not_null_transaction_txCurrency.7798fc4041
[0m20:00:11.879127 [info ] [Thread-1 (]: 17 of 31 START test not_null_transaction_txCurrency ............................ [RUN]
[0m20:00:11.880821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_transaction_amount.8ca6f973e6, now test.raysearch_project.not_null_transaction_txCurrency.7798fc4041)
[0m20:00:11.881517 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.not_null_transaction_txCurrency.7798fc4041
[0m20:00:11.882250 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:00:11.901739 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"
[0m20:00:11.903786 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.not_null_transaction_customerId.63105569e2'
[0m20:00:11.904955 [debug] [Thread-3 (]: On test.raysearch_project.not_null_transaction_customerId.63105569e2: Close
[0m20:00:11.909261 [debug] [Thread-2 (]: On test.raysearch_project.not_null_transaction_date.8d1d66da2c: ROLLBACK
[0m20:00:11.910680 [info ] [Thread-3 (]: 15 of 31 PASS not_null_transaction_customerId .................................. [[32mPASS[0m in 0.11s]
[0m20:00:11.912371 [debug] [Thread-3 (]: Finished running node test.raysearch_project.not_null_transaction_customerId.63105569e2
[0m20:00:11.913545 [debug] [Thread-1 (]: Began executing node test.raysearch_project.not_null_transaction_txCurrency.7798fc4041
[0m20:00:11.914343 [debug] [Thread-3 (]: Began running node test.raysearch_project.not_null_trf_currency_exchange_scd2_base_rate_eur.f7fd803fa4
[0m20:00:11.919185 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.not_null_transaction_date.8d1d66da2c'
[0m20:00:11.923007 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"
[0m20:00:11.924437 [debug] [Thread-2 (]: On test.raysearch_project.not_null_transaction_date.8d1d66da2c: Close
[0m20:00:11.917106 [info ] [Thread-3 (]: 18 of 31 START test not_null_trf_currency_exchange_scd2_base_rate_eur .......... [RUN]
[0m20:00:11.926938 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_transaction_customerId.63105569e2, now test.raysearch_project.not_null_trf_currency_exchange_scd2_base_rate_eur.f7fd803fa4)
[0m20:00:11.927689 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.not_null_trf_currency_exchange_scd2_base_rate_eur.f7fd803fa4
[0m20:00:11.937162 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.not_null_trf_currency_exchange_scd2_base_rate_eur.f7fd803fa4"
[0m20:00:11.928772 [info ] [Thread-2 (]: 16 of 31 PASS not_null_transaction_date ........................................ [[32mPASS[0m in 0.10s]
[0m20:00:11.940352 [debug] [Thread-2 (]: Finished running node test.raysearch_project.not_null_transaction_date.8d1d66da2c
[0m20:00:11.941977 [debug] [Thread-2 (]: Began running node test.raysearch_project.not_null_trf_currency_exchange_scd2_currency_code.58a57215a6
[0m20:00:11.944152 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"
[0m20:00:11.945921 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_txCurrency.7798fc4041: BEGIN
[0m20:00:11.946615 [debug] [Thread-3 (]: Began executing node test.raysearch_project.not_null_trf_currency_exchange_scd2_base_rate_eur.f7fd803fa4
[0m20:00:11.947321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:11.945217 [info ] [Thread-2 (]: 19 of 31 START test not_null_trf_currency_exchange_scd2_currency_code .......... [RUN]
[0m20:00:11.952498 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.not_null_trf_currency_exchange_scd2_base_rate_eur.f7fd803fa4"
[0m20:00:11.954313 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_transaction_date.8d1d66da2c, now test.raysearch_project.not_null_trf_currency_exchange_scd2_currency_code.58a57215a6)
[0m20:00:11.955548 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:00:11.956655 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.not_null_trf_currency_exchange_scd2_currency_code.58a57215a6
[0m20:00:11.958219 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"
[0m20:00:11.965677 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.not_null_trf_currency_exchange_scd2_currency_code.58a57215a6"
[0m20:00:11.966983 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_txCurrency.7798fc4041: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txCurrency
from "warehouse"."main_raw"."transaction"
where txCurrency is null



  
  
      
    ) dbt_internal_test
[0m20:00:11.968472 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_trf_currency_exchange_scd2_base_rate_eur.f7fd803fa4"
[0m20:00:11.971144 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_currency_exchange_scd2_base_rate_eur.f7fd803fa4: BEGIN
[0m20:00:11.972298 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:11.973646 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:00:11.975937 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:00:11.976670 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_trf_currency_exchange_scd2_base_rate_eur.f7fd803fa4"
[0m20:00:11.977413 [debug] [Thread-2 (]: Began executing node test.raysearch_project.not_null_trf_currency_exchange_scd2_currency_code.58a57215a6
[0m20:00:11.978035 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_currency_exchange_scd2_base_rate_eur.f7fd803fa4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_currency_exchange_scd2_base_rate_eur.f7fd803fa4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select base_rate_eur
from "warehouse"."main_trf"."trf_currency_exchange_scd2"
where base_rate_eur is null



  
  
      
    ) dbt_internal_test
[0m20:00:11.985103 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.not_null_trf_currency_exchange_scd2_currency_code.58a57215a6"
[0m20:00:11.980491 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_txCurrency.7798fc4041: ROLLBACK
[0m20:00:11.988481 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:00:11.992733 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_currency_exchange_scd2_base_rate_eur.f7fd803fa4: ROLLBACK
[0m20:00:11.994190 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_trf_currency_exchange_scd2_currency_code.58a57215a6"
[0m20:00:11.995044 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_currency_exchange_scd2_currency_code.58a57215a6: BEGIN
[0m20:00:11.995674 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:11.996678 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.not_null_transaction_txCurrency.7798fc4041'
[0m20:00:11.998194 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_txCurrency.7798fc4041: Close
[0m20:00:12.000117 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:00:11.999345 [info ] [Thread-1 (]: 17 of 31 PASS not_null_transaction_txCurrency .................................. [[32mPASS[0m in 0.12s]
[0m20:00:12.001343 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_trf_currency_exchange_scd2_currency_code.58a57215a6"
[0m20:00:12.002314 [debug] [Thread-1 (]: Finished running node test.raysearch_project.not_null_transaction_txCurrency.7798fc4041
[0m20:00:12.003303 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_currency_exchange_scd2_currency_code.58a57215a6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_currency_exchange_scd2_currency_code.58a57215a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency_code
from "warehouse"."main_trf"."trf_currency_exchange_scd2"
where currency_code is null



  
  
      
    ) dbt_internal_test
[0m20:00:12.004674 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.not_null_trf_currency_exchange_scd2_base_rate_eur.f7fd803fa4'
[0m20:00:12.005699 [debug] [Thread-1 (]: Began running node test.raysearch_project.not_null_trf_currency_exchange_scd2_effective_start_date.3cc7ab0527
[0m20:00:12.007552 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_currency_exchange_scd2_base_rate_eur.f7fd803fa4: Close
[0m20:00:12.010125 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:00:12.013776 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_currency_exchange_scd2_currency_code.58a57215a6: ROLLBACK
[0m20:00:12.008886 [info ] [Thread-1 (]: 20 of 31 START test not_null_trf_currency_exchange_scd2_effective_start_date ... [RUN]
[0m20:00:12.017278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_transaction_txCurrency.7798fc4041, now test.raysearch_project.not_null_trf_currency_exchange_scd2_effective_start_date.3cc7ab0527)
[0m20:00:12.018315 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.not_null_trf_currency_exchange_scd2_effective_start_date.3cc7ab0527
[0m20:00:12.016069 [info ] [Thread-3 (]: 18 of 31 PASS not_null_trf_currency_exchange_scd2_base_rate_eur ................ [[32mPASS[0m in 0.09s]
[0m20:00:12.027838 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.not_null_trf_currency_exchange_scd2_effective_start_date.3cc7ab0527"
[0m20:00:12.028987 [debug] [Thread-3 (]: Finished running node test.raysearch_project.not_null_trf_currency_exchange_scd2_base_rate_eur.f7fd803fa4
[0m20:00:12.030129 [debug] [Thread-3 (]: Began running node test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb
[0m20:00:12.030970 [info ] [Thread-3 (]: 21 of 31 START test not_null_trf_customer_scd2_customer_id ..................... [RUN]
[0m20:00:12.032590 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_trf_currency_exchange_scd2_base_rate_eur.f7fd803fa4, now test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb)
[0m20:00:12.033546 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb
[0m20:00:12.043941 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb"
[0m20:00:12.046128 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.not_null_trf_currency_exchange_scd2_currency_code.58a57215a6'
[0m20:00:12.046988 [debug] [Thread-1 (]: Began executing node test.raysearch_project.not_null_trf_currency_exchange_scd2_effective_start_date.3cc7ab0527
[0m20:00:12.048049 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_currency_exchange_scd2_currency_code.58a57215a6: Close
[0m20:00:12.052455 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.not_null_trf_currency_exchange_scd2_effective_start_date.3cc7ab0527"
[0m20:00:12.053525 [debug] [Thread-3 (]: Began executing node test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb
[0m20:00:12.061717 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb"
[0m20:00:12.055999 [info ] [Thread-2 (]: 19 of 31 PASS not_null_trf_currency_exchange_scd2_currency_code ................ [[32mPASS[0m in 0.10s]
[0m20:00:12.063625 [debug] [Thread-2 (]: Finished running node test.raysearch_project.not_null_trf_currency_exchange_scd2_currency_code.58a57215a6
[0m20:00:12.064748 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_trf_currency_exchange_scd2_effective_start_date.3cc7ab0527"
[0m20:00:12.065641 [debug] [Thread-2 (]: Began running node test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94
[0m20:00:12.066404 [debug] [Thread-1 (]: On test.raysearch_project.not_null_trf_currency_exchange_scd2_effective_start_date.3cc7ab0527: BEGIN
[0m20:00:12.067226 [info ] [Thread-2 (]: 22 of 31 START test not_null_trf_customer_scd2_etl_valid_from .................. [RUN]
[0m20:00:12.068442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:12.069536 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb"
[0m20:00:12.070669 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_trf_currency_exchange_scd2_currency_code.58a57215a6, now test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94)
[0m20:00:12.073154 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb: BEGIN
[0m20:00:12.074267 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94
[0m20:00:12.074959 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:00:12.075839 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:12.085056 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94"
[0m20:00:12.085915 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_trf_currency_exchange_scd2_effective_start_date.3cc7ab0527"
[0m20:00:12.088150 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m20:00:12.089655 [debug] [Thread-1 (]: On test.raysearch_project.not_null_trf_currency_exchange_scd2_effective_start_date.3cc7ab0527: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_currency_exchange_scd2_effective_start_date.3cc7ab0527"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_start_date
from "warehouse"."main_trf"."trf_currency_exchange_scd2"
where effective_start_date is null



  
  
      
    ) dbt_internal_test
[0m20:00:12.091617 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb"
[0m20:00:12.093252 [debug] [Thread-2 (]: Began executing node test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94
[0m20:00:12.094253 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_currency_exchange_scd2_effective_start_date.3cc7ab0527"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_start_date
from "warehouse"."main_trf"."trf_currency_exchange_scd2"
where effective_start_date is null



  
  
      
    ) dbt_internal_test
[0m20:00:12.094990 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "warehouse"."main_trf"."trf_customer_scd2"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m20:00:12.100391 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94"
[0m20:00:12.101447 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:00:12.103661 [debug] [Thread-1 (]: On test.raysearch_project.not_null_trf_currency_exchange_scd2_effective_start_date.3cc7ab0527: ROLLBACK
[0m20:00:12.105106 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:00:12.111027 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb: ROLLBACK
[0m20:00:12.112395 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94"
[0m20:00:12.113087 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94: BEGIN
[0m20:00:12.113967 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:12.115587 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:00:12.116265 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94"
[0m20:00:12.117246 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb'
[0m20:00:12.117890 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select etl_valid_from
from "warehouse"."main_trf"."trf_customer_scd2"
where etl_valid_from is null



  
  
      
    ) dbt_internal_test
[0m20:00:12.118541 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb: Close
[0m20:00:12.120182 [info ] [Thread-3 (]: 21 of 31 PASS not_null_trf_customer_scd2_customer_id ........................... [[32mPASS[0m in 0.09s]
[0m20:00:12.122240 [debug] [Thread-3 (]: Finished running node test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb
[0m20:00:12.123127 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:00:12.123863 [debug] [Thread-3 (]: Began running node test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595
[0m20:00:12.128067 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94: ROLLBACK
[0m20:00:12.124955 [info ] [Thread-3 (]: 23 of 31 START test not_null_trf_customer_scd2_is_current ...................... [RUN]
[0m20:00:12.129671 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb, now test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595)
[0m20:00:12.130722 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595
[0m20:00:12.140299 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595"
[0m20:00:12.142466 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94'
[0m20:00:12.143241 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94: Close
[0m20:00:12.144595 [info ] [Thread-2 (]: 22 of 31 PASS not_null_trf_customer_scd2_etl_valid_from ........................ [[32mPASS[0m in 0.07s]
[0m20:00:12.146419 [debug] [Thread-2 (]: Finished running node test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94
[0m20:00:12.147352 [debug] [Thread-3 (]: Began executing node test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595
[0m20:00:12.148362 [debug] [Thread-2 (]: Began running node test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951
[0m20:00:12.152639 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595"
[0m20:00:12.154229 [info ] [Thread-2 (]: 24 of 31 START test not_null_trf_transaction_account_type ...................... [RUN]
[0m20:00:12.156037 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94, now test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951)
[0m20:00:12.157096 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951
[0m20:00:12.167448 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951"
[0m20:00:12.169210 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595"
[0m20:00:12.170769 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595: BEGIN
[0m20:00:12.171709 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:12.174151 [debug] [Thread-2 (]: Began executing node test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951
[0m20:00:12.178586 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951"
[0m20:00:12.179413 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m20:00:12.180286 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595"
[0m20:00:12.180972 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_current
from "warehouse"."main_trf"."trf_customer_scd2"
where is_current is null



  
  
      
    ) dbt_internal_test
[0m20:00:12.182704 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951"
[0m20:00:12.183328 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951: BEGIN
[0m20:00:12.183871 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:12.184452 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:00:12.188027 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595: ROLLBACK
[0m20:00:12.189145 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m20:00:12.191028 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951"
[0m20:00:12.192295 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select account_type
from "warehouse"."main_trf"."trf_transaction"
where account_type is null



  
  
      
    ) dbt_internal_test
[0m20:00:12.194021 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595'
[0m20:00:12.194685 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595: Close
[0m20:00:12.195331 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:00:12.199008 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951: ROLLBACK
[0m20:00:12.196464 [info ] [Thread-3 (]: 23 of 31 PASS not_null_trf_customer_scd2_is_current ............................ [[32mPASS[0m in 0.07s]
[0m20:00:12.200333 [debug] [Thread-3 (]: Finished running node test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595
[0m20:00:12.201186 [debug] [Thread-3 (]: Began running node test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b
[0m20:00:12.201812 [info ] [Thread-3 (]: 25 of 31 START test not_null_trf_transaction_country_code ...................... [RUN]
[0m20:00:12.203085 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595, now test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b)
[0m20:00:12.203860 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b
[0m20:00:12.212842 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b"
[0m20:00:12.214950 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951'
[0m20:00:12.215868 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951: Close
[0m20:00:12.217564 [info ] [Thread-2 (]: 24 of 31 PASS not_null_trf_transaction_account_type ............................ [[32mPASS[0m in 0.06s]
[0m20:00:12.219555 [debug] [Thread-2 (]: Finished running node test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951
[0m20:00:12.220557 [debug] [Thread-3 (]: Began executing node test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b
[0m20:00:12.221528 [debug] [Thread-2 (]: Began running node test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73
[0m20:00:12.226638 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b"
[0m20:00:12.227790 [info ] [Thread-2 (]: 26 of 31 START test not_null_trf_transaction_customer_id ....................... [RUN]
[0m20:00:12.229267 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951, now test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73)
[0m20:00:12.230271 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73
[0m20:00:12.239094 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73"
[0m20:00:12.241903 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b"
[0m20:00:12.242905 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b: BEGIN
[0m20:00:12.243498 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:12.245215 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:00:12.246181 [debug] [Thread-2 (]: Began executing node test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73
[0m20:00:12.247046 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b"
[0m20:00:12.251332 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73"
[0m20:00:12.252293 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country_code
from "warehouse"."main_trf"."trf_transaction"
where country_code is null



  
  
      
    ) dbt_internal_test
[0m20:00:12.255247 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:00:12.259486 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b: ROLLBACK
[0m20:00:12.261059 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73"
[0m20:00:12.262220 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73: BEGIN
[0m20:00:12.263322 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:12.264947 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b'
[0m20:00:12.265654 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b: Close
[0m20:00:12.266319 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:00:12.267186 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73"
[0m20:00:12.269185 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "warehouse"."main_trf"."trf_transaction"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m20:00:12.268390 [info ] [Thread-3 (]: 25 of 31 PASS not_null_trf_transaction_country_code ............................ [[32mPASS[0m in 0.07s]
[0m20:00:12.271339 [debug] [Thread-3 (]: Finished running node test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b
[0m20:00:12.272166 [debug] [Thread-3 (]: Began running node test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37
[0m20:00:12.274439 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:00:12.273492 [info ] [Thread-3 (]: 27 of 31 START test not_null_trf_transaction_transaction_date .................. [RUN]
[0m20:00:12.278864 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73: ROLLBACK
[0m20:00:12.279930 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b, now test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37)
[0m20:00:12.281219 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37
[0m20:00:12.290279 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37"
[0m20:00:12.301248 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date.1f2c3ce24e'
[0m20:00:12.303947 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.not_null_trf_currency_exchange_scd2_effective_start_date.3cc7ab0527'
[0m20:00:12.304958 [debug] [Thread-4 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date.1f2c3ce24e: Close
[0m20:00:12.305907 [debug] [Thread-3 (]: Began executing node test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37
[0m20:00:12.307208 [debug] [Thread-1 (]: On test.raysearch_project.not_null_trf_currency_exchange_scd2_effective_start_date.3cc7ab0527: Close
[0m20:00:12.308463 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73'
[0m20:00:12.313954 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37"
[0m20:00:12.316154 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73: Close
[0m20:00:12.318586 [info ] [Thread-2 (]: 26 of 31 PASS not_null_trf_transaction_customer_id ............................. [[32mPASS[0m in 0.09s]
[0m20:00:12.325395 [debug] [Thread-4 (]: Runtime Error in test dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date (models\transformation\trf_schema.yml)
  Binder Error: Referenced column "effective_start_date" not found in FROM clause!
  Candidate bindings: "etl_valid_to", "etl_valid_from", "base_rate_eur", "is_current"
  
  LINE 21:     group by currency_code, effective_start_date
                                       ^
[0m20:00:12.326695 [debug] [Thread-2 (]: Finished running node test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73
[0m20:00:12.329304 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37"
[0m20:00:12.328345 [error] [Thread-4 (]: 6 of 31 ERROR dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date  [[31mERROR[0m in 0.88s]
[0m20:00:12.330800 [debug] [Thread-2 (]: Began running node test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8
[0m20:00:12.335200 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37: BEGIN
[0m20:00:12.336575 [debug] [Thread-1 (]: Runtime Error in test not_null_trf_currency_exchange_scd2_effective_start_date (models\transformation\trf_schema.yml)
  Binder Error: Referenced column "effective_start_date" not found in FROM clause!
  Candidate bindings: "etl_valid_to", "etl_valid_from", "base_rate_eur", "is_current"
  
  LINE 18: where effective_start_date is null
                 ^
[0m20:00:12.337771 [debug] [Thread-4 (]: Finished running node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date.1f2c3ce24e
[0m20:00:12.339472 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:12.338582 [info ] [Thread-2 (]: 28 of 31 START test relationships_transaction_customerId__customerID__ref_customer_  [RUN]
[0m20:00:12.342101 [debug] [Thread-4 (]: Began running node test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506
[0m20:00:12.340799 [error] [Thread-1 (]: 20 of 31 ERROR not_null_trf_currency_exchange_scd2_effective_start_date ........ [[31mERROR[0m in 0.32s]
[0m20:00:12.343770 [debug] [Thread-7 (]: Marking all children of 'test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date.1f2c3ce24e' to be skipped because of status 'error'.  Reason: Runtime Error in test dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date (models\transformation\trf_schema.yml)
  Binder Error: Referenced column "effective_start_date" not found in FROM clause!
  Candidate bindings: "etl_valid_to", "etl_valid_from", "base_rate_eur", "is_current"
  
  LINE 21:     group by currency_code, effective_start_date
                                       ^.
[0m20:00:12.345425 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73, now test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8)
[0m20:00:12.346958 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m20:00:12.348148 [debug] [Thread-1 (]: Finished running node test.raysearch_project.not_null_trf_currency_exchange_scd2_effective_start_date.3cc7ab0527
[0m20:00:12.346295 [info ] [Thread-4 (]: 29 of 31 START test relationships_transaction_txCurrency__currency__ref_currency_exchange_  [RUN]
[0m20:00:12.350368 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8
[0m20:00:12.351179 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37"
[0m20:00:12.352009 [debug] [Thread-1 (]: Began running node test.raysearch_project.trf_transaction_customer_on_day
[0m20:00:12.352876 [debug] [Thread-7 (]: Marking all children of 'test.raysearch_project.not_null_trf_currency_exchange_scd2_effective_start_date.3cc7ab0527' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_trf_currency_exchange_scd2_effective_start_date (models\transformation\trf_schema.yml)
  Binder Error: Referenced column "effective_start_date" not found in FROM clause!
  Candidate bindings: "etl_valid_to", "etl_valid_from", "base_rate_eur", "is_current"
  
  LINE 18: where effective_start_date is null
                 ^.
[0m20:00:12.354301 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date.1f2c3ce24e, now test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506)
[0m20:00:12.371283 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"
[0m20:00:12.372508 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "warehouse"."main_trf"."trf_transaction"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m20:00:12.375511 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506
[0m20:00:12.373775 [info ] [Thread-1 (]: 30 of 31 START test trf_transaction_customer_on_day ............................ [RUN]
[0m20:00:12.385541 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506"
[0m20:00:12.386874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_trf_currency_exchange_scd2_effective_start_date.3cc7ab0527, now test.raysearch_project.trf_transaction_customer_on_day)
[0m20:00:12.387990 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m20:00:12.389392 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.trf_transaction_customer_on_day
[0m20:00:12.395692 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.trf_transaction_customer_on_day"
[0m20:00:12.396613 [debug] [Thread-2 (]: Began executing node test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8
[0m20:00:12.399013 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37: ROLLBACK
[0m20:00:12.404767 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"
[0m20:00:12.407546 [debug] [Thread-4 (]: Began executing node test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506
[0m20:00:12.408805 [debug] [Thread-1 (]: Began executing node test.raysearch_project.trf_transaction_customer_on_day
[0m20:00:12.413392 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506"
[0m20:00:12.425320 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.trf_transaction_customer_on_day"
[0m20:00:12.426577 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"
[0m20:00:12.428131 [debug] [Thread-2 (]: On test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8: BEGIN
[0m20:00:12.429177 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:12.431214 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37'
[0m20:00:12.432041 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37: Close
[0m20:00:12.433002 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.trf_transaction_customer_on_day"
[0m20:00:12.433863 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506"
[0m20:00:12.435494 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m20:00:12.436321 [debug] [Thread-1 (]: On test.raysearch_project.trf_transaction_customer_on_day: BEGIN
[0m20:00:12.434872 [info ] [Thread-3 (]: 27 of 31 PASS not_null_trf_transaction_transaction_date ........................ [[32mPASS[0m in 0.16s]
[0m20:00:12.437652 [debug] [Thread-4 (]: On test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506: BEGIN
[0m20:00:12.438400 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"
[0m20:00:12.439156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:12.440343 [debug] [Thread-3 (]: Finished running node test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37
[0m20:00:12.441109 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:12.441863 [debug] [Thread-2 (]: On test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customerId as from_field
    from "warehouse"."main_raw"."transaction"
    where customerId is not null
),

parent as (
    select customerID as to_field
    from "warehouse"."main_raw"."customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:00:12.443277 [debug] [Thread-3 (]: Began running node test.raysearch_project.trf_transaction_exchange_on_day
[0m20:00:12.444474 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:00:12.445281 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:00:12.446890 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.trf_transaction_customer_on_day"
[0m20:00:12.446282 [info ] [Thread-3 (]: 31 of 31 START test trf_transaction_exchange_on_day ............................ [RUN]
[0m20:00:12.447797 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506"
[0m20:00:12.452069 [debug] [Thread-1 (]: On test.raysearch_project.trf_transaction_customer_on_day: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.trf_transaction_customer_on_day"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select t.transaction_date, t.customer_id
from "warehouse"."main_trf"."trf_transaction" t
left join "warehouse"."main_trf"."trf_customer_scd2" c
  on c.customer_id = t.customer_id
 and t.transaction_date between c.etl_valid_from and c.etl_valid_to
where c.customer_id is null
  
  
      
    ) dbt_internal_test
[0m20:00:12.453858 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m20:00:12.454978 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37, now test.raysearch_project.trf_transaction_exchange_on_day)
[0m20:00:12.456288 [debug] [Thread-4 (]: On test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select txCurrency as from_field
    from "warehouse"."main_raw"."transaction"
    where txCurrency is not null
),

parent as (
    select currency as to_field
    from "warehouse"."main_raw"."currency_exchange"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:00:12.458692 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.trf_transaction_exchange_on_day
[0m20:00:12.461927 [debug] [Thread-2 (]: On test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8: ROLLBACK
[0m20:00:12.462723 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:00:12.467514 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.trf_transaction_exchange_on_day"
[0m20:00:12.472190 [debug] [Thread-1 (]: On test.raysearch_project.trf_transaction_customer_on_day: ROLLBACK
[0m20:00:12.476440 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8'
[0m20:00:12.477887 [debug] [Thread-2 (]: On test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8: Close
[0m20:00:12.480080 [debug] [Thread-3 (]: Began executing node test.raysearch_project.trf_transaction_exchange_on_day
[0m20:00:12.485654 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.trf_transaction_exchange_on_day"
[0m20:00:12.479319 [info ] [Thread-2 (]: 28 of 31 PASS relationships_transaction_customerId__customerID__ref_customer_ .. [[32mPASS[0m in 0.13s]
[0m20:00:12.488114 [debug] [Thread-2 (]: Finished running node test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8
[0m20:00:12.490174 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.trf_transaction_customer_on_day'
[0m20:00:12.491250 [debug] [Thread-1 (]: On test.raysearch_project.trf_transaction_customer_on_day: Close
[0m20:00:12.492864 [info ] [Thread-1 (]: 30 of 31 PASS trf_transaction_customer_on_day .................................. [[32mPASS[0m in 0.11s]
[0m20:00:12.494326 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.trf_transaction_exchange_on_day"
[0m20:00:12.495704 [debug] [Thread-1 (]: Finished running node test.raysearch_project.trf_transaction_customer_on_day
[0m20:00:12.496776 [debug] [Thread-3 (]: On test.raysearch_project.trf_transaction_exchange_on_day: BEGIN
[0m20:00:12.498286 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:12.499973 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:00:12.500752 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.trf_transaction_exchange_on_day"
[0m20:00:12.501450 [debug] [Thread-3 (]: On test.raysearch_project.trf_transaction_exchange_on_day: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.trf_transaction_exchange_on_day"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select t.transaction_date, t.currency
from "warehouse"."main_trf"."trf_transaction" t
left join "warehouse"."main_trf"."trf_currency_exchange_scd2" x
  on x.currency_code = t.currency_code
 and t.transaction_date between x.etl_valid_from and x.etl_valid_to
where x.currency_code is null
  
  
      
    ) dbt_internal_test
[0m20:00:12.502115 [debug] [Thread-4 (]: SQL status: OK in 0.042 seconds
[0m20:00:12.506458 [debug] [Thread-4 (]: On test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506: ROLLBACK
[0m20:00:12.508269 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.trf_transaction_exchange_on_day"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select t.transaction_date, t.currency
from "warehouse"."main_trf"."trf_transaction" t
left join "warehouse"."main_trf"."trf_currency_exchange_scd2" x
  on x.currency_code = t.currency_code
 and t.transaction_date between x.etl_valid_from and x.etl_valid_to
where x.currency_code is null
  
  
      
    ) dbt_internal_test
[0m20:00:12.509483 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m20:00:12.510715 [debug] [Thread-3 (]: On test.raysearch_project.trf_transaction_exchange_on_day: ROLLBACK
[0m20:00:12.512622 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506'
[0m20:00:12.513505 [debug] [Thread-4 (]: On test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506: Close
[0m20:00:12.514714 [info ] [Thread-4 (]: 29 of 31 PASS relationships_transaction_txCurrency__currency__ref_currency_exchange_  [[32mPASS[0m in 0.16s]
[0m20:00:12.516082 [debug] [Thread-4 (]: Finished running node test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506
[0m20:00:12.525504 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.trf_transaction_exchange_on_day'
[0m20:00:12.526415 [debug] [Thread-3 (]: On test.raysearch_project.trf_transaction_exchange_on_day: Close
[0m20:00:12.533216 [debug] [Thread-3 (]: Runtime Error in test trf_transaction_exchange_on_day (models/transformation/tests\trf_transaction_exchange_on_day.sql)
  Binder Error: Table "t" does not have a column named "currency_code"
  
  Candidate bindings: : "country_code"
  
  LINE 13:   on x.currency_code = t.currency_code
                                  ^
[0m20:00:12.534132 [error] [Thread-3 (]: 31 of 31 ERROR trf_transaction_exchange_on_day ................................. [[31mERROR[0m in 0.08s]
[0m20:00:12.535487 [debug] [Thread-3 (]: Finished running node test.raysearch_project.trf_transaction_exchange_on_day
[0m20:00:12.536619 [debug] [Thread-7 (]: Marking all children of 'test.raysearch_project.trf_transaction_exchange_on_day' to be skipped because of status 'error'.  Reason: Runtime Error in test trf_transaction_exchange_on_day (models/transformation/tests\trf_transaction_exchange_on_day.sql)
  Binder Error: Table "t" does not have a column named "currency_code"
  
  Candidate bindings: : "country_code"
  
  LINE 13:   on x.currency_code = t.currency_code
                                  ^.
[0m20:00:12.542132 [debug] [MainThread]: Using duckdb connection "master"
[0m20:00:12.542929 [debug] [MainThread]: On master: BEGIN
[0m20:00:12.543420 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:00:12.545005 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:00:12.545615 [debug] [MainThread]: On master: COMMIT
[0m20:00:12.546088 [debug] [MainThread]: Using duckdb connection "master"
[0m20:00:12.546502 [debug] [MainThread]: On master: COMMIT
[0m20:00:12.547332 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:00:12.547914 [debug] [MainThread]: On master: Close
[0m20:00:12.548654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:12.549064 [debug] [MainThread]: Connection 'list_warehouse_main_trf' was properly closed.
[0m20:00:12.549423 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m20:00:12.549808 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m20:00:12.550161 [debug] [MainThread]: Connection 'test.raysearch_project.trf_transaction_exchange_on_day' was properly closed.
[0m20:00:12.550509 [debug] [MainThread]: Connection 'test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8' was properly closed.
[0m20:00:12.550889 [debug] [MainThread]: Connection 'test.raysearch_project.trf_transaction_customer_on_day' was properly closed.
[0m20:00:12.551273 [debug] [MainThread]: Connection 'test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506' was properly closed.
[0m20:00:12.552006 [info ] [MainThread]: 
[0m20:00:12.553133 [info ] [MainThread]: Finished running 31 data tests in 0 hours 0 minutes and 16.46 seconds (16.46s).
[0m20:00:12.562499 [debug] [MainThread]: Command end result
[0m20:00:12.624362 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m20:00:12.631374 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m20:00:12.647946 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m20:00:12.648720 [info ] [MainThread]: 
[0m20:00:12.649880 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m20:00:12.650864 [info ] [MainThread]: 
[0m20:00:12.651849 [error] [MainThread]: [31mFailure in test dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date (models\transformation\trf_schema.yml)[0m
[0m20:00:12.652870 [error] [MainThread]:   Runtime Error in test dbt_utils_unique_combination_of_columns_trf_currency_exchange_scd2_currency_code__effective_start_date (models\transformation\trf_schema.yml)
  Binder Error: Referenced column "effective_start_date" not found in FROM clause!
  Candidate bindings: "etl_valid_to", "etl_valid_from", "base_rate_eur", "is_current"
  
  LINE 21:     group by currency_code, effective_start_date
                                       ^
[0m20:00:12.654097 [info ] [MainThread]: 
[0m20:00:12.655372 [info ] [MainThread]:   compiled code at target\compiled\raysearch_project\models\transformation\trf_schema.yml\dbt_utils_unique_combination_o_7c032b4238754f0d3e46c8b4268a2b39.sql
[0m20:00:12.656381 [info ] [MainThread]: 
[0m20:00:12.657293 [error] [MainThread]: [31mFailure in test not_null_trf_currency_exchange_scd2_effective_start_date (models\transformation\trf_schema.yml)[0m
[0m20:00:12.658403 [error] [MainThread]:   Runtime Error in test not_null_trf_currency_exchange_scd2_effective_start_date (models\transformation\trf_schema.yml)
  Binder Error: Referenced column "effective_start_date" not found in FROM clause!
  Candidate bindings: "etl_valid_to", "etl_valid_from", "base_rate_eur", "is_current"
  
  LINE 18: where effective_start_date is null
                 ^
[0m20:00:12.659384 [info ] [MainThread]: 
[0m20:00:12.661033 [info ] [MainThread]:   compiled code at target\compiled\raysearch_project\models\transformation\trf_schema.yml\not_null_trf_currency_exchange_scd2_effective_start_date.sql
[0m20:00:12.662510 [info ] [MainThread]: 
[0m20:00:12.663556 [error] [MainThread]: [31mFailure in test trf_transaction_exchange_on_day (models/transformation/tests\trf_transaction_exchange_on_day.sql)[0m
[0m20:00:12.664476 [error] [MainThread]:   Runtime Error in test trf_transaction_exchange_on_day (models/transformation/tests\trf_transaction_exchange_on_day.sql)
  Binder Error: Table "t" does not have a column named "currency_code"
  
  Candidate bindings: : "country_code"
  
  LINE 13:   on x.currency_code = t.currency_code
                                  ^
[0m20:00:12.665384 [info ] [MainThread]: 
[0m20:00:12.666397 [info ] [MainThread]:   compiled code at target\compiled\raysearch_project\models/transformation/tests\trf_transaction_exchange_on_day.sql
[0m20:00:12.667585 [info ] [MainThread]: 
[0m20:00:12.668656 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=31
[0m20:00:12.672973 [debug] [MainThread]: Command `dbt test` failed at 20:00:12.672335 after 29.35 seconds
[0m20:00:12.674033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFB7DB890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFD1FEE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFD1FEA40>]}
[0m20:00:12.674838 [debug] [MainThread]: Flushing usage events
[0m20:00:13.796827 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:01:26.055796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18B974830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18CAAFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18CAAF9D0>]}


============================== 20:01:26.069644 | 9219b39e-0ad1-4e1e-b1e7-96973b7aee92 ==============================
[0m20:01:26.069644 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:01:26.071493 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'invocation_command': 'dbt test --select trf_transaction_customer_on_day.sql', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m20:01:26.560774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9219b39e-0ad1-4e1e-b1e7-96973b7aee92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18BDE6060>]}
[0m20:01:26.700363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9219b39e-0ad1-4e1e-b1e7-96973b7aee92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18DAF67A0>]}
[0m20:01:26.707232 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:01:27.348906 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:01:27.816783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:01:27.818383 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models\transformation\tests\trf_transaction_customer_on_day.sql
[0m20:01:27.819131 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models/transformation/tests\trf_transaction_customer_on_day.sql
[0m20:01:28.671100 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.raysearch_project.marts
[0m20:01:28.686399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9219b39e-0ad1-4e1e-b1e7-96973b7aee92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18DFD7650>]}
[0m20:01:28.918085 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m20:01:28.925829 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m20:01:29.019368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9219b39e-0ad1-4e1e-b1e7-96973b7aee92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18E463E30>]}
[0m20:01:29.021128 [info ] [MainThread]: Found 8 models, 1 snapshot, 3 seeds, 31 data tests, 586 macros
[0m20:01:29.023957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9219b39e-0ad1-4e1e-b1e7-96973b7aee92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18E452970>]}
[0m20:01:29.029164 [info ] [MainThread]: 
[0m20:01:29.030264 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:01:29.031795 [info ] [MainThread]: 
[0m20:01:29.034006 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:01:29.047505 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m20:01:29.059065 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_trf'
[0m20:01:29.075212 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m20:01:29.307537 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m20:01:29.308539 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m20:01:29.309310 [debug] [ThreadPool]: On list_warehouse_main_trf: BEGIN
[0m20:01:29.309934 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m20:01:29.310591 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m20:01:29.311183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:29.311785 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m20:01:29.312463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:29.313437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:29.349309 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m20:01:29.350482 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m20:01:29.351259 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m20:01:29.351922 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m20:01:29.352592 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m20:01:29.353183 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m20:01:29.353816 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m20:01:29.354429 [debug] [ThreadPool]: On list_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_trf"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_trf'
    and lower(table_catalog) = 'warehouse'
  
[0m20:01:29.355069 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m20:01:29.384274 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m20:01:29.385187 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m20:01:29.385851 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m20:01:29.388538 [debug] [ThreadPool]: On list_warehouse_main_trf: ROLLBACK
[0m20:01:29.390877 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m20:01:29.393276 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m20:01:29.395812 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_trf'
[0m20:01:29.396475 [debug] [ThreadPool]: On list_warehouse_main_trf: Close
[0m20:01:29.400356 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m20:01:29.401117 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m20:01:29.403333 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m20:01:29.403897 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m20:01:29.406466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9219b39e-0ad1-4e1e-b1e7-96973b7aee92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18E4935F0>]}
[0m20:01:29.407401 [debug] [MainThread]: Using duckdb connection "master"
[0m20:01:29.407908 [debug] [MainThread]: On master: BEGIN
[0m20:01:29.408417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:01:29.409842 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:01:29.410399 [debug] [MainThread]: On master: COMMIT
[0m20:01:29.410840 [debug] [MainThread]: Using duckdb connection "master"
[0m20:01:29.411230 [debug] [MainThread]: On master: COMMIT
[0m20:01:29.412026 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:01:29.412515 [debug] [MainThread]: On master: Close
[0m20:01:29.422024 [debug] [Thread-1 (]: Began running node test.raysearch_project.trf_transaction_customer_on_day
[0m20:01:29.422904 [info ] [Thread-1 (]: 1 of 1 START test trf_transaction_customer_on_day .............................. [RUN]
[0m20:01:29.424422 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.raysearch_project.trf_transaction_customer_on_day'
[0m20:01:29.425189 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.trf_transaction_customer_on_day
[0m20:01:29.438539 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.trf_transaction_customer_on_day"
[0m20:01:29.443302 [debug] [Thread-1 (]: Began executing node test.raysearch_project.trf_transaction_customer_on_day
[0m20:01:29.480591 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.trf_transaction_customer_on_day"
[0m20:01:29.485642 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.trf_transaction_customer_on_day"
[0m20:01:29.486651 [debug] [Thread-1 (]: On test.raysearch_project.trf_transaction_customer_on_day: BEGIN
[0m20:01:29.487268 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:01:29.488999 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:01:29.489691 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.trf_transaction_customer_on_day"
[0m20:01:29.490445 [debug] [Thread-1 (]: On test.raysearch_project.trf_transaction_customer_on_day: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.trf_transaction_customer_on_day"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select t.transaction_date, t.customer_id
from "warehouse"."main_stg"."stg_transaction" t
left join "warehouse"."main_trf"."trf_customer_scd2" c
  on c.customer_id = t.customer_id
 and t.transaction_date between c.etl_valid_from and c.etl_valid_to
where c.customer_id is null
  
  
      
    ) dbt_internal_test
[0m20:01:29.507690 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m20:01:29.515444 [debug] [Thread-1 (]: On test.raysearch_project.trf_transaction_customer_on_day: ROLLBACK
[0m20:01:29.517681 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.trf_transaction_customer_on_day'
[0m20:01:29.518388 [debug] [Thread-1 (]: On test.raysearch_project.trf_transaction_customer_on_day: Close
[0m20:01:29.519576 [info ] [Thread-1 (]: 1 of 1 PASS trf_transaction_customer_on_day .................................... [[32mPASS[0m in 0.10s]
[0m20:01:29.521250 [debug] [Thread-1 (]: Finished running node test.raysearch_project.trf_transaction_customer_on_day
[0m20:01:29.525074 [debug] [MainThread]: Using duckdb connection "master"
[0m20:01:29.526114 [debug] [MainThread]: On master: BEGIN
[0m20:01:29.526779 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:01:29.528294 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:01:29.529003 [debug] [MainThread]: On master: COMMIT
[0m20:01:29.529611 [debug] [MainThread]: Using duckdb connection "master"
[0m20:01:29.530182 [debug] [MainThread]: On master: COMMIT
[0m20:01:29.531278 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:01:29.531932 [debug] [MainThread]: On master: Close
[0m20:01:29.532807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:01:29.533432 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m20:01:29.534019 [debug] [MainThread]: Connection 'list_warehouse_main_trf' was properly closed.
[0m20:01:29.534530 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m20:01:29.535011 [debug] [MainThread]: Connection 'test.raysearch_project.trf_transaction_customer_on_day' was properly closed.
[0m20:01:29.535596 [info ] [MainThread]: 
[0m20:01:29.536765 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m20:01:29.539228 [debug] [MainThread]: Command end result
[0m20:01:29.604926 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m20:01:29.611185 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m20:01:29.629459 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m20:01:29.630223 [info ] [MainThread]: 
[0m20:01:29.631433 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:01:29.632800 [info ] [MainThread]: 
[0m20:01:29.634390 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:01:29.636283 [debug] [MainThread]: Command `dbt test` succeeded at 20:01:29.636041 after 3.94 seconds
[0m20:01:29.637098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18C84B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18E3E7C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18E3E7CD0>]}
[0m20:01:29.637754 [debug] [MainThread]: Flushing usage events
[0m20:01:30.851969 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:23.159776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B6F314830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B7044FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B7044F9D0>]}


============================== 20:04:23.172620 | fba682de-19ff-49a3-ae0a-5d141ffca055 ==============================
[0m20:04:23.172620 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:04:23.174650 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'invocation_command': 'dbt test --select trf_transaction_exchange_on_day', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m20:04:23.711281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fba682de-19ff-49a3-ae0a-5d141ffca055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B6F786060>]}
[0m20:04:23.837821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fba682de-19ff-49a3-ae0a-5d141ffca055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B704C27A0>]}
[0m20:04:23.845076 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:04:24.347487 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:04:24.902005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:04:24.903591 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models/transformation/tests\trf_transaction_exchange_on_day.sql
[0m20:04:24.904457 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models\transformation\tests\trf_transaction_exchange_on_day.sql
[0m20:04:25.683742 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.raysearch_project.marts
[0m20:04:25.699330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fba682de-19ff-49a3-ae0a-5d141ffca055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B71957550>]}
[0m20:04:25.903954 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m20:04:25.911470 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m20:04:26.003587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fba682de-19ff-49a3-ae0a-5d141ffca055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B71DE3F20>]}
[0m20:04:26.004695 [info ] [MainThread]: Found 8 models, 1 snapshot, 3 seeds, 31 data tests, 586 macros
[0m20:04:26.005933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fba682de-19ff-49a3-ae0a-5d141ffca055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B71DD2970>]}
[0m20:04:26.010016 [info ] [MainThread]: 
[0m20:04:26.011166 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:04:26.012021 [info ] [MainThread]: 
[0m20:04:26.013183 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:04:26.026318 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m20:04:26.031045 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_trf'
[0m20:04:26.050112 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m20:04:26.295726 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m20:04:26.296730 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m20:04:26.297404 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m20:04:26.298042 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m20:04:26.298647 [debug] [ThreadPool]: On list_warehouse_main_trf: BEGIN
[0m20:04:26.299248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:26.299826 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m20:04:26.300364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:26.301121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:26.337280 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m20:04:26.338124 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m20:04:26.338656 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m20:04:26.339286 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m20:04:26.339900 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m20:04:26.340794 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m20:04:26.341345 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m20:04:26.342696 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m20:04:26.342064 [debug] [ThreadPool]: On list_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_trf"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_trf'
    and lower(table_catalog) = 'warehouse'
  
[0m20:04:26.368549 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m20:04:26.369693 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m20:04:26.370382 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m20:04:26.372867 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m20:04:26.375037 [debug] [ThreadPool]: On list_warehouse_main_trf: ROLLBACK
[0m20:04:26.377671 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m20:04:26.383271 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m20:04:26.384168 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m20:04:26.386700 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_trf'
[0m20:04:26.387355 [debug] [ThreadPool]: On list_warehouse_main_trf: Close
[0m20:04:26.389446 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m20:04:26.389967 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m20:04:26.392536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fba682de-19ff-49a3-ae0a-5d141ffca055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B71E175F0>]}
[0m20:04:26.393388 [debug] [MainThread]: Using duckdb connection "master"
[0m20:04:26.393848 [debug] [MainThread]: On master: BEGIN
[0m20:04:26.394274 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:04:26.395388 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:04:26.395872 [debug] [MainThread]: On master: COMMIT
[0m20:04:26.396322 [debug] [MainThread]: Using duckdb connection "master"
[0m20:04:26.396709 [debug] [MainThread]: On master: COMMIT
[0m20:04:26.397516 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:04:26.397984 [debug] [MainThread]: On master: Close
[0m20:04:26.406105 [debug] [Thread-1 (]: Began running node test.raysearch_project.trf_transaction_exchange_on_day
[0m20:04:26.406873 [info ] [Thread-1 (]: 1 of 1 START test trf_transaction_exchange_on_day .............................. [RUN]
[0m20:04:26.408498 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.raysearch_project.trf_transaction_exchange_on_day'
[0m20:04:26.409165 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.trf_transaction_exchange_on_day
[0m20:04:26.421792 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.trf_transaction_exchange_on_day"
[0m20:04:26.425888 [debug] [Thread-1 (]: Began executing node test.raysearch_project.trf_transaction_exchange_on_day
[0m20:04:26.467129 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.trf_transaction_exchange_on_day"
[0m20:04:26.470325 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.trf_transaction_exchange_on_day"
[0m20:04:26.471137 [debug] [Thread-1 (]: On test.raysearch_project.trf_transaction_exchange_on_day: BEGIN
[0m20:04:26.471661 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:04:26.473375 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:04:26.474312 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.trf_transaction_exchange_on_day"
[0m20:04:26.475386 [debug] [Thread-1 (]: On test.raysearch_project.trf_transaction_exchange_on_day: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.trf_transaction_exchange_on_day"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select t.transaction_date, t.currency
from "warehouse"."main_stg"."stg_transaction" t
left join "warehouse"."main_trf"."trf_currency_exchange_scd2" x
  on x.currency_code = t.currency_code
 and t.transaction_date between x.etl_valid_from and x.etl_valid_to
where x.currency_code is null
  
  
      
    ) dbt_internal_test
[0m20:04:26.478880 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.trf_transaction_exchange_on_day"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select t.transaction_date, t.currency
from "warehouse"."main_stg"."stg_transaction" t
left join "warehouse"."main_trf"."trf_currency_exchange_scd2" x
  on x.currency_code = t.currency_code
 and t.transaction_date between x.etl_valid_from and x.etl_valid_to
where x.currency_code is null
  
  
      
    ) dbt_internal_test
[0m20:04:26.479664 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:04:26.480451 [debug] [Thread-1 (]: On test.raysearch_project.trf_transaction_exchange_on_day: ROLLBACK
[0m20:04:26.510594 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.trf_transaction_exchange_on_day'
[0m20:04:26.511481 [debug] [Thread-1 (]: On test.raysearch_project.trf_transaction_exchange_on_day: Close
[0m20:04:26.519202 [debug] [Thread-1 (]: Runtime Error in test trf_transaction_exchange_on_day (models/transformation/tests\trf_transaction_exchange_on_day.sql)
  Binder Error: Values list "t" does not have a column named "currency_code"
  
  LINE 13:   on x.currency_code = t.currency_code
                                  ^
[0m20:04:26.520365 [error] [Thread-1 (]: 1 of 1 ERROR trf_transaction_exchange_on_day ................................... [[31mERROR[0m in 0.11s]
[0m20:04:26.522023 [debug] [Thread-1 (]: Finished running node test.raysearch_project.trf_transaction_exchange_on_day
[0m20:04:26.522966 [debug] [Thread-7 (]: Marking all children of 'test.raysearch_project.trf_transaction_exchange_on_day' to be skipped because of status 'error'.  Reason: Runtime Error in test trf_transaction_exchange_on_day (models/transformation/tests\trf_transaction_exchange_on_day.sql)
  Binder Error: Values list "t" does not have a column named "currency_code"
  
  LINE 13:   on x.currency_code = t.currency_code
                                  ^.
[0m20:04:26.527947 [debug] [MainThread]: Using duckdb connection "master"
[0m20:04:26.529009 [debug] [MainThread]: On master: BEGIN
[0m20:04:26.529716 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:04:26.531320 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:04:26.532047 [debug] [MainThread]: On master: COMMIT
[0m20:04:26.532728 [debug] [MainThread]: Using duckdb connection "master"
[0m20:04:26.533294 [debug] [MainThread]: On master: COMMIT
[0m20:04:26.534872 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:04:26.535502 [debug] [MainThread]: On master: Close
[0m20:04:26.536261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:04:26.536646 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m20:04:26.537001 [debug] [MainThread]: Connection 'list_warehouse_main_trf' was properly closed.
[0m20:04:26.537342 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m20:04:26.537857 [debug] [MainThread]: Connection 'test.raysearch_project.trf_transaction_exchange_on_day' was properly closed.
[0m20:04:26.538570 [info ] [MainThread]: 
[0m20:04:26.539981 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m20:04:26.542785 [debug] [MainThread]: Command end result
[0m20:04:26.609743 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m20:04:26.616595 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m20:04:26.631415 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m20:04:26.632322 [info ] [MainThread]: 
[0m20:04:26.633373 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:04:26.634338 [info ] [MainThread]: 
[0m20:04:26.635408 [error] [MainThread]: [31mFailure in test trf_transaction_exchange_on_day (models/transformation/tests\trf_transaction_exchange_on_day.sql)[0m
[0m20:04:26.636382 [error] [MainThread]:   Runtime Error in test trf_transaction_exchange_on_day (models/transformation/tests\trf_transaction_exchange_on_day.sql)
  Binder Error: Values list "t" does not have a column named "currency_code"
  
  LINE 13:   on x.currency_code = t.currency_code
                                  ^
[0m20:04:26.637196 [info ] [MainThread]: 
[0m20:04:26.638106 [info ] [MainThread]:   compiled code at target\compiled\raysearch_project\models/transformation/tests\trf_transaction_exchange_on_day.sql
[0m20:04:26.638910 [info ] [MainThread]: 
[0m20:04:26.640938 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:04:26.643601 [debug] [MainThread]: Command `dbt test` failed at 20:04:26.643290 after 3.84 seconds
[0m20:04:26.644443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B701EB890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B71D43C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B71D43CD0>]}
[0m20:04:26.645338 [debug] [MainThread]: Flushing usage events
[0m20:04:27.904804 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:05:01.723965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB79844830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7A97FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7A97F9D0>]}


============================== 20:05:01.733980 | c2c0b175-1c0e-4399-bbf2-f0277b763152 ==============================
[0m20:05:01.733980 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:05:01.735365 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt test --select trf_transaction_exchange_on_day', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m20:05:02.219062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2c0b175-1c0e-4399-bbf2-f0277b763152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB79CB6060>]}
[0m20:05:02.352207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2c0b175-1c0e-4399-bbf2-f0277b763152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7A9EE7A0>]}
[0m20:05:02.360702 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:05:02.849807 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:05:03.369334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:05:03.370733 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models/transformation/tests\trf_transaction_exchange_on_day.sql
[0m20:05:03.371604 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models\transformation\tests\trf_transaction_exchange_on_day.sql
[0m20:05:04.214882 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.raysearch_project.marts
[0m20:05:04.230461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2c0b175-1c0e-4399-bbf2-f0277b763152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7BE87650>]}
[0m20:05:04.460765 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m20:05:04.468130 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m20:05:04.567347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2c0b175-1c0e-4399-bbf2-f0277b763152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7C327E30>]}
[0m20:05:04.568334 [info ] [MainThread]: Found 8 models, 1 snapshot, 3 seeds, 31 data tests, 586 macros
[0m20:05:04.569666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2c0b175-1c0e-4399-bbf2-f0277b763152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7C312970>]}
[0m20:05:04.573971 [info ] [MainThread]: 
[0m20:05:04.575126 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:05:04.576604 [info ] [MainThread]: 
[0m20:05:04.578920 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:05:04.595284 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m20:05:04.612092 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m20:05:04.621604 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_trf'
[0m20:05:04.913225 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m20:05:04.914272 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m20:05:04.915032 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m20:05:04.915696 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m20:05:04.916286 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m20:05:04.916910 [debug] [ThreadPool]: On list_warehouse_main_trf: BEGIN
[0m20:05:04.917462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:04.918036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:04.918548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:04.959834 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m20:05:04.960626 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m20:05:04.961160 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m20:05:04.961759 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m20:05:04.962762 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m20:05:04.963624 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m20:05:04.964274 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m20:05:04.965737 [debug] [ThreadPool]: On list_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_trf"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_trf'
    and lower(table_catalog) = 'warehouse'
  
[0m20:05:04.965044 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m20:05:04.990452 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:05:04.991643 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m20:05:04.992274 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m20:05:04.995104 [debug] [ThreadPool]: On list_warehouse_main_trf: ROLLBACK
[0m20:05:04.997158 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m20:05:04.999225 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m20:05:05.001719 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_trf'
[0m20:05:05.002334 [debug] [ThreadPool]: On list_warehouse_main_trf: Close
[0m20:05:05.005950 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m20:05:05.006730 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m20:05:05.009029 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m20:05:05.009561 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m20:05:05.011671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2c0b175-1c0e-4399-bbf2-f0277b763152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7C3475F0>]}
[0m20:05:05.012502 [debug] [MainThread]: Using duckdb connection "master"
[0m20:05:05.012966 [debug] [MainThread]: On master: BEGIN
[0m20:05:05.013402 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:05:05.014516 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:05:05.014994 [debug] [MainThread]: On master: COMMIT
[0m20:05:05.015447 [debug] [MainThread]: Using duckdb connection "master"
[0m20:05:05.015840 [debug] [MainThread]: On master: COMMIT
[0m20:05:05.016623 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:05:05.017107 [debug] [MainThread]: On master: Close
[0m20:05:05.026642 [debug] [Thread-1 (]: Began running node test.raysearch_project.trf_transaction_exchange_on_day
[0m20:05:05.027433 [info ] [Thread-1 (]: 1 of 1 START test trf_transaction_exchange_on_day .............................. [RUN]
[0m20:05:05.028718 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.raysearch_project.trf_transaction_exchange_on_day'
[0m20:05:05.029334 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.trf_transaction_exchange_on_day
[0m20:05:05.043782 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.trf_transaction_exchange_on_day"
[0m20:05:05.047503 [debug] [Thread-1 (]: Began executing node test.raysearch_project.trf_transaction_exchange_on_day
[0m20:05:05.084214 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.trf_transaction_exchange_on_day"
[0m20:05:05.087549 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.trf_transaction_exchange_on_day"
[0m20:05:05.088278 [debug] [Thread-1 (]: On test.raysearch_project.trf_transaction_exchange_on_day: BEGIN
[0m20:05:05.089469 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:05:05.091541 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:05:05.092206 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.trf_transaction_exchange_on_day"
[0m20:05:05.092758 [debug] [Thread-1 (]: On test.raysearch_project.trf_transaction_exchange_on_day: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.trf_transaction_exchange_on_day"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select t.transaction_date, t.currency
from "warehouse"."main_stg"."stg_transaction" t
left join "warehouse"."main_trf"."trf_currency_exchange_scd2" x
  on x.currency_code = t.currency
 and t.transaction_date between x.etl_valid_from and x.etl_valid_to
where x.currency_code is null
  
  
      
    ) dbt_internal_test
[0m20:05:05.134065 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m20:05:05.143499 [debug] [Thread-1 (]: On test.raysearch_project.trf_transaction_exchange_on_day: ROLLBACK
[0m20:05:05.146203 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.trf_transaction_exchange_on_day'
[0m20:05:05.147056 [debug] [Thread-1 (]: On test.raysearch_project.trf_transaction_exchange_on_day: Close
[0m20:05:05.148528 [info ] [Thread-1 (]: 1 of 1 PASS trf_transaction_exchange_on_day .................................... [[32mPASS[0m in 0.12s]
[0m20:05:05.150056 [debug] [Thread-1 (]: Finished running node test.raysearch_project.trf_transaction_exchange_on_day
[0m20:05:05.152777 [debug] [MainThread]: Using duckdb connection "master"
[0m20:05:05.153414 [debug] [MainThread]: On master: BEGIN
[0m20:05:05.154327 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:05:05.156341 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:05:05.157775 [debug] [MainThread]: On master: COMMIT
[0m20:05:05.158727 [debug] [MainThread]: Using duckdb connection "master"
[0m20:05:05.159242 [debug] [MainThread]: On master: COMMIT
[0m20:05:05.160207 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:05:05.160706 [debug] [MainThread]: On master: Close
[0m20:05:05.161315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:05.161719 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m20:05:05.162144 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m20:05:05.162503 [debug] [MainThread]: Connection 'list_warehouse_main_trf' was properly closed.
[0m20:05:05.162842 [debug] [MainThread]: Connection 'test.raysearch_project.trf_transaction_exchange_on_day' was properly closed.
[0m20:05:05.163302 [info ] [MainThread]: 
[0m20:05:05.164667 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m20:05:05.167034 [debug] [MainThread]: Command end result
[0m20:05:05.235199 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m20:05:05.242316 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m20:05:05.258551 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m20:05:05.259392 [info ] [MainThread]: 
[0m20:05:05.260569 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:05:05.261563 [info ] [MainThread]: 
[0m20:05:05.262587 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:05:05.264425 [debug] [MainThread]: Command `dbt test` succeeded at 20:05:05.264171 after 3.85 seconds
[0m20:05:05.265176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7A71B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7C293C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7C293CD0>]}
[0m20:05:05.265970 [debug] [MainThread]: Flushing usage events
[0m20:05:06.482653 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:21:36.513126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB7D24830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB8E5FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB8E5F9D0>]}


============================== 20:21:36.528300 | 3bb8518a-3198-4c83-a43e-b8f70321e1f0 ==============================
[0m20:21:36.528300 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:21:36.530456 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt compile', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m20:21:37.338291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bb8518a-3198-4c83-a43e-b8f70321e1f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB8196060>]}
[0m20:21:37.529626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3bb8518a-3198-4c83-a43e-b8f70321e1f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB9EA27A0>]}
[0m20:21:37.539694 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:21:38.599715 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:21:39.503936 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 3 files changed.
[0m20:21:39.505760 [debug] [MainThread]: Partial parsing: added file: raysearch_project://models\transformation\trf_currency_exchange.sql
[0m20:21:39.507723 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models\transformation\trf_schema.yml
[0m20:21:39.509333 [debug] [MainThread]: Partial parsing: deleted file: raysearch_project://models\transformation\trf_currency_exchange_scd2.sql
[0m20:21:39.510310 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models\transformation\tests\trf_transaction_exchange_on_day.sql
[0m20:21:39.511152 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models/transformation/tests\trf_transaction_exchange_on_day.sql
[0m20:21:40.931968 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`
defined on 'trf_currency_exchange' in package 'raysearch_project'
(models\transformation\trf_schema.yml). Arguments to generic tests should be
nested under the `arguments` property.
[0m20:21:40.936103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3bb8518a-3198-4c83-a43e-b8f70321e1f0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BBA758450>]}
[0m20:21:41.034496 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.raysearch_project.trf_transaction' (models\transformation\trf_transaction.sql) depends on a node named 'trf_currency_exchange_scd2' which was not found
[0m20:21:41.037165 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:21:41.040938 [debug] [MainThread]: Command `dbt compile` failed at 20:21:41.040414 after 5.06 seconds
[0m20:21:41.042117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BBA77C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BBA77ED50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB8E3BE70>]}
[0m20:21:41.043253 [debug] [MainThread]: Flushing usage events
[0m20:21:42.750182 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:22:05.273491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B52C4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B63FBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B63FB9D0>]}


============================== 20:22:05.286662 | 84ff83c2-e15a-45bb-90e8-0cf54e452391 ==============================
[0m20:22:05.286662 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:22:05.288204 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt compile', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m20:22:05.784249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84ff83c2-e15a-45bb-90e8-0cf54e452391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B5736060>]}
[0m20:22:05.929404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84ff83c2-e15a-45bb-90e8-0cf54e452391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B743E7A0>]}
[0m20:22:05.936799 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:22:06.441680 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:22:06.975465 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 4 files changed.
[0m20:22:06.976821 [debug] [MainThread]: Partial parsing: added file: raysearch_project://models\transformation\trf_currency_exchange.sql
[0m20:22:06.977864 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models\transformation\trf_schema.yml
[0m20:22:06.978813 [debug] [MainThread]: Partial parsing: deleted file: raysearch_project://models\transformation\trf_currency_exchange_scd2.sql
[0m20:22:06.979614 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models/transformation/tests\trf_transaction_exchange_on_day.sql
[0m20:22:06.980210 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models\transformation\tests\trf_transaction_exchange_on_day.sql
[0m20:22:06.980740 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models\transformation\trf_transaction.sql
[0m20:22:07.904325 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`
defined on 'trf_currency_exchange' in package 'raysearch_project'
(models\transformation\trf_schema.yml). Arguments to generic tests should be
nested under the `arguments` property.
[0m20:22:07.906391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '84ff83c2-e15a-45bb-90e8-0cf54e452391', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B7D54450>]}
[0m20:22:08.123834 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.raysearch_project.marts
[0m20:22:08.134969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84ff83c2-e15a-45bb-90e8-0cf54e452391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B79BB200>]}
[0m20:22:08.350153 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m20:22:08.359314 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m20:22:08.432737 [error] [MainThread]: Encountered an error:
Found a cycle: model.raysearch_project.trf_currency_exchange
[0m20:22:08.645411 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 408, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\cli\main.py", line 347, in compile
    results = task.run()
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\task\runnable.py", line 597, in run
    self._runtime_initialize()
    ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\task\base.py", line 135, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\compilation.py", line 679, in compile
    linker.link_graph(manifest)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\compilation.py", line 211, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.raysearch_project.trf_currency_exchange

[0m20:22:08.648852 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:22:08.651399 [debug] [MainThread]: Command `dbt compile` failed at 20:22:08.651108 after 3.71 seconds
[0m20:22:08.652278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B63DBE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B7739D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B7DF28F0>]}
[0m20:22:08.653075 [debug] [MainThread]: Flushing usage events
[0m20:22:10.207413 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:24:31.495399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C18B34830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C19C6FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C19C6F9D0>]}


============================== 20:24:31.507279 | 57edfa03-50c8-40cb-8149-1f0f0bd28dae ==============================
[0m20:24:31.507279 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:24:31.508941 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select trf_currency_exchange', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m20:24:32.002929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57edfa03-50c8-40cb-8149-1f0f0bd28dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C18FA6060>]}
[0m20:24:32.143268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57edfa03-50c8-40cb-8149-1f0f0bd28dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C19CE27A0>]}
[0m20:24:32.150503 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:24:32.629953 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:24:33.142982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:24:33.143840 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:24:33.144346 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:24:33.157342 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.raysearch_project.marts
[0m20:24:33.277812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57edfa03-50c8-40cb-8149-1f0f0bd28dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C1B1BA450>]}
[0m20:24:33.620076 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m20:24:33.628378 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m20:24:33.706503 [error] [MainThread]: Encountered an error:
Found a cycle: model.raysearch_project.trf_currency_exchange
[0m20:24:33.722206 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 391, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 408, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\cli\main.py", line 587, in run
    results = task.run()
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\task\runnable.py", line 597, in run
    self._runtime_initialize()
    ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\task\base.py", line 135, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\compilation.py", line 679, in compile
    linker.link_graph(manifest)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "C:\Users\AMANDAKA\Workspaces\raysearch_project\.venv\Lib\site-packages\dbt\compilation.py", line 211, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.raysearch_project.trf_currency_exchange

[0m20:24:33.725720 [debug] [MainThread]: Command `dbt run` failed at 20:24:33.725407 after 2.54 seconds
[0m20:24:33.726494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C1B4ADD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C1B4ADE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C19C4BE70>]}
[0m20:24:33.727495 [debug] [MainThread]: Flushing usage events
[0m20:24:35.883874 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:27:07.089420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222FECC4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222FFDFFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222FFDFF9D0>]}


============================== 20:27:07.101796 | ad1ad5f0-5218-40a0-80a9-0a1b4f321167 ==============================
[0m20:27:07.101796 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:27:07.103359 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'invocation_command': 'dbt run --select trf_currency_exchange', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m20:27:07.621152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad1ad5f0-5218-40a0-80a9-0a1b4f321167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222FF136060>]}
[0m20:27:07.759131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad1ad5f0-5218-40a0-80a9-0a1b4f321167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222FFE727A0>]}
[0m20:27:07.766109 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:27:08.211550 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:27:08.637569 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:27:08.639027 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models\transformation\trf_currency_exchange.sql
[0m20:27:09.476735 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`
defined on 'trf_currency_exchange' in package 'raysearch_project'
(models\transformation\trf_schema.yml). Arguments to generic tests should be
nested under the `arguments` property.
[0m20:27:09.478307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ad1ad5f0-5218-40a0-80a9-0a1b4f321167', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002228138BA50>]}
[0m20:27:09.683781 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.raysearch_project.marts
[0m20:27:09.698085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad1ad5f0-5218-40a0-80a9-0a1b4f321167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002228166FF20>]}
[0m20:27:09.933387 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m20:27:09.940959 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m20:27:10.028501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad1ad5f0-5218-40a0-80a9-0a1b4f321167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222817EF4D0>]}
[0m20:27:10.029758 [info ] [MainThread]: Found 8 models, 1 snapshot, 3 seeds, 30 data tests, 586 macros
[0m20:27:10.030824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad1ad5f0-5218-40a0-80a9-0a1b4f321167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022281815D90>]}
[0m20:27:10.034830 [info ] [MainThread]: 
[0m20:27:10.036440 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:27:10.037829 [info ] [MainThread]: 
[0m20:27:10.039668 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:27:10.042486 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m20:27:10.327905 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m20:27:10.328957 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m20:27:10.329518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:10.365659 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m20:27:10.368215 [debug] [ThreadPool]: On list_warehouse: Close
[0m20:27:10.369764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_trf)
[0m20:27:10.370926 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_trf"
"
[0m20:27:10.381873 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m20:27:10.382558 [debug] [ThreadPool]: On create_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_trf"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m20:27:10.383060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:10.385166 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:27:10.387713 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m20:27:10.388424 [debug] [ThreadPool]: On create_warehouse_main_trf: BEGIN
[0m20:27:10.390107 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:27:10.390946 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m20:27:10.391534 [debug] [ThreadPool]: On create_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_trf"} */

    
    
        create schema if not exists "warehouse"."main_trf"
    
[0m20:27:10.392737 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:27:10.394171 [debug] [ThreadPool]: On create_warehouse_main_trf: COMMIT
[0m20:27:10.394720 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m20:27:10.395150 [debug] [ThreadPool]: On create_warehouse_main_trf: COMMIT
[0m20:27:10.395968 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:27:10.396482 [debug] [ThreadPool]: On create_warehouse_main_trf: Close
[0m20:27:10.412261 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m20:27:10.424404 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m20:27:10.425199 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m20:27:10.426535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:10.428344 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_trf'
[0m20:27:10.431893 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m20:27:10.432677 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m20:27:10.433420 [debug] [ThreadPool]: On list_warehouse_main_trf: BEGIN
[0m20:27:10.437228 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m20:27:10.438000 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m20:27:10.438518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:10.439138 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m20:27:10.439876 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m20:27:10.441159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:10.441897 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m20:27:10.442453 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:27:10.443644 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m20:27:10.444330 [debug] [ThreadPool]: On list_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_trf"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_trf'
    and lower(table_catalog) = 'warehouse'
  
[0m20:27:10.444893 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:27:10.445762 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m20:27:10.446692 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m20:27:10.473054 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m20:27:10.474239 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m20:27:10.475069 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m20:27:10.477949 [debug] [ThreadPool]: On list_warehouse_main_trf: ROLLBACK
[0m20:27:10.479823 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m20:27:10.482106 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m20:27:10.487765 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m20:27:10.488520 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m20:27:10.491796 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m20:27:10.492468 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m20:27:10.494601 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_trf'
[0m20:27:10.495120 [debug] [ThreadPool]: On list_warehouse_main_trf: Close
[0m20:27:10.497046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad1ad5f0-5218-40a0-80a9-0a1b4f321167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022281746690>]}
[0m20:27:10.497852 [debug] [MainThread]: Using duckdb connection "master"
[0m20:27:10.498317 [debug] [MainThread]: On master: BEGIN
[0m20:27:10.498744 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:27:10.499846 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:27:10.500311 [debug] [MainThread]: On master: COMMIT
[0m20:27:10.500744 [debug] [MainThread]: Using duckdb connection "master"
[0m20:27:10.501158 [debug] [MainThread]: On master: COMMIT
[0m20:27:10.502081 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:27:10.502583 [debug] [MainThread]: On master: Close
[0m20:27:10.511823 [debug] [Thread-1 (]: Began running node model.raysearch_project.trf_currency_exchange
[0m20:27:10.512891 [info ] [Thread-1 (]: 1 of 1 START sql table model main_trf.trf_currency_exchange .................... [RUN]
[0m20:27:10.514389 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.raysearch_project.trf_currency_exchange'
[0m20:27:10.515017 [debug] [Thread-1 (]: Began compiling node model.raysearch_project.trf_currency_exchange
[0m20:27:10.527939 [debug] [Thread-1 (]: Writing injected SQL for node "model.raysearch_project.trf_currency_exchange"
[0m20:27:10.531983 [debug] [Thread-1 (]: Began executing node model.raysearch_project.trf_currency_exchange
[0m20:27:10.597591 [debug] [Thread-1 (]: Writing runtime sql for node "model.raysearch_project.trf_currency_exchange"
[0m20:27:10.601358 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange"
[0m20:27:10.602117 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: BEGIN
[0m20:27:10.602630 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:27:10.604228 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:27:10.604856 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange"
[0m20:27:10.605457 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange"} */

  
    
    

    create  table
      "warehouse"."main_trf"."trf_currency_exchange__dbt_tmp"
  
    as (
      -- Single-currency daily exchange rates with dedup by date
with src as (
	select * from "warehouse"."main_stg"."stg_currency_exchange"
)
dedup as (
	select *,
		   row_number() over (partition by rate_date order by currency_code) as rn
	from src
)
select rate_date, currency_code, base_rate_eur
from dedup
where rn = 1
    );
  
  
[0m20:27:10.607989 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange"} */

  
    
    

    create  table
      "warehouse"."main_trf"."trf_currency_exchange__dbt_tmp"
  
    as (
      -- Single-currency daily exchange rates with dedup by date
with src as (
	select * from "warehouse"."main_stg"."stg_currency_exchange"
)
dedup as (
	select *,
		   row_number() over (partition by rate_date order by currency_code) as rn
	from src
)
select rate_date, currency_code, base_rate_eur
from dedup
where rn = 1
    );
  
  
[0m20:27:10.609644 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:27:10.611032 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: ROLLBACK
[0m20:27:10.738936 [debug] [Thread-1 (]: Failed to rollback 'model.raysearch_project.trf_currency_exchange'
[0m20:27:10.740403 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: Close
[0m20:27:10.749711 [debug] [Thread-1 (]: Runtime Error in model trf_currency_exchange (models\transformation\trf_currency_exchange.sql)
  Parser Error: syntax error at or near "dedup"
  
  LINE 15: dedup as (
           ^
[0m20:27:10.755004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad1ad5f0-5218-40a0-80a9-0a1b4f321167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022281925DE0>]}
[0m20:27:10.757355 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main_trf.trf_currency_exchange ........... [[31mERROR[0m in 0.24s]
[0m20:27:10.759772 [debug] [Thread-1 (]: Finished running node model.raysearch_project.trf_currency_exchange
[0m20:27:10.760998 [debug] [Thread-7 (]: Marking all children of 'model.raysearch_project.trf_currency_exchange' to be skipped because of status 'error'.  Reason: Runtime Error in model trf_currency_exchange (models\transformation\trf_currency_exchange.sql)
  Parser Error: syntax error at or near "dedup"
  
  LINE 15: dedup as (
           ^.
[0m20:27:10.765977 [debug] [MainThread]: Using duckdb connection "master"
[0m20:27:10.767224 [debug] [MainThread]: On master: BEGIN
[0m20:27:10.767884 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:27:10.769564 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:27:10.770293 [debug] [MainThread]: On master: COMMIT
[0m20:27:10.770806 [debug] [MainThread]: Using duckdb connection "master"
[0m20:27:10.771562 [debug] [MainThread]: On master: COMMIT
[0m20:27:10.773312 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:27:10.774624 [debug] [MainThread]: On master: Close
[0m20:27:10.775856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:27:10.776654 [debug] [MainThread]: Connection 'create_warehouse_main_trf' was properly closed.
[0m20:27:10.777408 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m20:27:10.778247 [debug] [MainThread]: Connection 'list_warehouse_main_trf' was properly closed.
[0m20:27:10.778986 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m20:27:10.779412 [debug] [MainThread]: Connection 'model.raysearch_project.trf_currency_exchange' was properly closed.
[0m20:27:10.779932 [info ] [MainThread]: 
[0m20:27:10.781465 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m20:27:10.783197 [debug] [MainThread]: Command end result
[0m20:27:10.855140 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m20:27:10.862567 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m20:27:10.877808 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m20:27:10.879092 [info ] [MainThread]: 
[0m20:27:10.880682 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:27:10.881674 [info ] [MainThread]: 
[0m20:27:10.882971 [error] [MainThread]: [31mFailure in model trf_currency_exchange (models\transformation\trf_currency_exchange.sql)[0m
[0m20:27:10.884352 [error] [MainThread]:   Runtime Error in model trf_currency_exchange (models\transformation\trf_currency_exchange.sql)
  Parser Error: syntax error at or near "dedup"
  
  LINE 15: dedup as (
           ^
[0m20:27:10.885493 [info ] [MainThread]: 
[0m20:27:10.886806 [info ] [MainThread]:   compiled code at target\compiled\raysearch_project\models\transformation\trf_currency_exchange.sql
[0m20:27:10.887848 [info ] [MainThread]: 
[0m20:27:10.888855 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:27:10.890568 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:27:10.894015 [debug] [MainThread]: Command `dbt run` failed at 20:27:10.893540 after 4.15 seconds
[0m20:27:10.895124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022281B47570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002228171F380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022281AAC850>]}
[0m20:27:10.896153 [debug] [MainThread]: Flushing usage events
[0m20:27:12.548875 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:27:31.482664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221F84C4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221F95FFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221F95FF9D0>]}


============================== 20:27:31.496815 | 95929db2-f496-46f2-9a54-f86d98ec7a19 ==============================
[0m20:27:31.496815 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:27:31.498494 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select trf_currency_exchange', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m20:27:32.020775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95929db2-f496-46f2-9a54-f86d98ec7a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221F8936060>]}
[0m20:27:32.154382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95929db2-f496-46f2-9a54-f86d98ec7a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FA63E7A0>]}
[0m20:27:32.161816 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:27:32.680741 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:27:33.202316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:27:33.203777 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models\transformation\trf_currency_exchange.sql
[0m20:27:34.065551 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`
defined on 'trf_currency_exchange' in package 'raysearch_project'
(models\transformation\trf_schema.yml). Arguments to generic tests should be
nested under the `arguments` property.
[0m20:27:34.067240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '95929db2-f496-46f2-9a54-f86d98ec7a19', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FAB0BB50>]}
[0m20:27:34.257759 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.raysearch_project.marts
[0m20:27:34.269154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95929db2-f496-46f2-9a54-f86d98ec7a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FADF3F20>]}
[0m20:27:34.492971 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m20:27:34.500683 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m20:27:34.598880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95929db2-f496-46f2-9a54-f86d98ec7a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FAF674D0>]}
[0m20:27:34.600019 [info ] [MainThread]: Found 8 models, 1 snapshot, 3 seeds, 30 data tests, 586 macros
[0m20:27:34.601273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95929db2-f496-46f2-9a54-f86d98ec7a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FAF95D90>]}
[0m20:27:34.605594 [info ] [MainThread]: 
[0m20:27:34.607006 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:27:34.608587 [info ] [MainThread]: 
[0m20:27:34.610534 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:27:34.614181 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m20:27:34.852230 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m20:27:34.853015 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m20:27:34.853499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:34.892478 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m20:27:34.895033 [debug] [ThreadPool]: On list_warehouse: Close
[0m20:27:34.896369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_trf)
[0m20:27:34.897522 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_trf"
"
[0m20:27:34.910235 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m20:27:34.910970 [debug] [ThreadPool]: On create_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_trf"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m20:27:34.911454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:34.913619 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:27:34.915813 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m20:27:34.916355 [debug] [ThreadPool]: On create_warehouse_main_trf: BEGIN
[0m20:27:34.917328 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:27:34.917957 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m20:27:34.918414 [debug] [ThreadPool]: On create_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_trf"} */

    
    
        create schema if not exists "warehouse"."main_trf"
    
[0m20:27:34.919355 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:27:34.920854 [debug] [ThreadPool]: On create_warehouse_main_trf: COMMIT
[0m20:27:34.921430 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m20:27:34.922867 [debug] [ThreadPool]: On create_warehouse_main_trf: COMMIT
[0m20:27:34.924184 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:27:34.924863 [debug] [ThreadPool]: On create_warehouse_main_trf: Close
[0m20:27:34.936893 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_trf'
[0m20:27:34.940818 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m20:27:34.947642 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m20:27:34.951795 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m20:27:34.958886 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m20:27:34.955507 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m20:27:34.960276 [debug] [ThreadPool]: On list_warehouse_main_trf: BEGIN
[0m20:27:34.960784 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m20:27:34.961225 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m20:27:34.961832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:34.962406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:34.962996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:34.965129 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:27:34.965825 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m20:27:34.966397 [debug] [ThreadPool]: On list_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_trf"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_trf'
    and lower(table_catalog) = 'warehouse'
  
[0m20:27:34.967478 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m20:27:34.968356 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m20:27:34.969213 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m20:27:34.970161 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m20:27:34.971133 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m20:27:34.973853 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m20:27:34.993399 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m20:27:34.994471 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m20:27:34.996783 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m20:27:34.999046 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m20:27:35.000404 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m20:27:35.002617 [debug] [ThreadPool]: On list_warehouse_main_trf: ROLLBACK
[0m20:27:35.005388 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m20:27:35.006185 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m20:27:35.009315 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m20:27:35.009919 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m20:27:35.012609 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_trf'
[0m20:27:35.013246 [debug] [ThreadPool]: On list_warehouse_main_trf: Close
[0m20:27:35.016417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95929db2-f496-46f2-9a54-f86d98ec7a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FAE95F10>]}
[0m20:27:35.017322 [debug] [MainThread]: Using duckdb connection "master"
[0m20:27:35.017863 [debug] [MainThread]: On master: BEGIN
[0m20:27:35.018336 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:27:35.019514 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:27:35.020152 [debug] [MainThread]: On master: COMMIT
[0m20:27:35.020686 [debug] [MainThread]: Using duckdb connection "master"
[0m20:27:35.021176 [debug] [MainThread]: On master: COMMIT
[0m20:27:35.022998 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:27:35.023597 [debug] [MainThread]: On master: Close
[0m20:27:35.032458 [debug] [Thread-1 (]: Began running node model.raysearch_project.trf_currency_exchange
[0m20:27:35.033579 [info ] [Thread-1 (]: 1 of 1 START sql table model main_trf.trf_currency_exchange .................... [RUN]
[0m20:27:35.035132 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.raysearch_project.trf_currency_exchange'
[0m20:27:35.035787 [debug] [Thread-1 (]: Began compiling node model.raysearch_project.trf_currency_exchange
[0m20:27:35.048460 [debug] [Thread-1 (]: Writing injected SQL for node "model.raysearch_project.trf_currency_exchange"
[0m20:27:35.052085 [debug] [Thread-1 (]: Began executing node model.raysearch_project.trf_currency_exchange
[0m20:27:35.114662 [debug] [Thread-1 (]: Writing runtime sql for node "model.raysearch_project.trf_currency_exchange"
[0m20:27:35.118085 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange"
[0m20:27:35.118833 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: BEGIN
[0m20:27:35.119427 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:27:35.121874 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:27:35.122552 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange"
[0m20:27:35.123224 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange"} */

  
    
    

    create  table
      "warehouse"."main_trf"."trf_currency_exchange__dbt_tmp"
  
    as (
      -- Single-currency daily exchange rates with dedup by date
with src as (
	select * from "warehouse"."main_stg"."stg_currency_exchange"
),
dedup as (
	select *,
		   row_number() over (partition by rate_date order by currency_code) as rn
	from src
)
select rate_date, currency_code, base_rate_eur
from dedup
where rn = 1
    );
  
  
[0m20:27:35.140113 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m20:27:35.151356 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange"
[0m20:27:35.152153 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange"} */
alter table "warehouse"."main_trf"."trf_currency_exchange__dbt_tmp" rename to "trf_currency_exchange"
[0m20:27:35.153712 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:27:35.180382 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: COMMIT
[0m20:27:35.181407 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange"
[0m20:27:35.182284 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: COMMIT
[0m20:27:35.196790 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:27:35.207795 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange"
[0m20:27:35.208630 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange"} */

      drop table if exists "warehouse"."main_trf"."trf_currency_exchange__dbt_backup" cascade
    
[0m20:27:35.210050 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:27:35.214031 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: Close
[0m20:27:35.218645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95929db2-f496-46f2-9a54-f86d98ec7a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FB0AA0A0>]}
[0m20:27:35.220081 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_trf.trf_currency_exchange ............... [[32mOK[0m in 0.18s]
[0m20:27:35.222380 [debug] [Thread-1 (]: Finished running node model.raysearch_project.trf_currency_exchange
[0m20:27:35.225812 [debug] [MainThread]: Using duckdb connection "master"
[0m20:27:35.226863 [debug] [MainThread]: On master: BEGIN
[0m20:27:35.227473 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:27:35.229412 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:27:35.230214 [debug] [MainThread]: On master: COMMIT
[0m20:27:35.230693 [debug] [MainThread]: Using duckdb connection "master"
[0m20:27:35.231342 [debug] [MainThread]: On master: COMMIT
[0m20:27:35.232506 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:27:35.233037 [debug] [MainThread]: On master: Close
[0m20:27:35.233758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:27:35.234191 [debug] [MainThread]: Connection 'create_warehouse_main_trf' was properly closed.
[0m20:27:35.234565 [debug] [MainThread]: Connection 'list_warehouse_main_trf' was properly closed.
[0m20:27:35.234931 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m20:27:35.235297 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m20:27:35.235690 [debug] [MainThread]: Connection 'model.raysearch_project.trf_currency_exchange' was properly closed.
[0m20:27:35.236201 [info ] [MainThread]: 
[0m20:27:35.239122 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m20:27:35.242180 [debug] [MainThread]: Command end result
[0m20:27:35.327145 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m20:27:35.333322 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m20:27:35.345777 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m20:27:35.346690 [info ] [MainThread]: 
[0m20:27:35.347842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:27:35.348809 [info ] [MainThread]: 
[0m20:27:35.349890 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:27:35.351380 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:27:35.353940 [debug] [MainThread]: Command `dbt run` succeeded at 20:27:35.353684 after 4.18 seconds
[0m20:27:35.354654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FB2B71B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FB201A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FAED2250>]}
[0m20:27:35.355922 [debug] [MainThread]: Flushing usage events
[0m20:27:36.486352 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:34:05.391532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BBE3B4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BBF4EBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BBF4EB9D0>]}


============================== 20:34:05.405905 | ddae3c5b-40b5-4dd2-8edf-4eec27127dac ==============================
[0m20:34:05.405905 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:34:05.408174 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select trf_currency_exchange', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m20:34:06.846047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddae3c5b-40b5-4dd2-8edf-4eec27127dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BBE826060>]}
[0m20:34:07.035129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddae3c5b-40b5-4dd2-8edf-4eec27127dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC05327A0>]}
[0m20:34:07.112200 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:34:08.277612 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:34:17.220108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:34:17.222025 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models\transformation\trf_currency_exchange.sql
[0m20:34:18.049998 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`
defined on 'trf_currency_exchange' in package 'raysearch_project'
(models\transformation\trf_schema.yml). Arguments to generic tests should be
nested under the `arguments` property.
[0m20:34:18.052890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ddae3c5b-40b5-4dd2-8edf-4eec27127dac', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC09BBB50>]}
[0m20:34:18.247508 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.raysearch_project.marts
[0m20:34:18.259338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddae3c5b-40b5-4dd2-8edf-4eec27127dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC0C9FF20>]}
[0m20:34:18.481230 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m20:34:18.545673 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m20:34:18.661699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddae3c5b-40b5-4dd2-8edf-4eec27127dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC0E234D0>]}
[0m20:34:18.662892 [info ] [MainThread]: Found 8 models, 1 snapshot, 3 seeds, 30 data tests, 586 macros
[0m20:34:18.664216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddae3c5b-40b5-4dd2-8edf-4eec27127dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC0E45D90>]}
[0m20:34:18.668401 [info ] [MainThread]: 
[0m20:34:18.670549 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:34:18.671677 [info ] [MainThread]: 
[0m20:34:18.673120 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:34:18.676259 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m20:34:33.607806 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m20:34:33.608932 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m20:34:33.609860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:33.659012 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m20:34:33.661744 [debug] [ThreadPool]: On list_warehouse: Close
[0m20:34:33.663306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_trf)
[0m20:34:33.664233 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_trf"
"
[0m20:34:33.675247 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m20:34:33.676022 [debug] [ThreadPool]: On create_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_trf"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m20:34:33.676515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:34:33.679151 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:34:33.682799 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m20:34:33.683673 [debug] [ThreadPool]: On create_warehouse_main_trf: BEGIN
[0m20:34:33.686073 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:34:33.687085 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m20:34:33.688012 [debug] [ThreadPool]: On create_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_trf"} */

    
    
        create schema if not exists "warehouse"."main_trf"
    
[0m20:34:33.689083 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:34:33.690560 [debug] [ThreadPool]: On create_warehouse_main_trf: COMMIT
[0m20:34:33.691099 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m20:34:33.691781 [debug] [ThreadPool]: On create_warehouse_main_trf: COMMIT
[0m20:34:33.692574 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:34:33.693430 [debug] [ThreadPool]: On create_warehouse_main_trf: Close
[0m20:34:33.707012 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_trf'
[0m20:34:33.717428 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m20:34:33.719299 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m20:34:33.720019 [debug] [ThreadPool]: On list_warehouse_main_trf: BEGIN
[0m20:34:33.723387 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m20:34:33.724092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:33.725074 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m20:34:33.725885 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m20:34:33.730326 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m20:34:33.731126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:33.731758 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m20:34:33.732799 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:34:33.733487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:33.734862 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:34:33.736131 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m20:34:33.737475 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m20:34:33.738098 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m20:34:33.738841 [debug] [ThreadPool]: On list_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_trf"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_trf'
    and lower(table_catalog) = 'warehouse'
  
[0m20:34:33.739471 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m20:34:33.740169 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m20:34:33.741858 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m20:34:33.773854 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m20:34:33.777184 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m20:34:33.778629 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m20:34:33.779526 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m20:34:33.781693 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m20:34:33.783736 [debug] [ThreadPool]: On list_warehouse_main_trf: ROLLBACK
[0m20:34:33.839820 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m20:34:33.841053 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m20:34:33.846061 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m20:34:33.846879 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m20:34:33.849965 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_trf'
[0m20:34:33.850778 [debug] [ThreadPool]: On list_warehouse_main_trf: Close
[0m20:34:33.853894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddae3c5b-40b5-4dd2-8edf-4eec27127dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC0D72690>]}
[0m20:34:33.854810 [debug] [MainThread]: Using duckdb connection "master"
[0m20:34:33.855296 [debug] [MainThread]: On master: BEGIN
[0m20:34:33.855752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:34:33.856962 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:34:33.857488 [debug] [MainThread]: On master: COMMIT
[0m20:34:33.857926 [debug] [MainThread]: Using duckdb connection "master"
[0m20:34:33.858323 [debug] [MainThread]: On master: COMMIT
[0m20:34:33.859545 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:34:33.860094 [debug] [MainThread]: On master: Close
[0m20:34:33.871324 [debug] [Thread-1 (]: Began running node model.raysearch_project.trf_currency_exchange
[0m20:34:33.872420 [info ] [Thread-1 (]: 1 of 1 START sql table model main_trf.trf_currency_exchange .................... [RUN]
[0m20:34:33.874316 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.raysearch_project.trf_currency_exchange'
[0m20:34:33.875038 [debug] [Thread-1 (]: Began compiling node model.raysearch_project.trf_currency_exchange
[0m20:34:33.887499 [debug] [Thread-1 (]: Writing injected SQL for node "model.raysearch_project.trf_currency_exchange"
[0m20:34:33.892261 [debug] [Thread-1 (]: Began executing node model.raysearch_project.trf_currency_exchange
[0m20:34:33.967341 [debug] [Thread-1 (]: Writing runtime sql for node "model.raysearch_project.trf_currency_exchange"
[0m20:34:33.971466 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange"
[0m20:34:33.972292 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: BEGIN
[0m20:34:33.972831 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:34:33.974659 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:34:33.975287 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange"
[0m20:34:33.975837 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange"} */

  
    
    

    create  table
      "warehouse"."main_trf"."trf_currency_exchange__dbt_tmp"
  
    as (
      -- Single-currency daily exchange rates with dedup by date
with src as (
	select * from "warehouse"."main_stg"."stg_currency_exchange"
)
select rate_date, currency_code, base_rate_eur
from src
    );
  
  
[0m20:34:33.980845 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:34:33.991688 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange"
[0m20:34:33.992563 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_trf'
      AND table_name = 'trf_currency_exchange'
  
[0m20:34:33.994531 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:34:33.996836 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange"
[0m20:34:33.997502 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_trf'
      AND table_name = 'trf_currency_exchange'
  
[0m20:34:33.999356 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:34:34.014214 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange"
[0m20:34:34.015045 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange"} */
alter table "warehouse"."main_trf"."trf_currency_exchange" rename to "trf_currency_exchange__dbt_backup"
[0m20:34:34.016751 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:34:34.023283 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange"
[0m20:34:34.024654 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange"} */
alter table "warehouse"."main_trf"."trf_currency_exchange__dbt_tmp" rename to "trf_currency_exchange"
[0m20:34:34.026366 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:34:34.053887 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: COMMIT
[0m20:34:34.054861 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange"
[0m20:34:34.055468 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: COMMIT
[0m20:34:34.062005 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:34:34.072758 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_currency_exchange"
[0m20:34:34.073993 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_currency_exchange"} */

      drop table if exists "warehouse"."main_trf"."trf_currency_exchange__dbt_backup" cascade
    
[0m20:34:34.077680 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:34:34.082275 [debug] [Thread-1 (]: On model.raysearch_project.trf_currency_exchange: Close
[0m20:34:34.088080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddae3c5b-40b5-4dd2-8edf-4eec27127dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC0F62200>]}
[0m20:34:34.089507 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_trf.trf_currency_exchange ............... [[32mOK[0m in 0.21s]
[0m20:34:34.091347 [debug] [Thread-1 (]: Finished running node model.raysearch_project.trf_currency_exchange
[0m20:34:34.094136 [debug] [MainThread]: Using duckdb connection "master"
[0m20:34:34.094759 [debug] [MainThread]: On master: BEGIN
[0m20:34:34.095234 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:34:34.096383 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:34:34.096897 [debug] [MainThread]: On master: COMMIT
[0m20:34:34.097368 [debug] [MainThread]: Using duckdb connection "master"
[0m20:34:34.097786 [debug] [MainThread]: On master: COMMIT
[0m20:34:34.099788 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:34:34.102855 [debug] [MainThread]: On master: Close
[0m20:34:34.104734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:34:34.106522 [debug] [MainThread]: Connection 'create_warehouse_main_trf' was properly closed.
[0m20:34:34.107246 [debug] [MainThread]: Connection 'list_warehouse_main_trf' was properly closed.
[0m20:34:34.107935 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m20:34:34.108460 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m20:34:34.108911 [debug] [MainThread]: Connection 'model.raysearch_project.trf_currency_exchange' was properly closed.
[0m20:34:34.109810 [info ] [MainThread]: 
[0m20:34:34.110956 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.44 seconds (15.44s).
[0m20:34:34.112506 [debug] [MainThread]: Command end result
[0m20:34:34.182742 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m20:34:34.191606 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m20:34:34.203872 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m20:34:34.204874 [info ] [MainThread]: 
[0m20:34:34.206342 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:34:34.207214 [info ] [MainThread]: 
[0m20:34:34.208157 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:34:34.209302 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:34:34.211821 [debug] [MainThread]: Command `dbt run` succeeded at 20:34:34.211478 after 29.61 seconds
[0m20:34:34.212893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC228D630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC10B6BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BC0D86250>]}
[0m20:34:34.213600 [debug] [MainThread]: Flushing usage events
[0m20:34:35.754778 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:35:47.115427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002412C234830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002412D36FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002412D36F9D0>]}


============================== 20:35:47.125937 | 1de0ef1d-cf15-48ba-a449-06fc38b74cae ==============================
[0m20:35:47.125937 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:35:47.127179 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m20:35:47.651658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1de0ef1d-cf15-48ba-a449-06fc38b74cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002412C6A6060>]}
[0m20:35:47.782178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1de0ef1d-cf15-48ba-a449-06fc38b74cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002412D3DE7A0>]}
[0m20:35:47.792216 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:35:48.366009 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:35:48.860061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:35:48.860938 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:35:48.861430 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:35:48.873430 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.raysearch_project.marts
[0m20:35:48.986835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1de0ef1d-cf15-48ba-a449-06fc38b74cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002412E8B6C50>]}
[0m20:35:49.324071 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m20:35:49.331999 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m20:35:49.443574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1de0ef1d-cf15-48ba-a449-06fc38b74cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002412EC48320>]}
[0m20:35:49.444759 [info ] [MainThread]: Found 8 models, 1 snapshot, 3 seeds, 30 data tests, 586 macros
[0m20:35:49.446036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1de0ef1d-cf15-48ba-a449-06fc38b74cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002412EA33CB0>]}
[0m20:35:49.452720 [info ] [MainThread]: 
[0m20:35:49.454056 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:35:49.454905 [info ] [MainThread]: 
[0m20:35:49.456520 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:35:49.473223 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_trf'
[0m20:35:49.478362 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m20:35:49.513478 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m20:35:49.774136 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m20:35:49.775087 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m20:35:49.775793 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m20:35:49.776375 [debug] [ThreadPool]: On list_warehouse_main_trf: BEGIN
[0m20:35:49.776996 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m20:35:49.777601 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m20:35:49.778184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:49.778755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:49.779325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:49.816650 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m20:35:49.817579 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m20:35:49.818366 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m20:35:49.819002 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m20:35:49.819565 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m20:35:49.820250 [debug] [ThreadPool]: On list_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_trf"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_trf'
    and lower(table_catalog) = 'warehouse'
  
[0m20:35:49.820913 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m20:35:49.821530 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m20:35:49.822954 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m20:35:49.855704 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m20:35:49.856701 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m20:35:49.859507 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m20:35:49.860312 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m20:35:49.862443 [debug] [ThreadPool]: On list_warehouse_main_trf: ROLLBACK
[0m20:35:49.865601 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m20:35:49.868714 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m20:35:49.869503 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m20:35:49.873106 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_trf'
[0m20:35:49.873858 [debug] [ThreadPool]: On list_warehouse_main_trf: Close
[0m20:35:49.876244 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m20:35:49.876958 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m20:35:49.879313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1de0ef1d-cf15-48ba-a449-06fc38b74cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002412CD89980>]}
[0m20:35:49.880268 [debug] [MainThread]: Using duckdb connection "master"
[0m20:35:49.880999 [debug] [MainThread]: On master: BEGIN
[0m20:35:49.881634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:35:49.883114 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:35:49.883667 [debug] [MainThread]: On master: COMMIT
[0m20:35:49.884122 [debug] [MainThread]: Using duckdb connection "master"
[0m20:35:49.884535 [debug] [MainThread]: On master: COMMIT
[0m20:35:49.885426 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:35:49.885942 [debug] [MainThread]: On master: Close
[0m20:35:49.896844 [debug] [Thread-4 (]: Began running node test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41
[0m20:35:49.898038 [debug] [Thread-3 (]: Began running node test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb
[0m20:35:49.899010 [debug] [Thread-1 (]: Began running node test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c
[0m20:35:49.899774 [debug] [Thread-2 (]: Began running node test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773
[0m20:35:49.900609 [info ] [Thread-4 (]: 4 of 30 START test accepted_values_customer_wantsNewsletter__0__1 .............. [RUN]
[0m20:35:49.901395 [info ] [Thread-3 (]: 3 of 30 START test accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE . [RUN]
[0m20:35:49.902352 [info ] [Thread-1 (]: 1 of 30 START test accepted_values_customer_KYC__0__1 .......................... [RUN]
[0m20:35:49.904298 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41'
[0m20:35:49.905497 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb'
[0m20:35:49.906558 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c'
[0m20:35:49.903080 [info ] [Thread-2 (]: 2 of 30 START test accepted_values_customer_VIP__0__1 .......................... [RUN]
[0m20:35:49.907866 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41
[0m20:35:49.908794 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb
[0m20:35:49.909566 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c
[0m20:35:49.910932 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773'
[0m20:35:49.962171 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"
[0m20:35:49.963335 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"
[0m20:35:49.972828 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"
[0m20:35:49.973923 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773
[0m20:35:49.983306 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"
[0m20:35:49.985045 [debug] [Thread-3 (]: Began executing node test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb
[0m20:35:49.985966 [debug] [Thread-4 (]: Began executing node test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41
[0m20:35:49.994534 [debug] [Thread-1 (]: Began executing node test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c
[0m20:35:50.052790 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"
[0m20:35:50.055826 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"
[0m20:35:50.058026 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"
[0m20:35:50.059791 [debug] [Thread-2 (]: Began executing node test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773
[0m20:35:50.065143 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"
[0m20:35:50.067036 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"
[0m20:35:50.068388 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"
[0m20:35:50.069435 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"
[0m20:35:50.070307 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c: BEGIN
[0m20:35:50.071302 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb: BEGIN
[0m20:35:50.072246 [debug] [Thread-4 (]: On test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41: BEGIN
[0m20:35:50.073320 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"
[0m20:35:50.074041 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:35:50.074959 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:35:50.075930 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:35:50.076787 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773: BEGIN
[0m20:35:50.079377 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:35:50.080069 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:35:50.080907 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m20:35:50.081557 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"
[0m20:35:50.082449 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m20:35:50.083878 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"
[0m20:35:50.084825 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        KYC as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."customer"
    group by KYC

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  
      
    ) dbt_internal_test
[0m20:35:50.085690 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m20:35:50.086308 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"
[0m20:35:50.087184 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."customer"
    group by state

)

select *
from all_values
where value_field not in (
    'VALIDATED','SIGNUP','INACTIVE'
)



  
  
      
    ) dbt_internal_test
[0m20:35:50.088553 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"
[0m20:35:50.089338 [debug] [Thread-4 (]: On test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        wantsNewsletter as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."customer"
    group by wantsNewsletter

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  
      
    ) dbt_internal_test
[0m20:35:50.090597 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        VIP as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."customer"
    group by VIP

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  
      
    ) dbt_internal_test
[0m20:35:50.091415 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:35:50.092647 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:35:50.099418 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m20:35:50.102951 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c: ROLLBACK
[0m20:35:50.105829 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb: ROLLBACK
[0m20:35:50.108443 [debug] [Thread-4 (]: On test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41: ROLLBACK
[0m20:35:50.109414 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m20:35:50.112353 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773: ROLLBACK
[0m20:35:50.114732 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c'
[0m20:35:50.115819 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c: Close
[0m20:35:50.118535 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb'
[0m20:35:50.117379 [info ] [Thread-1 (]: 1 of 30 PASS accepted_values_customer_KYC__0__1 ................................ [[32mPASS[0m in 0.21s]
[0m20:35:50.119511 [debug] [Thread-3 (]: On test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb: Close
[0m20:35:50.120603 [debug] [Thread-1 (]: Finished running node test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c
[0m20:35:50.121675 [debug] [Thread-1 (]: Began running node test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a
[0m20:35:50.123182 [info ] [Thread-3 (]: 3 of 30 PASS accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE ....... [[32mPASS[0m in 0.22s]
[0m20:35:50.126071 [debug] [Thread-3 (]: Finished running node test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb
[0m20:35:50.124677 [info ] [Thread-1 (]: 5 of 30 START test accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL ..... [RUN]
[0m20:35:50.127372 [debug] [Thread-3 (]: Began running node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_rate_date__currency_code.225df91bc9
[0m20:35:50.128991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_customer_KYC__0__1.7db04dbc5c, now test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a)
[0m20:35:50.130781 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a
[0m20:35:50.129780 [info ] [Thread-3 (]: 6 of 30 START test dbt_utils_unique_combination_of_columns_trf_currency_exchange_rate_date__currency_code  [RUN]
[0m20:35:50.140170 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773'
[0m20:35:50.143025 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"
[0m20:35:50.143926 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_customer_state__VALIDATED__SIGNUP__INACTIVE.e1ca1269bb, now test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_rate_date__currency_code.225df91bc9)
[0m20:35:50.144773 [debug] [Thread-2 (]: On test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773: Close
[0m20:35:50.146004 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_rate_date__currency_code.225df91bc9
[0m20:35:50.154942 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41'
[0m20:35:50.156945 [debug] [Thread-4 (]: On test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41: Close
[0m20:35:50.156262 [info ] [Thread-2 (]: 2 of 30 PASS accepted_values_customer_VIP__0__1 ................................ [[32mPASS[0m in 0.25s]
[0m20:35:50.158241 [debug] [Thread-1 (]: Began executing node test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a
[0m20:35:50.173703 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_rate_date__currency_code.225df91bc9"
[0m20:35:50.176918 [debug] [Thread-2 (]: Finished running node test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773
[0m20:35:50.175634 [info ] [Thread-4 (]: 4 of 30 PASS accepted_values_customer_wantsNewsletter__0__1 .................... [[32mPASS[0m in 0.27s]
[0m20:35:50.181316 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"
[0m20:35:50.182706 [debug] [Thread-2 (]: Began running node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49
[0m20:35:50.184358 [debug] [Thread-4 (]: Finished running node test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41
[0m20:35:50.186753 [debug] [Thread-4 (]: Began running node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78
[0m20:35:50.185536 [info ] [Thread-2 (]: 7 of 30 START test dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from  [RUN]
[0m20:35:50.189031 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_customer_VIP__0__1.93c0b14773, now test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49)
[0m20:35:50.189804 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49
[0m20:35:50.188057 [info ] [Thread-4 (]: 8 of 30 START test dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type  [RUN]
[0m20:35:50.201033 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49"
[0m20:35:50.202192 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"
[0m20:35:50.203096 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_customer_wantsNewsletter__0__1.d2b7998b41, now test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78)
[0m20:35:50.203898 [debug] [Thread-3 (]: Began executing node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_rate_date__currency_code.225df91bc9
[0m20:35:50.204790 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a: BEGIN
[0m20:35:50.205547 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78
[0m20:35:50.209860 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_rate_date__currency_code.225df91bc9"
[0m20:35:50.211105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:50.219538 [debug] [Thread-2 (]: Began executing node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49
[0m20:35:50.226041 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78"
[0m20:35:50.231769 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49"
[0m20:35:50.233966 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m20:35:50.235994 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"
[0m20:35:50.236943 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_rate_date__currency_code.225df91bc9"
[0m20:35:50.237585 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        txType as value_field,
        count(*) as n_records

    from "warehouse"."main_raw"."transaction"
    group by txType

)

select *
from all_values
where value_field not in (
    'DEPOSIT','WITHDRAWAL'
)



  
  
      
    ) dbt_internal_test
[0m20:35:50.238514 [debug] [Thread-3 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_rate_date__currency_code.225df91bc9: BEGIN
[0m20:35:50.239352 [debug] [Thread-4 (]: Began executing node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78
[0m20:35:50.241067 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:35:50.245920 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78"
[0m20:35:50.246800 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:35:50.248062 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49"
[0m20:35:50.250134 [debug] [Thread-2 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49: BEGIN
[0m20:35:50.251360 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m20:35:50.254645 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a: ROLLBACK
[0m20:35:50.255471 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:35:50.256530 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_rate_date__currency_code.225df91bc9"
[0m20:35:50.258546 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78"
[0m20:35:50.259382 [debug] [Thread-3 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_rate_date__currency_code.225df91bc9: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_rate_date__currency_code.225df91bc9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        rate_date, currency_code
    from "warehouse"."main_trf"."trf_currency_exchange"
    group by rate_date, currency_code
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m20:35:50.260317 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m20:35:50.261047 [debug] [Thread-4 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78: BEGIN
[0m20:35:50.262627 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49"
[0m20:35:50.263829 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:35:50.265091 [debug] [Thread-2 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        customer_id, etl_valid_from
    from "warehouse"."main_trf"."trf_customer_scd2"
    group by customer_id, etl_valid_from
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m20:35:50.269285 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a'
[0m20:35:50.270595 [debug] [Thread-1 (]: On test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a: Close
[0m20:35:50.271614 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m20:35:50.272740 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m20:35:50.274939 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78"
[0m20:35:50.274123 [info ] [Thread-1 (]: 5 of 30 PASS accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL ........... [[32mPASS[0m in 0.15s]
[0m20:35:50.275879 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m20:35:50.276735 [debug] [Thread-4 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        transaction_date, customer_id, country_code, account_type
    from "warehouse"."main_trf"."trf_transaction"
    group by transaction_date, customer_id, country_code, account_type
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m20:35:50.279220 [debug] [Thread-3 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_rate_date__currency_code.225df91bc9: ROLLBACK
[0m20:35:50.280249 [debug] [Thread-1 (]: Finished running node test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a
[0m20:35:50.284223 [debug] [Thread-2 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49: ROLLBACK
[0m20:35:50.286396 [debug] [Thread-1 (]: Began running node test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff
[0m20:35:50.288309 [info ] [Thread-1 (]: 9 of 30 START test not_null_currency_exchange_baseRateEuro ..................... [RUN]
[0m20:35:50.290056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.accepted_values_transaction_txType__DEPOSIT__WITHDRAWAL.005c6de30a, now test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff)
[0m20:35:50.290937 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m20:35:50.291756 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff
[0m20:35:50.293462 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_rate_date__currency_code.225df91bc9'
[0m20:35:50.311449 [debug] [Thread-4 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78: ROLLBACK
[0m20:35:50.314584 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"
[0m20:35:50.315794 [debug] [Thread-3 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_rate_date__currency_code.225df91bc9: Close
[0m20:35:50.318303 [info ] [Thread-3 (]: 6 of 30 PASS dbt_utils_unique_combination_of_columns_trf_currency_exchange_rate_date__currency_code  [[32mPASS[0m in 0.17s]
[0m20:35:50.320078 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49'
[0m20:35:50.321128 [debug] [Thread-3 (]: Finished running node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_rate_date__currency_code.225df91bc9
[0m20:35:50.321954 [debug] [Thread-2 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49: Close
[0m20:35:50.322906 [debug] [Thread-1 (]: Began executing node test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff
[0m20:35:50.323870 [debug] [Thread-3 (]: Began running node test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f
[0m20:35:50.329438 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"
[0m20:35:50.330982 [info ] [Thread-2 (]: 7 of 30 PASS dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from  [[32mPASS[0m in 0.14s]
[0m20:35:50.334117 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78'
[0m20:35:50.335520 [info ] [Thread-3 (]: 10 of 30 START test not_null_currency_exchange_currency ........................ [RUN]
[0m20:35:50.337341 [debug] [Thread-2 (]: Finished running node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49
[0m20:35:50.338272 [debug] [Thread-4 (]: On test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78: Close
[0m20:35:50.339544 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_currency_exchange_rate_date__currency_code.225df91bc9, now test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f)
[0m20:35:50.340332 [debug] [Thread-2 (]: Began running node test.raysearch_project.not_null_currency_exchange_date.f508e913b3
[0m20:35:50.341225 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"
[0m20:35:50.342082 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f
[0m20:35:50.343117 [info ] [Thread-4 (]: 8 of 30 PASS dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type  [[32mPASS[0m in 0.14s]
[0m20:35:50.344871 [debug] [Thread-1 (]: On test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff: BEGIN
[0m20:35:50.353993 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"
[0m20:35:50.343923 [info ] [Thread-2 (]: 11 of 30 START test not_null_currency_exchange_date ............................ [RUN]
[0m20:35:50.355713 [debug] [Thread-4 (]: Finished running node test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78
[0m20:35:50.356485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:50.357870 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_customer_scd2_customer_id__etl_valid_from.90b4e97f49, now test.raysearch_project.not_null_currency_exchange_date.f508e913b3)
[0m20:35:50.358735 [debug] [Thread-4 (]: Began running node test.raysearch_project.not_null_customer_customerID.cdb9e51021
[0m20:35:50.360199 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.not_null_currency_exchange_date.f508e913b3
[0m20:35:50.369927 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"
[0m20:35:50.360975 [info ] [Thread-4 (]: 12 of 30 START test not_null_customer_customerID ............................... [RUN]
[0m20:35:50.371108 [debug] [Thread-3 (]: Began executing node test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f
[0m20:35:50.371866 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m20:35:50.372984 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.raysearch_project.dbt_utils_unique_combination_of_columns_trf_transaction_transaction_date__customer_id__country_code__account_type.a655f84d78, now test.raysearch_project.not_null_customer_customerID.cdb9e51021)
[0m20:35:50.377629 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"
[0m20:35:50.378616 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"
[0m20:35:50.379471 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.not_null_customer_customerID.cdb9e51021
[0m20:35:50.380421 [debug] [Thread-1 (]: On test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select baseRateEuro
from "warehouse"."main_raw"."currency_exchange"
where baseRateEuro is null



  
  
      
    ) dbt_internal_test
[0m20:35:50.381550 [debug] [Thread-2 (]: Began executing node test.raysearch_project.not_null_currency_exchange_date.f508e913b3
[0m20:35:50.389987 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.not_null_customer_customerID.cdb9e51021"
[0m20:35:50.396480 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"
[0m20:35:50.397938 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:35:50.399408 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"
[0m20:35:50.400979 [debug] [Thread-3 (]: On test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f: BEGIN
[0m20:35:50.403754 [debug] [Thread-1 (]: On test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff: ROLLBACK
[0m20:35:50.404641 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:35:50.405412 [debug] [Thread-4 (]: Began executing node test.raysearch_project.not_null_customer_customerID.cdb9e51021
[0m20:35:50.407199 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"
[0m20:35:50.411371 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.not_null_customer_customerID.cdb9e51021"
[0m20:35:50.412354 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m20:35:50.413128 [debug] [Thread-2 (]: On test.raysearch_project.not_null_currency_exchange_date.f508e913b3: BEGIN
[0m20:35:50.414447 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"
[0m20:35:50.415404 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:35:50.416365 [debug] [Thread-3 (]: On test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from "warehouse"."main_raw"."currency_exchange"
where currency is null



  
  
      
    ) dbt_internal_test
[0m20:35:50.418497 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_customer_customerID.cdb9e51021"
[0m20:35:50.419405 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:35:50.420290 [debug] [Thread-4 (]: On test.raysearch_project.not_null_customer_customerID.cdb9e51021: BEGIN
[0m20:35:50.421967 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff'
[0m20:35:50.423178 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"
[0m20:35:50.423965 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m20:35:50.424586 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:35:50.425322 [debug] [Thread-1 (]: On test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff: Close
[0m20:35:50.426039 [debug] [Thread-2 (]: On test.raysearch_project.not_null_currency_exchange_date.f508e913b3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_currency_exchange_date.f508e913b3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_raw"."currency_exchange"
where date is null



  
  
      
    ) dbt_internal_test
[0m20:35:50.429283 [debug] [Thread-3 (]: On test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f: ROLLBACK
[0m20:35:50.432234 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m20:35:50.431130 [info ] [Thread-1 (]: 9 of 30 PASS not_null_currency_exchange_baseRateEuro ........................... [[32mPASS[0m in 0.14s]
[0m20:35:50.434309 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_customer_customerID.cdb9e51021"
[0m20:35:50.435758 [debug] [Thread-1 (]: Finished running node test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff
[0m20:35:50.436463 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m20:35:50.437382 [debug] [Thread-4 (]: On test.raysearch_project.not_null_customer_customerID.cdb9e51021: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_customer_customerID.cdb9e51021"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customerID
from "warehouse"."main_raw"."customer"
where customerID is null



  
  
      
    ) dbt_internal_test
[0m20:35:50.438319 [debug] [Thread-1 (]: Began running node test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b
[0m20:35:50.439952 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f'
[0m20:35:50.443556 [debug] [Thread-2 (]: On test.raysearch_project.not_null_currency_exchange_date.f508e913b3: ROLLBACK
[0m20:35:50.445793 [debug] [Thread-3 (]: On test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f: Close
[0m20:35:50.445047 [info ] [Thread-1 (]: 13 of 30 START test not_null_customer_latestUpdate ............................. [RUN]
[0m20:35:50.447198 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:35:50.448589 [info ] [Thread-3 (]: 10 of 30 PASS not_null_currency_exchange_currency .............................. [[32mPASS[0m in 0.11s]
[0m20:35:50.451620 [debug] [Thread-3 (]: Finished running node test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f
[0m20:35:50.452616 [debug] [Thread-3 (]: Began running node test.raysearch_project.not_null_transaction_amount.8ca6f973e6
[0m20:35:50.454034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_currency_exchange_baseRateEuro.f405e79eff, now test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b)
[0m20:35:50.453454 [info ] [Thread-3 (]: 14 of 30 START test not_null_transaction_amount ................................ [RUN]
[0m20:35:50.457005 [debug] [Thread-4 (]: On test.raysearch_project.not_null_customer_customerID.cdb9e51021: ROLLBACK
[0m20:35:50.458258 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b
[0m20:35:50.459134 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_currency_exchange_currency.3314a18e4f, now test.raysearch_project.not_null_transaction_amount.8ca6f973e6)
[0m20:35:50.469111 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"
[0m20:35:50.471014 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.not_null_currency_exchange_date.f508e913b3'
[0m20:35:50.472444 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.not_null_transaction_amount.8ca6f973e6
[0m20:35:50.473963 [debug] [Thread-2 (]: On test.raysearch_project.not_null_currency_exchange_date.f508e913b3: Close
[0m20:35:50.483350 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"
[0m20:35:50.485129 [debug] [Thread-1 (]: Began executing node test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b
[0m20:35:50.487876 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.not_null_customer_customerID.cdb9e51021'
[0m20:35:50.486753 [info ] [Thread-2 (]: 11 of 30 PASS not_null_currency_exchange_date .................................. [[32mPASS[0m in 0.13s]
[0m20:35:50.493373 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"
[0m20:35:50.494393 [debug] [Thread-4 (]: On test.raysearch_project.not_null_customer_customerID.cdb9e51021: Close
[0m20:35:50.495504 [debug] [Thread-2 (]: Finished running node test.raysearch_project.not_null_currency_exchange_date.f508e913b3
[0m20:35:50.497100 [debug] [Thread-3 (]: Began executing node test.raysearch_project.not_null_transaction_amount.8ca6f973e6
[0m20:35:50.498412 [debug] [Thread-2 (]: Began running node test.raysearch_project.not_null_transaction_customerId.63105569e2
[0m20:35:50.499519 [info ] [Thread-4 (]: 12 of 30 PASS not_null_customer_customerID ..................................... [[32mPASS[0m in 0.13s]
[0m20:35:50.504758 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"
[0m20:35:50.506686 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"
[0m20:35:50.507583 [debug] [Thread-4 (]: Finished running node test.raysearch_project.not_null_customer_customerID.cdb9e51021
[0m20:35:50.505908 [info ] [Thread-2 (]: 15 of 30 START test not_null_transaction_customerId ............................ [RUN]
[0m20:35:50.508760 [debug] [Thread-1 (]: On test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b: BEGIN
[0m20:35:50.509573 [debug] [Thread-4 (]: Began running node test.raysearch_project.not_null_transaction_date.8d1d66da2c
[0m20:35:50.510506 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_currency_exchange_date.f508e913b3, now test.raysearch_project.not_null_transaction_customerId.63105569e2)
[0m20:35:50.511225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:50.512630 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.not_null_transaction_customerId.63105569e2
[0m20:35:50.512022 [info ] [Thread-4 (]: 16 of 30 START test not_null_transaction_date .................................. [RUN]
[0m20:35:50.514642 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"
[0m20:35:50.523420 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.not_null_transaction_customerId.63105569e2"
[0m20:35:50.524393 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:35:50.525201 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_customer_customerID.cdb9e51021, now test.raysearch_project.not_null_transaction_date.8d1d66da2c)
[0m20:35:50.526005 [debug] [Thread-3 (]: On test.raysearch_project.not_null_transaction_amount.8ca6f973e6: BEGIN
[0m20:35:50.526805 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"
[0m20:35:50.527532 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.not_null_transaction_date.8d1d66da2c
[0m20:35:50.528302 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:35:50.529149 [debug] [Thread-1 (]: On test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select latestUpdate
from "warehouse"."main_raw"."customer"
where latestUpdate is null



  
  
      
    ) dbt_internal_test
[0m20:35:50.539074 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.not_null_transaction_date.8d1d66da2c"
[0m20:35:50.541722 [debug] [Thread-2 (]: Began executing node test.raysearch_project.not_null_transaction_customerId.63105569e2
[0m20:35:50.542927 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m20:35:50.543811 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:35:50.556501 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.not_null_transaction_customerId.63105569e2"
[0m20:35:50.557539 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"
[0m20:35:50.560604 [debug] [Thread-1 (]: On test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b: ROLLBACK
[0m20:35:50.561469 [debug] [Thread-4 (]: Began executing node test.raysearch_project.not_null_transaction_date.8d1d66da2c
[0m20:35:50.562236 [debug] [Thread-3 (]: On test.raysearch_project.not_null_transaction_amount.8ca6f973e6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_transaction_amount.8ca6f973e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "warehouse"."main_raw"."transaction"
where amount is null



  
  
      
    ) dbt_internal_test
[0m20:35:50.566933 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.not_null_transaction_date.8d1d66da2c"
[0m20:35:50.570160 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b'
[0m20:35:50.571046 [debug] [Thread-1 (]: On test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b: Close
[0m20:35:50.571830 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_customerId.63105569e2"
[0m20:35:50.572520 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:35:50.573307 [debug] [Thread-2 (]: On test.raysearch_project.not_null_transaction_customerId.63105569e2: BEGIN
[0m20:35:50.575737 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_date.8d1d66da2c"
[0m20:35:50.574660 [info ] [Thread-1 (]: 13 of 30 PASS not_null_customer_latestUpdate ................................... [[32mPASS[0m in 0.12s]
[0m20:35:50.576598 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:35:50.579475 [debug] [Thread-3 (]: On test.raysearch_project.not_null_transaction_amount.8ca6f973e6: ROLLBACK
[0m20:35:50.580443 [debug] [Thread-4 (]: On test.raysearch_project.not_null_transaction_date.8d1d66da2c: BEGIN
[0m20:35:50.582198 [debug] [Thread-1 (]: Finished running node test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b
[0m20:35:50.583832 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:35:50.584772 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m20:35:50.585597 [debug] [Thread-1 (]: Began running node test.raysearch_project.not_null_transaction_txCurrency.7798fc4041
[0m20:35:50.587380 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_customerId.63105569e2"
[0m20:35:50.588767 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.not_null_transaction_amount.8ca6f973e6'
[0m20:35:50.590330 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m20:35:50.589719 [info ] [Thread-1 (]: 17 of 30 START test not_null_transaction_txCurrency ............................ [RUN]
[0m20:35:50.591302 [debug] [Thread-2 (]: On test.raysearch_project.not_null_transaction_customerId.63105569e2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_transaction_customerId.63105569e2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customerId
from "warehouse"."main_raw"."transaction"
where customerId is null



  
  
      
    ) dbt_internal_test
[0m20:35:50.592046 [debug] [Thread-3 (]: On test.raysearch_project.not_null_transaction_amount.8ca6f973e6: Close
[0m20:35:50.592717 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_date.8d1d66da2c"
[0m20:35:50.593533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_customer_latestUpdate.b0d9ffd70b, now test.raysearch_project.not_null_transaction_txCurrency.7798fc4041)
[0m20:35:50.595690 [debug] [Thread-4 (]: On test.raysearch_project.not_null_transaction_date.8d1d66da2c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_transaction_date.8d1d66da2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "warehouse"."main_raw"."transaction"
where date is null



  
  
      
    ) dbt_internal_test
[0m20:35:50.595052 [info ] [Thread-3 (]: 14 of 30 PASS not_null_transaction_amount ...................................... [[32mPASS[0m in 0.14s]
[0m20:35:50.596729 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.not_null_transaction_txCurrency.7798fc4041
[0m20:35:50.597448 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:35:50.598740 [debug] [Thread-3 (]: Finished running node test.raysearch_project.not_null_transaction_amount.8ca6f973e6
[0m20:35:50.607858 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"
[0m20:35:50.608956 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m20:35:50.610144 [debug] [Thread-3 (]: Began running node test.raysearch_project.not_null_trf_currency_exchange_currency_code.753af6a7de
[0m20:35:50.612817 [debug] [Thread-2 (]: On test.raysearch_project.not_null_transaction_customerId.63105569e2: ROLLBACK
[0m20:35:50.614582 [info ] [Thread-3 (]: 18 of 30 START test not_null_trf_currency_exchange_currency_code ............... [RUN]
[0m20:35:50.617826 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.not_null_transaction_customerId.63105569e2'
[0m20:35:50.619278 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_transaction_amount.8ca6f973e6, now test.raysearch_project.not_null_trf_currency_exchange_currency_code.753af6a7de)
[0m20:35:50.621844 [debug] [Thread-4 (]: On test.raysearch_project.not_null_transaction_date.8d1d66da2c: ROLLBACK
[0m20:35:50.622659 [debug] [Thread-1 (]: Began executing node test.raysearch_project.not_null_transaction_txCurrency.7798fc4041
[0m20:35:50.623362 [debug] [Thread-2 (]: On test.raysearch_project.not_null_transaction_customerId.63105569e2: Close
[0m20:35:50.624157 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.not_null_trf_currency_exchange_currency_code.753af6a7de
[0m20:35:50.628675 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"
[0m20:35:50.639207 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.not_null_trf_currency_exchange_currency_code.753af6a7de"
[0m20:35:50.630691 [info ] [Thread-2 (]: 15 of 30 PASS not_null_transaction_customerId .................................. [[32mPASS[0m in 0.12s]
[0m20:35:50.641654 [debug] [Thread-2 (]: Finished running node test.raysearch_project.not_null_transaction_customerId.63105569e2
[0m20:35:50.642595 [debug] [Thread-2 (]: Began running node test.raysearch_project.not_null_trf_currency_exchange_rate_date.e5151cbcc2
[0m20:35:50.644832 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.not_null_transaction_date.8d1d66da2c'
[0m20:35:50.645675 [debug] [Thread-4 (]: On test.raysearch_project.not_null_transaction_date.8d1d66da2c: Close
[0m20:35:50.643449 [info ] [Thread-2 (]: 19 of 30 START test not_null_trf_currency_exchange_rate_date ................... [RUN]
[0m20:35:50.647246 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_transaction_customerId.63105569e2, now test.raysearch_project.not_null_trf_currency_exchange_rate_date.e5151cbcc2)
[0m20:35:50.648229 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.not_null_trf_currency_exchange_rate_date.e5151cbcc2
[0m20:35:50.656484 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.not_null_trf_currency_exchange_rate_date.e5151cbcc2"
[0m20:35:50.659230 [debug] [Thread-3 (]: Began executing node test.raysearch_project.not_null_trf_currency_exchange_currency_code.753af6a7de
[0m20:35:50.660101 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"
[0m20:35:50.657918 [info ] [Thread-4 (]: 16 of 30 PASS not_null_transaction_date ........................................ [[32mPASS[0m in 0.13s]
[0m20:35:50.666551 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_txCurrency.7798fc4041: BEGIN
[0m20:35:50.665543 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.not_null_trf_currency_exchange_currency_code.753af6a7de"
[0m20:35:50.668969 [debug] [Thread-4 (]: Finished running node test.raysearch_project.not_null_transaction_date.8d1d66da2c
[0m20:35:50.669986 [debug] [Thread-2 (]: Began executing node test.raysearch_project.not_null_trf_currency_exchange_rate_date.e5151cbcc2
[0m20:35:50.670937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:50.672039 [debug] [Thread-4 (]: Began running node test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb
[0m20:35:50.677589 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.not_null_trf_currency_exchange_rate_date.e5151cbcc2"
[0m20:35:50.680703 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m20:35:50.679466 [info ] [Thread-4 (]: 20 of 30 START test not_null_trf_customer_scd2_customer_id ..................... [RUN]
[0m20:35:50.682120 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_trf_currency_exchange_currency_code.753af6a7de"
[0m20:35:50.683045 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"
[0m20:35:50.684405 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_transaction_date.8d1d66da2c, now test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb)
[0m20:35:50.685555 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_currency_exchange_currency_code.753af6a7de: BEGIN
[0m20:35:50.686460 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_txCurrency.7798fc4041: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_transaction_txCurrency.7798fc4041"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txCurrency
from "warehouse"."main_raw"."transaction"
where txCurrency is null



  
  
      
    ) dbt_internal_test
[0m20:35:50.687278 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb
[0m20:35:50.688198 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_trf_currency_exchange_rate_date.e5151cbcc2"
[0m20:35:50.688901 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:35:50.698055 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb"
[0m20:35:50.699098 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_currency_exchange_rate_date.e5151cbcc2: BEGIN
[0m20:35:50.700714 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m20:35:50.702930 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:35:50.704098 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m20:35:50.707809 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_txCurrency.7798fc4041: ROLLBACK
[0m20:35:50.708691 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_trf_currency_exchange_currency_code.753af6a7de"
[0m20:35:50.709779 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m20:35:50.710884 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_currency_exchange_currency_code.753af6a7de: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_currency_exchange_currency_code.753af6a7de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency_code
from "warehouse"."main_trf"."trf_currency_exchange"
where currency_code is null



  
  
      
    ) dbt_internal_test
[0m20:35:50.711656 [debug] [Thread-4 (]: Began executing node test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb
[0m20:35:50.712450 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_trf_currency_exchange_rate_date.e5151cbcc2"
[0m20:35:50.719317 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb"
[0m20:35:50.720540 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_currency_exchange_rate_date.e5151cbcc2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_currency_exchange_rate_date.e5151cbcc2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_date
from "warehouse"."main_trf"."trf_currency_exchange"
where rate_date is null



  
  
      
    ) dbt_internal_test
[0m20:35:50.721597 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m20:35:50.724025 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.not_null_transaction_txCurrency.7798fc4041'
[0m20:35:50.725058 [debug] [Thread-1 (]: On test.raysearch_project.not_null_transaction_txCurrency.7798fc4041: Close
[0m20:35:50.727809 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_currency_exchange_currency_code.753af6a7de: ROLLBACK
[0m20:35:50.730015 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m20:35:50.729285 [info ] [Thread-1 (]: 17 of 30 PASS not_null_transaction_txCurrency .................................. [[32mPASS[0m in 0.14s]
[0m20:35:50.734579 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_currency_exchange_rate_date.e5151cbcc2: ROLLBACK
[0m20:35:50.735629 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb"
[0m20:35:50.736859 [debug] [Thread-1 (]: Finished running node test.raysearch_project.not_null_transaction_txCurrency.7798fc4041
[0m20:35:50.737937 [debug] [Thread-4 (]: On test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb: BEGIN
[0m20:35:50.739128 [debug] [Thread-1 (]: Began running node test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94
[0m20:35:50.740464 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:35:50.741604 [info ] [Thread-1 (]: 21 of 30 START test not_null_trf_customer_scd2_etl_valid_from .................. [RUN]
[0m20:35:50.743155 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.not_null_trf_currency_exchange_currency_code.753af6a7de'
[0m20:35:50.744664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_transaction_txCurrency.7798fc4041, now test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94)
[0m20:35:50.745628 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_currency_exchange_currency_code.753af6a7de: Close
[0m20:35:50.746555 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94
[0m20:35:50.747473 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m20:35:50.749001 [info ] [Thread-3 (]: 18 of 30 PASS not_null_trf_currency_exchange_currency_code ..................... [[32mPASS[0m in 0.13s]
[0m20:35:50.757182 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94"
[0m20:35:50.758324 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb"
[0m20:35:50.759642 [debug] [Thread-3 (]: Finished running node test.raysearch_project.not_null_trf_currency_exchange_currency_code.753af6a7de
[0m20:35:50.760982 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.not_null_trf_currency_exchange_rate_date.e5151cbcc2'
[0m20:35:50.761806 [debug] [Thread-4 (]: On test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "warehouse"."main_trf"."trf_customer_scd2"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m20:35:50.762798 [debug] [Thread-3 (]: Began running node test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595
[0m20:35:50.764112 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_currency_exchange_rate_date.e5151cbcc2: Close
[0m20:35:50.764936 [debug] [Thread-1 (]: Began executing node test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94
[0m20:35:50.773178 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94"
[0m20:35:50.766491 [info ] [Thread-3 (]: 22 of 30 START test not_null_trf_customer_scd2_is_current ...................... [RUN]
[0m20:35:50.775303 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m20:35:50.776301 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_trf_currency_exchange_currency_code.753af6a7de, now test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595)
[0m20:35:50.774323 [info ] [Thread-2 (]: 19 of 30 PASS not_null_trf_currency_exchange_rate_date ......................... [[32mPASS[0m in 0.13s]
[0m20:35:50.777913 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595
[0m20:35:50.781811 [debug] [Thread-4 (]: On test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb: ROLLBACK
[0m20:35:50.783072 [debug] [Thread-2 (]: Finished running node test.raysearch_project.not_null_trf_currency_exchange_rate_date.e5151cbcc2
[0m20:35:50.783941 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94"
[0m20:35:50.791828 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595"
[0m20:35:50.793045 [debug] [Thread-2 (]: Began running node test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951
[0m20:35:50.794063 [debug] [Thread-1 (]: On test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94: BEGIN
[0m20:35:50.796287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:50.795238 [info ] [Thread-2 (]: 23 of 30 START test not_null_trf_transaction_account_type ...................... [RUN]
[0m20:35:50.798365 [debug] [Thread-3 (]: Began executing node test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595
[0m20:35:50.799742 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_trf_currency_exchange_rate_date.e5151cbcc2, now test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951)
[0m20:35:50.800716 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:35:50.802361 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb'
[0m20:35:50.806464 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595"
[0m20:35:50.807493 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951
[0m20:35:50.808460 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94"
[0m20:35:50.810387 [debug] [Thread-4 (]: On test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb: Close
[0m20:35:50.821375 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951"
[0m20:35:50.822538 [debug] [Thread-1 (]: On test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select etl_valid_from
from "warehouse"."main_trf"."trf_customer_scd2"
where etl_valid_from is null



  
  
      
    ) dbt_internal_test
[0m20:35:50.825189 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595"
[0m20:35:50.824376 [info ] [Thread-4 (]: 20 of 30 PASS not_null_trf_customer_scd2_customer_id ........................... [[32mPASS[0m in 0.14s]
[0m20:35:50.826627 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595: BEGIN
[0m20:35:50.827707 [debug] [Thread-4 (]: Finished running node test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb
[0m20:35:50.828625 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:35:50.829739 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:35:50.831018 [debug] [Thread-4 (]: Began running node test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b
[0m20:35:50.836942 [debug] [Thread-1 (]: On test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94: ROLLBACK
[0m20:35:50.837925 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m20:35:50.833500 [info ] [Thread-4 (]: 24 of 30 START test not_null_trf_transaction_country_code ...................... [RUN]
[0m20:35:50.839019 [debug] [Thread-2 (]: Began executing node test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951
[0m20:35:50.839962 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595"
[0m20:35:50.841207 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_trf_customer_scd2_customer_id.7602333dfb, now test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b)
[0m20:35:50.845657 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951"
[0m20:35:50.846680 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_current
from "warehouse"."main_trf"."trf_customer_scd2"
where is_current is null



  
  
      
    ) dbt_internal_test
[0m20:35:50.847639 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b
[0m20:35:50.849740 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94'
[0m20:35:50.859532 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b"
[0m20:35:50.860648 [debug] [Thread-1 (]: On test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94: Close
[0m20:35:50.861624 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m20:35:50.862684 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951"
[0m20:35:50.864995 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951: BEGIN
[0m20:35:50.865593 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:35:50.864253 [info ] [Thread-1 (]: 21 of 30 PASS not_null_trf_customer_scd2_etl_valid_from ........................ [[32mPASS[0m in 0.12s]
[0m20:35:50.869577 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595: ROLLBACK
[0m20:35:50.870799 [debug] [Thread-1 (]: Finished running node test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94
[0m20:35:50.871734 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m20:35:50.872450 [debug] [Thread-1 (]: Began running node test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73
[0m20:35:50.873021 [debug] [Thread-4 (]: Began executing node test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b
[0m20:35:50.874024 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951"
[0m20:35:50.879551 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b"
[0m20:35:50.874831 [info ] [Thread-1 (]: 25 of 30 START test not_null_trf_transaction_customer_id ....................... [RUN]
[0m20:35:50.881636 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select account_type
from "warehouse"."main_trf"."trf_transaction"
where account_type is null



  
  
      
    ) dbt_internal_test
[0m20:35:50.883238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_trf_customer_scd2_etl_valid_from.2333e40f94, now test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73)
[0m20:35:50.884695 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595'
[0m20:35:50.886464 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73
[0m20:35:50.887878 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595: Close
[0m20:35:50.889272 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:35:50.897236 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73"
[0m20:35:50.899112 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b"
[0m20:35:50.904567 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951: ROLLBACK
[0m20:35:50.900509 [info ] [Thread-3 (]: 22 of 30 PASS not_null_trf_customer_scd2_is_current ............................ [[32mPASS[0m in 0.12s]
[0m20:35:50.910615 [debug] [Thread-4 (]: On test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b: BEGIN
[0m20:35:50.912801 [debug] [Thread-3 (]: Finished running node test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595
[0m20:35:50.913835 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:35:50.915049 [debug] [Thread-1 (]: Began executing node test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73
[0m20:35:50.916117 [debug] [Thread-3 (]: Began running node test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37
[0m20:35:50.922116 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73"
[0m20:35:50.924154 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m20:35:50.925304 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951'
[0m20:35:50.923217 [info ] [Thread-3 (]: 26 of 30 START test not_null_trf_transaction_transaction_date .................. [RUN]
[0m20:35:50.926472 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b"
[0m20:35:50.927416 [debug] [Thread-2 (]: On test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951: Close
[0m20:35:50.928391 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_trf_customer_scd2_is_current.59a6a18595, now test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37)
[0m20:35:50.929221 [debug] [Thread-4 (]: On test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country_code
from "warehouse"."main_trf"."trf_transaction"
where country_code is null



  
  
      
    ) dbt_internal_test
[0m20:35:50.930511 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37
[0m20:35:50.933230 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73"
[0m20:35:50.932092 [info ] [Thread-2 (]: 23 of 30 PASS not_null_trf_transaction_account_type ............................ [[32mPASS[0m in 0.13s]
[0m20:35:50.942494 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37"
[0m20:35:50.943740 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m20:35:50.944489 [debug] [Thread-1 (]: On test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73: BEGIN
[0m20:35:50.945533 [debug] [Thread-2 (]: Finished running node test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951
[0m20:35:50.947071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:50.950622 [debug] [Thread-4 (]: On test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b: ROLLBACK
[0m20:35:50.952063 [debug] [Thread-2 (]: Began running node test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8
[0m20:35:50.953620 [debug] [Thread-3 (]: Began executing node test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37
[0m20:35:50.955381 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:35:50.954707 [info ] [Thread-2 (]: 27 of 30 START test relationships_transaction_customerId__customerID__ref_customer_  [RUN]
[0m20:35:50.959961 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37"
[0m20:35:50.960838 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73"
[0m20:35:50.961878 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_trf_transaction_account_type.0785bb4951, now test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8)
[0m20:35:50.963226 [debug] [Thread-1 (]: On test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "warehouse"."main_trf"."trf_transaction"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m20:35:50.964378 [debug] [Thread-2 (]: Began compiling node test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8
[0m20:35:50.966046 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b'
[0m20:35:50.967442 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37"
[0m20:35:50.983506 [debug] [Thread-4 (]: On test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b: Close
[0m20:35:50.986841 [debug] [Thread-2 (]: Writing injected SQL for node "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"
[0m20:35:50.987812 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37: BEGIN
[0m20:35:50.988528 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m20:35:50.990939 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:35:50.989959 [info ] [Thread-4 (]: 24 of 30 PASS not_null_trf_transaction_country_code ............................ [[32mPASS[0m in 0.15s]
[0m20:35:50.993649 [debug] [Thread-4 (]: Finished running node test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b
[0m20:35:50.994487 [debug] [Thread-4 (]: Began running node test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506
[0m20:35:50.996104 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m20:35:50.995114 [info ] [Thread-4 (]: 28 of 30 START test relationships_transaction_txCurrency__currency__ref_currency_exchange_  [RUN]
[0m20:35:50.999491 [debug] [Thread-1 (]: On test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73: ROLLBACK
[0m20:35:51.000638 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37"
[0m20:35:51.001609 [debug] [Thread-2 (]: Began executing node test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8
[0m20:35:51.002866 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_trf_transaction_country_code.6e598f518b, now test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506)
[0m20:35:51.004097 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "warehouse"."main_trf"."trf_transaction"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m20:35:51.009795 [debug] [Thread-2 (]: Writing runtime sql for node "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"
[0m20:35:51.011208 [debug] [Thread-4 (]: Began compiling node test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506
[0m20:35:51.017785 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73'
[0m20:35:51.024785 [debug] [Thread-1 (]: On test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73: Close
[0m20:35:51.028075 [debug] [Thread-4 (]: Writing injected SQL for node "test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506"
[0m20:35:51.029297 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m20:35:51.035232 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37: ROLLBACK
[0m20:35:51.030715 [info ] [Thread-1 (]: 25 of 30 PASS not_null_trf_transaction_customer_id ............................. [[32mPASS[0m in 0.15s]
[0m20:35:51.037011 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"
[0m20:35:51.038311 [debug] [Thread-1 (]: Finished running node test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73
[0m20:35:51.039357 [debug] [Thread-2 (]: On test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8: BEGIN
[0m20:35:51.040172 [debug] [Thread-4 (]: Began executing node test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506
[0m20:35:51.041036 [debug] [Thread-1 (]: Began running node test.raysearch_project.trf_transaction_customer_on_day
[0m20:35:51.042150 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37'
[0m20:35:51.043169 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:35:51.048425 [debug] [Thread-4 (]: Writing runtime sql for node "test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506"
[0m20:35:51.050977 [debug] [Thread-3 (]: On test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37: Close
[0m20:35:51.049686 [info ] [Thread-1 (]: 29 of 30 START test trf_transaction_customer_on_day ............................ [RUN]
[0m20:35:51.054674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_trf_transaction_customer_id.a1a6396f73, now test.raysearch_project.trf_transaction_customer_on_day)
[0m20:35:51.053828 [info ] [Thread-3 (]: 26 of 30 PASS not_null_trf_transaction_transaction_date ........................ [[32mPASS[0m in 0.13s]
[0m20:35:51.055665 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m20:35:51.056334 [debug] [Thread-1 (]: Began compiling node test.raysearch_project.trf_transaction_customer_on_day
[0m20:35:51.057265 [debug] [Thread-3 (]: Finished running node test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37
[0m20:35:51.057957 [debug] [Thread-2 (]: Using duckdb connection "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"
[0m20:35:51.063101 [debug] [Thread-1 (]: Writing injected SQL for node "test.raysearch_project.trf_transaction_customer_on_day"
[0m20:35:51.064539 [debug] [Thread-3 (]: Began running node test.raysearch_project.trf_transaction_exchange_on_day
[0m20:35:51.066039 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506"
[0m20:35:51.067641 [debug] [Thread-2 (]: On test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customerId as from_field
    from "warehouse"."main_raw"."transaction"
    where customerId is not null
),

parent as (
    select customerID as to_field
    from "warehouse"."main_raw"."customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:35:51.070948 [debug] [Thread-4 (]: On test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506: BEGIN
[0m20:35:51.069734 [info ] [Thread-3 (]: 30 of 30 START test trf_transaction_exchange_on_day ............................ [RUN]
[0m20:35:51.079950 [debug] [Thread-1 (]: Began executing node test.raysearch_project.trf_transaction_customer_on_day
[0m20:35:51.082047 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:35:51.083426 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.raysearch_project.not_null_trf_transaction_transaction_date.645dbc8e37, now test.raysearch_project.trf_transaction_exchange_on_day)
[0m20:35:51.088671 [debug] [Thread-1 (]: Writing runtime sql for node "test.raysearch_project.trf_transaction_customer_on_day"
[0m20:35:51.090539 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m20:35:51.091362 [debug] [Thread-3 (]: Began compiling node test.raysearch_project.trf_transaction_exchange_on_day
[0m20:35:51.092261 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m20:35:51.097919 [debug] [Thread-3 (]: Writing injected SQL for node "test.raysearch_project.trf_transaction_exchange_on_day"
[0m20:35:51.101570 [debug] [Thread-2 (]: On test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8: ROLLBACK
[0m20:35:51.102816 [debug] [Thread-4 (]: Using duckdb connection "test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506"
[0m20:35:51.104606 [debug] [Thread-4 (]: On test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select txCurrency as from_field
    from "warehouse"."main_raw"."transaction"
    where txCurrency is not null
),

parent as (
    select currency as to_field
    from "warehouse"."main_raw"."currency_exchange"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:35:51.105888 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.trf_transaction_customer_on_day"
[0m20:35:51.107381 [debug] [Thread-1 (]: On test.raysearch_project.trf_transaction_customer_on_day: BEGIN
[0m20:35:51.108171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:51.108861 [debug] [Thread-3 (]: Began executing node test.raysearch_project.trf_transaction_exchange_on_day
[0m20:35:51.115364 [debug] [Thread-3 (]: Writing runtime sql for node "test.raysearch_project.trf_transaction_exchange_on_day"
[0m20:35:51.117424 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:35:51.118347 [debug] [Thread-1 (]: Using duckdb connection "test.raysearch_project.trf_transaction_customer_on_day"
[0m20:35:51.119430 [debug] [Thread-1 (]: On test.raysearch_project.trf_transaction_customer_on_day: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.trf_transaction_customer_on_day"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select t.transaction_date, t.customer_id
from "warehouse"."main_stg"."stg_transaction" t
left join "warehouse"."main_trf"."trf_customer_scd2" c
  on c.customer_id = t.customer_id
 and t.transaction_date between c.etl_valid_from and c.etl_valid_to
where c.customer_id is null
  
  
      
    ) dbt_internal_test
[0m20:35:51.121653 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.trf_transaction_exchange_on_day"
[0m20:35:51.123062 [debug] [Thread-2 (]: Failed to rollback 'test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8'
[0m20:35:51.123642 [debug] [Thread-3 (]: On test.raysearch_project.trf_transaction_exchange_on_day: BEGIN
[0m20:35:51.124463 [debug] [Thread-2 (]: On test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8: Close
[0m20:35:51.125554 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:35:51.127622 [info ] [Thread-2 (]: 27 of 30 PASS relationships_transaction_customerId__customerID__ref_customer_ .. [[32mPASS[0m in 0.17s]
[0m20:35:51.129799 [debug] [Thread-2 (]: Finished running node test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8
[0m20:35:51.131150 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m20:35:51.131940 [debug] [Thread-3 (]: Using duckdb connection "test.raysearch_project.trf_transaction_exchange_on_day"
[0m20:35:51.132544 [debug] [Thread-3 (]: On test.raysearch_project.trf_transaction_exchange_on_day: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "test.raysearch_project.trf_transaction_exchange_on_day"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  select t.transaction_date, t.currency
from "warehouse"."main_stg"."stg_transaction" t
left join "warehouse"."main_trf"."trf_currency_exchange" x
  on x.currency_code = t.currency
 and t.transaction_date = x.rate_date
where x.currency_code is null
  
  
      
    ) dbt_internal_test
[0m20:35:51.139867 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m20:35:51.143849 [debug] [Thread-1 (]: On test.raysearch_project.trf_transaction_customer_on_day: ROLLBACK
[0m20:35:51.146728 [debug] [Thread-1 (]: Failed to rollback 'test.raysearch_project.trf_transaction_customer_on_day'
[0m20:35:51.147857 [debug] [Thread-1 (]: On test.raysearch_project.trf_transaction_customer_on_day: Close
[0m20:35:51.151111 [debug] [Thread-4 (]: SQL status: OK in 0.044 seconds
[0m20:35:51.149653 [info ] [Thread-1 (]: 29 of 30 PASS trf_transaction_customer_on_day .................................. [[32mPASS[0m in 0.09s]
[0m20:35:51.153166 [debug] [Thread-1 (]: Finished running node test.raysearch_project.trf_transaction_customer_on_day
[0m20:35:51.156046 [debug] [Thread-4 (]: On test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506: ROLLBACK
[0m20:35:51.158736 [debug] [Thread-4 (]: Failed to rollback 'test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506'
[0m20:35:51.159460 [debug] [Thread-4 (]: On test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506: Close
[0m20:35:51.160574 [info ] [Thread-4 (]: 28 of 30 PASS relationships_transaction_txCurrency__currency__ref_currency_exchange_  [[32mPASS[0m in 0.16s]
[0m20:35:51.162267 [debug] [Thread-4 (]: Finished running node test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506
[0m20:35:51.163230 [debug] [Thread-3 (]: SQL status: OK in 0.029 seconds
[0m20:35:51.168244 [debug] [Thread-3 (]: On test.raysearch_project.trf_transaction_exchange_on_day: ROLLBACK
[0m20:35:51.170457 [debug] [Thread-3 (]: Failed to rollback 'test.raysearch_project.trf_transaction_exchange_on_day'
[0m20:35:51.171117 [debug] [Thread-3 (]: On test.raysearch_project.trf_transaction_exchange_on_day: Close
[0m20:35:51.172564 [info ] [Thread-3 (]: 30 of 30 PASS trf_transaction_exchange_on_day .................................. [[32mPASS[0m in 0.09s]
[0m20:35:51.174289 [debug] [Thread-3 (]: Finished running node test.raysearch_project.trf_transaction_exchange_on_day
[0m20:35:51.177191 [debug] [MainThread]: Using duckdb connection "master"
[0m20:35:51.177959 [debug] [MainThread]: On master: BEGIN
[0m20:35:51.178668 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:35:51.179976 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:35:51.180818 [debug] [MainThread]: On master: COMMIT
[0m20:35:51.181521 [debug] [MainThread]: Using duckdb connection "master"
[0m20:35:51.182226 [debug] [MainThread]: On master: COMMIT
[0m20:35:51.184057 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:35:51.184893 [debug] [MainThread]: On master: Close
[0m20:35:51.185808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:35:51.186263 [debug] [MainThread]: Connection 'list_warehouse_main_trf' was properly closed.
[0m20:35:51.186794 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m20:35:51.187368 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m20:35:51.188113 [debug] [MainThread]: Connection 'test.raysearch_project.relationships_transaction_txCurrency__currency__ref_currency_exchange_.b837e7b506' was properly closed.
[0m20:35:51.188533 [debug] [MainThread]: Connection 'test.raysearch_project.trf_transaction_exchange_on_day' was properly closed.
[0m20:35:51.189053 [debug] [MainThread]: Connection 'test.raysearch_project.trf_transaction_customer_on_day' was properly closed.
[0m20:35:51.189442 [debug] [MainThread]: Connection 'test.raysearch_project.relationships_transaction_customerId__customerID__ref_customer_.07ef3b4fe8' was properly closed.
[0m20:35:51.190137 [info ] [MainThread]: 
[0m20:35:51.191048 [info ] [MainThread]: Finished running 30 data tests in 0 hours 0 minutes and 1.73 seconds (1.73s).
[0m20:35:51.199307 [debug] [MainThread]: Command end result
[0m20:35:51.259611 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m20:35:51.267192 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m20:35:51.284516 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m20:35:51.285473 [info ] [MainThread]: 
[0m20:35:51.286632 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:35:51.287645 [info ] [MainThread]: 
[0m20:35:51.288635 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=30
[0m20:35:51.290585 [debug] [MainThread]: Command `dbt test` succeeded at 20:35:51.290320 after 4.51 seconds
[0m20:35:51.291386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002412D10B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002412EC1EAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002412EC1FC20>]}
[0m20:35:51.292082 [debug] [MainThread]: Flushing usage events
[0m20:35:52.939715 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:36:57.785168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413EC94830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413FDCFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413FDCF9D0>]}


============================== 20:36:57.798349 | 5b4bc896-9ecc-401d-a430-77a4acdf9705 ==============================
[0m20:36:57.798349 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:36:57.800451 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\AMANDAKA\\.dbt', 'invocation_command': 'dbt run --select trf_transaction', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\AMANDAKA\\Workspaces\\raysearch_project\\logs'}
[0m20:36:58.305066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b4bc896-9ecc-401d-a430-77a4acdf9705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413F106060>]}
[0m20:36:58.448303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b4bc896-9ecc-401d-a430-77a4acdf9705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024140E0E7A0>]}
[0m20:36:58.455086 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:36:58.949546 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:36:59.429634 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:36:59.431275 [debug] [MainThread]: Partial parsing: updated file: raysearch_project://models\transformation\trf_transaction.sql
[0m20:37:00.240660 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`
defined on 'trf_transaction' in package 'raysearch_project'
(models\transformation\trf_schema.yml). Arguments to generic tests should be
nested under the `arguments` property.
[0m20:37:00.242291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5b4bc896-9ecc-401d-a430-77a4acdf9705', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002414128BA50>]}
[0m20:37:00.432141 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.raysearch_project.marts
[0m20:37:00.455757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b4bc896-9ecc-401d-a430-77a4acdf9705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002414152E030>]}
[0m20:37:00.672564 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m20:37:00.681709 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m20:37:00.760228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b4bc896-9ecc-401d-a430-77a4acdf9705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241416EE890>]}
[0m20:37:00.761698 [info ] [MainThread]: Found 8 models, 1 snapshot, 3 seeds, 30 data tests, 586 macros
[0m20:37:00.763309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b4bc896-9ecc-401d-a430-77a4acdf9705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024141715BF0>]}
[0m20:37:00.767822 [info ] [MainThread]: 
[0m20:37:00.769263 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:37:00.770349 [info ] [MainThread]: 
[0m20:37:00.772290 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:37:00.774928 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse'
[0m20:37:01.023142 [debug] [ThreadPool]: Using duckdb connection "list_warehouse"
[0m20:37:01.023956 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"warehouse"'
    
  
  
[0m20:37:01.024498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:01.061220 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m20:37:01.064101 [debug] [ThreadPool]: On list_warehouse: Close
[0m20:37:01.065680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_main_trf)
[0m20:37:01.066591 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "main_trf"
"
[0m20:37:01.078883 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m20:37:01.079786 [debug] [ThreadPool]: On create_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_trf"} */

    
        select type from duckdb_databases()
        where lower(database_name)='warehouse'
        and type='sqlite'
    
  
[0m20:37:01.080290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:37:01.082607 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:37:01.085112 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m20:37:01.085659 [debug] [ThreadPool]: On create_warehouse_main_trf: BEGIN
[0m20:37:01.086717 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:37:01.087287 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m20:37:01.087801 [debug] [ThreadPool]: On create_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "create_warehouse_main_trf"} */

    
    
        create schema if not exists "warehouse"."main_trf"
    
[0m20:37:01.088942 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:37:01.090565 [debug] [ThreadPool]: On create_warehouse_main_trf: COMMIT
[0m20:37:01.091140 [debug] [ThreadPool]: Using duckdb connection "create_warehouse_main_trf"
[0m20:37:01.091628 [debug] [ThreadPool]: On create_warehouse_main_trf: COMMIT
[0m20:37:01.092579 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:37:01.093161 [debug] [ThreadPool]: On create_warehouse_main_trf: Close
[0m20:37:01.105388 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_raw'
[0m20:37:01.117799 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_trf'
[0m20:37:01.117003 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m20:37:01.122045 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m20:37:01.122976 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_warehouse_main_stg'
[0m20:37:01.123873 [debug] [ThreadPool]: On list_warehouse_main_raw: BEGIN
[0m20:37:01.124635 [debug] [ThreadPool]: On list_warehouse_main_trf: BEGIN
[0m20:37:01.129026 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m20:37:01.129895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:01.130561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:01.131196 [debug] [ThreadPool]: On list_warehouse_main_stg: BEGIN
[0m20:37:01.132674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:01.133831 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:37:01.134545 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m20:37:01.135160 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_trf"
[0m20:37:01.135686 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:37:01.136196 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_raw"
[0m20:37:01.136854 [debug] [ThreadPool]: On list_warehouse_main_trf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_trf"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_trf'
    and lower(table_catalog) = 'warehouse'
  
[0m20:37:01.137476 [debug] [ThreadPool]: Using duckdb connection "list_warehouse_main_stg"
[0m20:37:01.138063 [debug] [ThreadPool]: On list_warehouse_main_raw: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_raw"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_raw'
    and lower(table_catalog) = 'warehouse'
  
[0m20:37:01.139051 [debug] [ThreadPool]: On list_warehouse_main_stg: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "connection_name": "list_warehouse_main_stg"} */
select
      'warehouse' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_stg'
    and lower(table_catalog) = 'warehouse'
  
[0m20:37:01.165241 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m20:37:01.166118 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m20:37:01.166724 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m20:37:01.169461 [debug] [ThreadPool]: On list_warehouse_main_stg: ROLLBACK
[0m20:37:01.171427 [debug] [ThreadPool]: On list_warehouse_main_trf: ROLLBACK
[0m20:37:01.173339 [debug] [ThreadPool]: On list_warehouse_main_raw: ROLLBACK
[0m20:37:01.179050 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_stg'
[0m20:37:01.179777 [debug] [ThreadPool]: On list_warehouse_main_stg: Close
[0m20:37:01.182239 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_raw'
[0m20:37:01.182751 [debug] [ThreadPool]: On list_warehouse_main_raw: Close
[0m20:37:01.184768 [debug] [ThreadPool]: Failed to rollback 'list_warehouse_main_trf'
[0m20:37:01.185349 [debug] [ThreadPool]: On list_warehouse_main_trf: Close
[0m20:37:01.187379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b4bc896-9ecc-401d-a430-77a4acdf9705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002414162DD90>]}
[0m20:37:01.188194 [debug] [MainThread]: Using duckdb connection "master"
[0m20:37:01.188648 [debug] [MainThread]: On master: BEGIN
[0m20:37:01.189076 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:37:01.190331 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:37:01.190860 [debug] [MainThread]: On master: COMMIT
[0m20:37:01.191363 [debug] [MainThread]: Using duckdb connection "master"
[0m20:37:01.191773 [debug] [MainThread]: On master: COMMIT
[0m20:37:01.192572 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:37:01.193056 [debug] [MainThread]: On master: Close
[0m20:37:01.201130 [debug] [Thread-1 (]: Began running node model.raysearch_project.trf_transaction
[0m20:37:01.202287 [info ] [Thread-1 (]: 1 of 1 START sql table model main_trf.trf_transaction .......................... [RUN]
[0m20:37:01.203615 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.raysearch_project.trf_transaction'
[0m20:37:01.204253 [debug] [Thread-1 (]: Began compiling node model.raysearch_project.trf_transaction
[0m20:37:01.219962 [debug] [Thread-1 (]: Writing injected SQL for node "model.raysearch_project.trf_transaction"
[0m20:37:01.223400 [debug] [Thread-1 (]: Began executing node model.raysearch_project.trf_transaction
[0m20:37:01.284946 [debug] [Thread-1 (]: Writing runtime sql for node "model.raysearch_project.trf_transaction"
[0m20:37:01.287709 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_transaction"
[0m20:37:01.288395 [debug] [Thread-1 (]: On model.raysearch_project.trf_transaction: BEGIN
[0m20:37:01.288968 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:37:01.290538 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:37:01.291164 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_transaction"
[0m20:37:01.291740 [debug] [Thread-1 (]: On model.raysearch_project.trf_transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_transaction"} */

  
    
    

    create  table
      "warehouse"."main_trf"."trf_transaction__dbt_tmp"
  
    as (
      with st as (
    select * from "warehouse"."main_stg"."stg_transaction"
),
cust as (
    select * from "warehouse"."main_trf"."trf_customer_scd2"
),
curr_exc as (
    select * from "warehouse"."main_trf"."trf_currency_exchange"
),
joined as (
    select
        st.transaction_date,
        st.customer_id,
        cust.country_code,
        st.account_type,
        st.transaction_type,
        st.amount * curr_exc.base_rate_eur as amount
    from st
    inner join cust
        on st.customer_id = cust.customer_id
       and st.transaction_date between cust.etl_valid_from and cust.etl_valid_to
    left join curr_exc
        on st.transaction_date = curr_exc.rate_date
       and st.currency = curr_exc.currency_code
),
agg as (
    select
        transaction_date,
        customer_id,
        country_code,
        account_type,
        sum(case when transaction_type = 'WITHDRAWAL' then amount else 0 end) as withdrawal,
        sum(case when transaction_type = 'DEPOSIT' then amount else 0 end) as deposit
    from joined
    group by transaction_date, customer_id, country_code, account_type
)
select * from agg
    );
  
  
[0m20:37:01.330704 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m20:37:01.342166 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_transaction"
[0m20:37:01.343036 [debug] [Thread-1 (]: On model.raysearch_project.trf_transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_transaction"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_trf'
      AND table_name = 'trf_transaction'
  
[0m20:37:01.345581 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:37:01.347883 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_transaction"
[0m20:37:01.348529 [debug] [Thread-1 (]: On model.raysearch_project.trf_transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_transaction"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_trf'
      AND table_name = 'trf_transaction'
  
[0m20:37:01.350343 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:37:01.362390 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_transaction"
[0m20:37:01.363206 [debug] [Thread-1 (]: On model.raysearch_project.trf_transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_transaction"} */
alter table "warehouse"."main_trf"."trf_transaction" rename to "trf_transaction__dbt_backup"
[0m20:37:01.364910 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:37:01.376174 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_transaction"
[0m20:37:01.377384 [debug] [Thread-1 (]: On model.raysearch_project.trf_transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_transaction"} */
alter table "warehouse"."main_trf"."trf_transaction__dbt_tmp" rename to "trf_transaction"
[0m20:37:01.379560 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:37:01.406588 [debug] [Thread-1 (]: On model.raysearch_project.trf_transaction: COMMIT
[0m20:37:01.407577 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_transaction"
[0m20:37:01.408262 [debug] [Thread-1 (]: On model.raysearch_project.trf_transaction: COMMIT
[0m20:37:01.423792 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m20:37:01.434916 [debug] [Thread-1 (]: Using duckdb connection "model.raysearch_project.trf_transaction"
[0m20:37:01.435801 [debug] [Thread-1 (]: On model.raysearch_project.trf_transaction: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "raysearch_project", "target_name": "dev", "node_id": "model.raysearch_project.trf_transaction"} */

      drop table if exists "warehouse"."main_trf"."trf_transaction__dbt_backup" cascade
    
[0m20:37:01.438808 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:37:01.443066 [debug] [Thread-1 (]: On model.raysearch_project.trf_transaction: Close
[0m20:37:01.448965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b4bc896-9ecc-401d-a430-77a4acdf9705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002414181E150>]}
[0m20:37:01.450643 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_trf.trf_transaction ..................... [[32mOK[0m in 0.24s]
[0m20:37:01.452318 [debug] [Thread-1 (]: Finished running node model.raysearch_project.trf_transaction
[0m20:37:01.454948 [debug] [MainThread]: Using duckdb connection "master"
[0m20:37:01.455497 [debug] [MainThread]: On master: BEGIN
[0m20:37:01.456084 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:37:01.457697 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:37:01.458432 [debug] [MainThread]: On master: COMMIT
[0m20:37:01.459072 [debug] [MainThread]: Using duckdb connection "master"
[0m20:37:01.459708 [debug] [MainThread]: On master: COMMIT
[0m20:37:01.460944 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:37:01.461787 [debug] [MainThread]: On master: Close
[0m20:37:01.462695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:37:01.463233 [debug] [MainThread]: Connection 'create_warehouse_main_trf' was properly closed.
[0m20:37:01.463723 [debug] [MainThread]: Connection 'list_warehouse_main_raw' was properly closed.
[0m20:37:01.464142 [debug] [MainThread]: Connection 'list_warehouse_main_trf' was properly closed.
[0m20:37:01.464545 [debug] [MainThread]: Connection 'list_warehouse_main_stg' was properly closed.
[0m20:37:01.465316 [debug] [MainThread]: Connection 'model.raysearch_project.trf_transaction' was properly closed.
[0m20:37:01.466381 [info ] [MainThread]: 
[0m20:37:01.467807 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m20:37:01.470141 [debug] [MainThread]: Command end result
[0m20:37:01.533444 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\manifest.json
[0m20:37:01.540308 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\semantic_manifest.json
[0m20:37:01.555074 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AMANDAKA\Workspaces\raysearch_project\target\run_results.json
[0m20:37:01.555853 [info ] [MainThread]: 
[0m20:37:01.557081 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:37:01.558155 [info ] [MainThread]: 
[0m20:37:01.559181 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:37:01.560537 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:37:01.563923 [debug] [MainThread]: Command `dbt run` succeeded at 20:37:01.563613 after 4.13 seconds
[0m20:37:01.564717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024141A47890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024141627530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024140E993D0>]}
[0m20:37:01.565903 [debug] [MainThread]: Flushing usage events
[0m20:37:03.083684 [debug] [MainThread]: An error was encountered while trying to flush usage events
